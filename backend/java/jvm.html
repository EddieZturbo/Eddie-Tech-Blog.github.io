<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mister-hope.github.io/backend/java/jvm.html"><meta property="og:site_name" content="Eddie-Tech-Blog"><meta property="og:title" content="Java Virtual Machine"><meta property="og:description" content="JVM stands for Java Virtual Machine. It is a software that provides a runtime environment for executing Java programs. Java is a high-level programming language that can run on..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Java Virtual Machine","image":[""],"dateModified":null,"author":[]}</script><title>Java Virtual Machine | Eddie-Tech-Blog</title><meta name="description" content="JVM stands for Java Virtual Machine. It is a software that provides a runtime environment for executing Java programs. Java is a high-level programming language that can run on...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-71862533.css" as="style"><link rel="stylesheet" href="/assets/style-71862533.css">
    <link rel="modulepreload" href="/assets/app-7117916c.js"><link rel="modulepreload" href="/assets/framework-e28ace55.js"><link rel="modulepreload" href="/assets/jvm.html-f330fd11.js"><link rel="modulepreload" href="/assets/jvm.html-3fd71a39.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="Eddie-Tech-Blog"><!----><span class="site-name hide-in-pad">Eddie-Tech-Blog</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="Home"><span class="font-icon icon iconfont icon-home" style=""></span>Home<!----></a></div><div class="nav-item hide-in-mobile"><a href="/eddie/" class="nav-link" aria-label="Expoler"><span class="font-icon icon iconfont icon-discover" style=""></span>Expoler<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Backend-Dev"><span class="title"><span class="font-icon icon iconfont icon-edit" style=""></span>Backend-Dev</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-current="page" href="/backend/java/jvm.html" class="router-link-active router-link-exact-active nav-link active" aria-label="JVM"><span class="font-icon icon iconfont icon-edit" style=""></span>JVM<!----></a></li><li class="dropdown-subitem"><a href="/backend/java/java8.html" class="nav-link" aria-label="Java8"><span class="font-icon icon iconfont icon-edit" style=""></span>Java8<!----></a></li><li class="dropdown-subitem"><a href="/backend/java/java_concurrency_programming.html" class="nav-link" aria-label="Java Concurrency Programming"><span class="font-icon icon iconfont icon-edit" style=""></span>Java Concurrency Programming<!----></a></li><li class="dropdown-subitem"><a href="/backend/java/Java.html" class="nav-link" aria-label="Java"><span class="font-icon icon iconfont icon-edit" style=""></span>Java<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Database</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/database/mysql.html" class="nav-link" aria-label="MySQL  Basic --- advanced"><span class="font-icon icon iconfont icon-edit" style=""></span>MySQL  Basic --- advanced<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Dev-FrameWork</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/dev_framework/SpringBoot.html" class="nav-link" aria-label="Spring Boot"><span class="font-icon icon iconfont icon-edit" style=""></span>Spring Boot<!----></a></li><li class="dropdown-subitem"><a href="/backend/dev_framework/SpringMVC.html" class="nav-link" aria-label="SpringMVC"><span class="font-icon icon iconfont icon-edit" style=""></span>SpringMVC<!----></a></li><li class="dropdown-subitem"><a href="/backend/dev_framework/Spring5.html" class="nav-link" aria-label="Spring5"><span class="font-icon icon iconfont icon-edit" style=""></span>Spring5<!----></a></li><li class="dropdown-subitem"><a href="/backend/dev_framework/Mybatis.html" class="nav-link" aria-label="Mybatis"><span class="font-icon icon iconfont icon-edit" style=""></span>Mybatis<!----></a></li><li class="dropdown-subitem"><a href="/backend/dev_framework/MybatisPlus.html" class="nav-link" aria-label="MybatisPlus"><span class="font-icon icon iconfont icon-edit" style=""></span>MybatisPlus<!----></a></li><li class="dropdown-subitem"><a href="/backend/dev_framework/SpringCloud.html" class="nav-link" aria-label="SpringCloud &amp; ~Aibaba"><span class="font-icon icon iconfont icon-edit" style=""></span>SpringCloud &amp; ~Aibaba<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Middleware</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/middleware/MQ.html" class="nav-link" aria-label="MQ"><span class="font-icon icon iconfont icon-edit" style=""></span>MQ<!----></a></li><li class="dropdown-subitem"><a href="/backend/middleware/Redis.html" class="nav-link" aria-label="Redis"><span class="font-icon icon iconfont icon-edit" style=""></span>Redis<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Skills</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/skills/DataStructureAlgorithm.html" class="nav-link" aria-label="DataStructureAlgorithm"><span class="font-icon icon iconfont icon-edit" style=""></span>DataStructureAlgorithm<!----></a></li><li class="dropdown-subitem"><a href="/backend/skills/ComputerNetwork.html" class="nav-link" aria-label="ComputerNetwork"><span class="font-icon icon iconfont icon-edit" style=""></span>ComputerNetwork<!----></a></li><li class="dropdown-subitem"><a href="/backend/skills/OperatingSystem.html" class="nav-link" aria-label="OperatingSystem"><span class="font-icon icon iconfont icon-edit" style=""></span>OperatingSystem<!----></a></li><li class="dropdown-subitem"><a href="/backend/skills/Methodology.html" class="nav-link" aria-label="Methodology"><span class="font-icon icon iconfont icon-edit" style=""></span>Methodology<!----></a></li><li class="dropdown-subitem"><a href="/backend/skills/IO.html" class="nav-link" aria-label="IO"><span class="font-icon icon iconfont icon-edit" style=""></span>IO<!----></a></li><li class="dropdown-subitem"><a href="/backend/skills/Netty.html" class="nav-link" aria-label="Netty"><span class="font-icon icon iconfont icon-edit" style=""></span>Netty<!----></a></li><li class="dropdown-subitem"><a href="/backend/skills/Linux.html" class="nav-link" aria-label="Linux"><span class="font-icon icon iconfont icon-edit" style=""></span>Linux<!----></a></li><li class="dropdown-subitem"><a href="/backend/skills/Dubbo.html" class="nav-link" aria-label="Dubbo"><span class="font-icon icon iconfont icon-edit" style=""></span>Dubbo<!----></a></li><li class="dropdown-subitem"><a href="/backend/skills/Zookeeper.html" class="nav-link" aria-label="Zookeeper"><span class="font-icon icon iconfont icon-edit" style=""></span>Zookeeper<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Tools</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/tools/Docker.html" class="nav-link" aria-label="Docker"><span class="font-icon icon iconfont icon-edit" style=""></span>Docker<!----></a></li><li class="dropdown-subitem"><a href="/backend/tools/Git.html" class="nav-link" aria-label="Git"><span class="font-icon icon iconfont icon-edit" style=""></span>Git<!----></a></li><li class="dropdown-subitem"><a href="/backend/tools/Maven.html" class="nav-link" aria-label="Maven"><span class="font-icon icon iconfont icon-edit" style=""></span>Maven<!----></a></li><li class="dropdown-subitem"><a href="/backend/tools/Nginx.html" class="nav-link" aria-label="Nginx"><span class="font-icon icon iconfont icon-edit" style=""></span>Nginx<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/article-papper/" class="nav-link" aria-label="Article &amp; Papper"><span class="font-icon icon iconfont icon-note" style=""></span>Article &amp; Papper<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/EddieZturbo/Eddie-Tech-Blog.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/" class="nav-link sidebar-link sidebar-page" aria-label="Home"><span class="font-icon icon iconfont icon-home" style=""></span>Home<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-discover" style=""></span><a href="/eddie/" class="title">Eddie</a><!----></p><ul class="sidebar-links"></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading active"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">Backend-Dev</span><!----></p><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Database</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Dev Framework</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Java</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/backend/java/java_concurrency_programming.html" class="nav-link sidebar-link sidebar-page" aria-label="Java Concurrency Programming"><!---->Java Concurrency Programming<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/backend/java/Java.html" class="nav-link sidebar-link sidebar-page" aria-label="Java Start"><!---->Java Start<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/backend/java/jvm.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Java Virtual Machine"><!---->Java Virtual Machine<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvm-structure" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVM Structure"><!---->JVM Structure<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvmçš„æ¶æ„æ¨¡å‹-åŸºäºæ ˆå¼æ¶æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVMçš„æ¶æ„æ¨¡å‹ åŸºäºæ ˆå¼æ¶æ„"><!---->JVMçš„æ¶æ„æ¨¡å‹ åŸºäºæ ˆå¼æ¶æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvmç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVMç”Ÿå‘½å‘¨æœŸ"><!---->JVMç”Ÿå‘½å‘¨æœŸ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvm-parameters-setting" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVM Parameters Setting"><!---->JVM Parameters Setting<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#look-up-jvm-information" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Look up JVM information"><!---->Look up JVM information<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#cmd" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CMD"><!---->CMD<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#debug-run-configurations-idea-interface" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Debug/Run Configurations(IDEA Interface)"><!---->Debug/Run Configurations(IDEA Interface)<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#class-loading-subsystem" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Class Loading Subsystem"><!---->Class Loading Subsystem<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#ç±»åŠ è½½å™¨å’Œç±»çš„åŠ è½½è¿‡ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç±»åŠ è½½å™¨å’Œç±»çš„åŠ è½½è¿‡ç¨‹"><!---->ç±»åŠ è½½å™¨å’Œç±»çš„åŠ è½½è¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#ç±»çš„åŠ è½½è¿‡ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç±»çš„åŠ è½½è¿‡ç¨‹"><!---->ç±»çš„åŠ è½½è¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#ç±»åŠ è½½å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç±»åŠ è½½å™¨"><!---->ç±»åŠ è½½å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvmä¸­åˆ¤æ–­classå¯¹è±¡ç›¸åŒçš„æ ‡å‡†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVMä¸­åˆ¤æ–­classå¯¹è±¡ç›¸åŒçš„æ ‡å‡†"><!---->JVMä¸­åˆ¤æ–­classå¯¹è±¡ç›¸åŒçš„æ ‡å‡†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#ç±»åŠ è½½å™¨çš„å¼•ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç±»åŠ è½½å™¨çš„å¼•ç”¨"><!---->ç±»åŠ è½½å™¨çš„å¼•ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼"><!---->Javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvm-runtime-memory-area" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVM Runtime Memory Area"><!---->JVM Runtime Memory Area<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#ç¨‹åºè®¡æ•°å™¨-pc-regisster" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¨‹åºè®¡æ•°å™¨ï¼ˆPC Regissterï¼‰"><!---->ç¨‹åºè®¡æ•°å™¨ï¼ˆPC Regissterï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#è™šæ‹Ÿæœºæ ˆ-jvm-stack" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è™šæ‹Ÿæœºæ ˆï¼ˆJVM Stackï¼‰"><!---->è™šæ‹Ÿæœºæ ˆï¼ˆJVM Stackï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰"><!---->æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#å †-heep" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å †ï¼ˆheepï¼‰"><!---->å †ï¼ˆheepï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#æ–¹æ³•åŒº-method-area" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰"><!---->æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#java-object" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Java Object"><!---->Java Object<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#åˆ›å»ºå¯¹è±¡çš„æ–¹å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ›å»ºå¯¹è±¡çš„æ–¹å¼"><!---->åˆ›å»ºå¯¹è±¡çš„æ–¹å¼<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤"><!---->åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#å†…å­˜å¸ƒå±€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å†…å­˜å¸ƒå±€"><!---->å†…å­˜å¸ƒå±€<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#è®¿é—®å®šä½" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è®¿é—®å®šä½"><!---->è®¿é—®å®šä½<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvm-garbage-collection" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVM Garbage Collection"><!---->JVM Garbage Collection<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#heap-area" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Heap Area"><!---->Heap Area<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#memory-allocation-strategy" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Memory allocation strategy"><!---->Memory allocation strategy<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#minor-gc-major-gc-full-gc" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Minor GCï¼ŒMajor GCï¼ŒFull GC"><!---->Minor GCï¼ŒMajor GCï¼ŒFull GC<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#trigger-conditions-for-gc" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Trigger conditions for GC"><!---->Trigger conditions for GC<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#garbage-collection-algorithm" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Garbage collection algorithm"><!---->Garbage collection algorithm<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#garbage-collector" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Garbage Collector"><!---->Garbage Collector<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#judgment-of-the-object-of-death" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Judgment of the object of death"><!---->Judgment of the object of death<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#the-reference-type-of-the-object" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="The reference type of the object"><!---->The reference type of the object<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#a-class-that-is-judged-to-be-useless" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="A class that is judged to be useless"><!---->A class that is judged to be useless<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvm-out-of-memory" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVM Out Of Memory"><!---->JVM Out Of Memory<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/backend/java/jvm.html#jvm-performance-optimization" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVM Performance Optimization"><!---->JVM Performance Optimization<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/backend/java/java8.html" class="nav-link sidebar-link sidebar-page" aria-label="Java8å‡½æ•°å¼ç¼–ç¨‹"><!---->Java8å‡½æ•°å¼ç¼–ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Middleware</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Skills</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Tools</span><span class="arrow end"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">Article &amp; Papper</span><!----></p><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Article</span><span class="arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Java Virtual Machine</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/EddieZturbo" target="_blank" rel="noopener noreferrer">EddieZ</a></span><span property="author" content="EddieZ"></span></span><!----><!----><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 71 min</span><meta property="timeRequired" content="PT71M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page<button class="print-button" title="print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvm-structure" class="router-link-active router-link-exact-active toc-link level2">JVM Structure</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvmçš„æ¶æ„æ¨¡å‹-åŸºäºæ ˆå¼æ¶æ„" class="router-link-active router-link-exact-active toc-link level3">JVMçš„æ¶æ„æ¨¡å‹ åŸºäºæ ˆå¼æ¶æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvmç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active toc-link level3">JVMç”Ÿå‘½å‘¨æœŸ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvm-parameters-setting" class="router-link-active router-link-exact-active toc-link level2">JVM Parameters Setting</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#look-up-jvm-information" class="router-link-active router-link-exact-active toc-link level2">Look up JVM information</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#cmd" class="router-link-active router-link-exact-active toc-link level3">CMD</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#debug-run-configurations-idea-interface" class="router-link-active router-link-exact-active toc-link level3">Debug/Run Configurations(IDEA Interface)</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#class-loading-subsystem" class="router-link-active router-link-exact-active toc-link level2">Class Loading Subsystem</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#ç±»åŠ è½½å™¨å’Œç±»çš„åŠ è½½è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">ç±»åŠ è½½å™¨å’Œç±»çš„åŠ è½½è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#ç±»çš„åŠ è½½è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">ç±»çš„åŠ è½½è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#ç±»åŠ è½½å™¨" class="router-link-active router-link-exact-active toc-link level3">ç±»åŠ è½½å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvmä¸­åˆ¤æ–­classå¯¹è±¡ç›¸åŒçš„æ ‡å‡†" class="router-link-active router-link-exact-active toc-link level3">JVMä¸­åˆ¤æ–­classå¯¹è±¡ç›¸åŒçš„æ ‡å‡†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#ç±»åŠ è½½å™¨çš„å¼•ç”¨" class="router-link-active router-link-exact-active toc-link level3">ç±»åŠ è½½å™¨çš„å¼•ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">Javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvm-runtime-memory-area" class="router-link-active router-link-exact-active toc-link level2">JVM Runtime Memory Area</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#ç¨‹åºè®¡æ•°å™¨-pc-regisster" class="router-link-active router-link-exact-active toc-link level3">ç¨‹åºè®¡æ•°å™¨ï¼ˆPC Regissterï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#è™šæ‹Ÿæœºæ ˆ-jvm-stack" class="router-link-active router-link-exact-active toc-link level3">è™šæ‹Ÿæœºæ ˆï¼ˆJVM Stackï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" class="router-link-active router-link-exact-active toc-link level3">æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#å †-heep" class="router-link-active router-link-exact-active toc-link level3">å †ï¼ˆheepï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#æ–¹æ³•åŒº-method-area" class="router-link-active router-link-exact-active toc-link level3">æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#java-object" class="router-link-active router-link-exact-active toc-link level2">Java Object</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#åˆ›å»ºå¯¹è±¡çš„æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">åˆ›å»ºå¯¹è±¡çš„æ–¹å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤" class="router-link-active router-link-exact-active toc-link level3">åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#å†…å­˜å¸ƒå±€" class="router-link-active router-link-exact-active toc-link level3">å†…å­˜å¸ƒå±€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#è®¿é—®å®šä½" class="router-link-active router-link-exact-active toc-link level3">è®¿é—®å®šä½</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvm-garbage-collection" class="router-link-active router-link-exact-active toc-link level2">JVM Garbage Collection</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#heap-area" class="router-link-active router-link-exact-active toc-link level3">Heap Area</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#memory-allocation-strategy" class="router-link-active router-link-exact-active toc-link level3">Memory allocation strategy</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#minor-gc-major-gc-full-gc" class="router-link-active router-link-exact-active toc-link level3">Minor GCï¼ŒMajor GCï¼ŒFull GC</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#trigger-conditions-for-gc" class="router-link-active router-link-exact-active toc-link level3">Trigger conditions for GC</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#garbage-collection-algorithm" class="router-link-active router-link-exact-active toc-link level3">Garbage collection algorithm</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#garbage-collector" class="router-link-active router-link-exact-active toc-link level3">Garbage Collector</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#judgment-of-the-object-of-death" class="router-link-active router-link-exact-active toc-link level3">Judgment of the object of death</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#the-reference-type-of-the-object" class="router-link-active router-link-exact-active toc-link level3">The reference type of the object</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#a-class-that-is-judged-to-be-useless" class="router-link-active router-link-exact-active toc-link level3">A class that is judged to be useless</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvm-out-of-memory" class="router-link-active router-link-exact-active toc-link level2">JVM Out Of Memory</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/backend/java/jvm.html#jvm-performance-optimization" class="router-link-active router-link-exact-active toc-link level2">JVM Performance Optimization</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="java-virtual-machine" tabindex="-1"><a class="header-anchor" href="#java-virtual-machine" aria-hidden="true">#</a> Java Virtual Machine</h1><blockquote><p>JVM stands for Java Virtual Machine. It is a software that provides a runtime environment for executing Java programs.</p><p>Java is a high-level programming language that can run on multiple platforms, such as Windows, Linux, and macOS, without needing to be recompiled for each platform. JVM is responsible for making this possible by providing an abstraction layer between the Java program and the underlying hardware and operating system.</p><p>When a Java program is compiled, it is transformed into a platform-independent bytecode format that can be executed by the JVM. The JVM then translates the bytecode into machine code that can be understood by the host operating system.</p><p>The JVM also provides a number of other features,</p><p>such as <strong>automatic memory management (garbage collection&amp;memory allocation)</strong>, <strong>dynamic class loading</strong>, and <strong>security management</strong>,</p><p>which make it easier to develop and run Java applications.</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230403103945508.png" alt="image-20230403103945508"></p></blockquote><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230401002339258.png" alt="image-20230401002339258"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230401002814894.png" alt="image-20230401002814894"></p><h2 id="jvm-structure" tabindex="-1"><a class="header-anchor" href="#jvm-structure" aria-hidden="true">#</a> JVM Structure</h2><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927101506965.png" alt="image-20220927101506965"></p><h3 id="jvmçš„æ¶æ„æ¨¡å‹-åŸºäºæ ˆå¼æ¶æ„" tabindex="-1"><a class="header-anchor" href="#jvmçš„æ¶æ„æ¨¡å‹-åŸºäºæ ˆå¼æ¶æ„" aria-hidden="true">#</a> <strong>JVMçš„æ¶æ„æ¨¡å‹ åŸºäºæ ˆå¼æ¶æ„</strong></h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920102914097.png" alt="image-20220920102914097"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920102933595.png" alt="image-20220920102933595"></p><h3 id="jvmç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#jvmç”Ÿå‘½å‘¨æœŸ" aria-hidden="true">#</a> JVMç”Ÿå‘½å‘¨æœŸ</h3><p><strong>å¯åŠ¨â€”â€”æ‰§è¡Œâ€”â€”é€€å‡º</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920103222871.png" alt="image-20220920103222871"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920103234998.png" alt="image-20220920103234998"></p><h2 id="jvm-parameters-setting" tabindex="-1"><a class="header-anchor" href="#jvm-parameters-setting" aria-hidden="true">#</a> JVM Parameters Setting</h2><p>https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html</p><blockquote><h3 id="heap-memory-management" tabindex="-1"><a class="header-anchor" href="#heap-memory-management" aria-hidden="true">#</a> <strong>heap memory management</strong></h3><table><thead><tr><th>Option and Default Value</th><th>Description</th></tr></thead><tbody><tr><td>-Xmx [Unit]</td><td>Maximum use memory size(default 1/4 system memory)</td></tr><tr><td>-Xms [Unit]</td><td>Minimum use memory size(default 1/64 system memory)</td></tr><tr><td>-XX:NewSize= [Unit]</td><td>Young generation heap size</td></tr><tr><td>-XX:MaxNewSize= [Unit]</td><td>Young generation max heap size</td></tr><tr><td>-XX:NewRatio=n</td><td>Ratio of old/new generation sizes. The default value is 2.</td></tr><tr><td>-XX:SurvivorRatio=n</td><td>Ratio of eden/survivor space size. The default value is 8.</td></tr><tr><td>-XX:MaxPermSize= [Unit]</td><td>Permanent generation max heap size</td></tr><tr><td>-XX:PermSize= [Unit]</td><td>Permanent heap size</td></tr><tr><td>-XX:MaxMetaspaceSize=metaspace size[unit]</td><td>Size is not defined. JVM automatically increases it.We can set Metaspace size</td></tr><tr><td>-XX:MaxDirectMemorySize=1g</td><td>Sets the maximum size of direct memory.</td></tr><tr><td>-XX:MaxHeapSize=1g</td><td>Sets the maximum size of heap memory.</td></tr><tr><td>-XX:MaxHeapFreeRatio=70</td><td>Maximum percentage of heap free after GC to avoid shrinking.</td></tr><tr><td>-XX:MinHeapFreeRatio=30</td><td>sets the minimum percentage of heap free after GC to avoid expansion.</td></tr><tr><td>-XX:+UseTLAB</td><td>Use thread-local allocation buffer</td></tr></tbody></table><h3 id="gc-logging" tabindex="-1"><a class="header-anchor" href="#gc-logging" aria-hidden="true">#</a> GC Logging</h3><table><thead><tr><th>Option and Default Value</th><th>Description</th></tr></thead><tbody><tr><td>-XX:+PrintGCDetails</td><td>Print GC details Messages</td></tr><tr><td>-XX:+PrintGCDateStamps</td><td>Can be used for the printing of a date stamp at every GC</td></tr><tr><td>-Xloggc:/home/DATA/filename</td><td>Log GC verbose output to specified file. The verbose output is controlled by the normal verbose GC flags.</td></tr><tr><td>-XX:+UseGCLogFileRotation</td><td>Enabled GC log rotation</td></tr><tr><td>-XX:NumberOfGClogFiles=1</td><td>Set the number of files to use when rotating logs, default value is 1 and it should be always &gt;=1</td></tr><tr><td>-XX:GCLogFileSize=8K</td><td>The size of the log file at which point the log will be rotated, must be &gt;= 8K.default will be set to 512K</td></tr></tbody></table><h3 id="class-information-tracking" tabindex="-1"><a class="header-anchor" href="#class-information-tracking" aria-hidden="true">#</a> Class information tracking</h3><table><thead><tr><th>Option and Default Value</th><th>Description</th></tr></thead><tbody><tr><td>-verbose className</td><td>Displays detailed information about the class loading, including the ClassLoader to which the class name is loaded.</td></tr><tr><td>-XX:+TraceClassLoading</td><td>Trace loading of classes.</td></tr><tr><td>-XX:+TraceClassUnloading</td><td>Trace unloading of classes.</td></tr><tr><td>-XX:+PrintClassLoaders</td><td>Displays information about all classloaders , including ClassLoader types and parent-child relationships</td></tr><tr><td>-XX:+PrintClassHistogram</td><td>Print a histogram(JVMä¸­æ‰€æœ‰å·²åŠ è½½ç±»çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»çš„æ•°é‡ã€å¤§å°ç­‰) of class instances.</td></tr><tr><td>-XX:-TraceClassResolution</td><td>Trace constant pool resolutions.</td></tr><tr><td>-XX:+PrintCompilation</td><td>æ‰“å°JITç¼–è¯‘å™¨ç¼–è¯‘çš„æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¼–è¯‘æ—¶é—´ã€ç¼–è¯‘çº§åˆ«ç­‰</td></tr><tr><td>-XX:+PrintTenuringDistribution</td><td>Print tenuring age information.</td></tr></tbody></table><h3 id="garbage-collection" tabindex="-1"><a class="header-anchor" href="#garbage-collection" aria-hidden="true">#</a> Garbage Collection</h3><table><thead><tr><th>Option and Default Value</th><th>Description</th></tr></thead><tbody><tr><td>-XX:+UseSerialGC</td><td>Use Serial Collector</td></tr><tr><td>â€“XX:+UseParallelGC</td><td>Use Parallel Collector</td></tr><tr><td>XX:+USeParNewGC</td><td>Use ParNew Collector</td></tr><tr><td>XX:+USeG1GC</td><td>Use G1 Collector</td></tr><tr><td>-XX:+UseAdaptiveSizePolicy</td><td>Enable an adaptive garbage collection policy</td></tr><tr><td>-XX:-DisableExplicitGC</td><td>Disable explicit GC such:System.gc()</td></tr></tbody></table><h3 id="thread-paramerters" tabindex="-1"><a class="header-anchor" href="#thread-paramerters" aria-hidden="true">#</a> Thread Paramerters</h3><table><thead><tr><th>Option and Default Value</th><th>Description</th></tr></thead><tbody><tr><td>-XX:ThreadStackSize=512</td><td>Thread Stack Size</td></tr><tr><td>-XX:ParallelGCThreads=n</td><td>Sets the number of garbage collection threads in the young and old parallel garbage collectors.</td></tr></tbody></table></blockquote><h2 id="look-up-jvm-information" tabindex="-1"><a class="header-anchor" href="#look-up-jvm-information" aria-hidden="true">#</a> Look up JVM information</h2><h3 id="cmd" tabindex="-1"><a class="header-anchor" href="#cmd" aria-hidden="true">#</a> CMD</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230608145450876.png" alt="image-20230608145450876"></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\</span>IDEA_2019_1_3<span class="token punctuation">\</span>WorkSpace<span class="token punctuation">\</span>statistics-analysis<span class="token operator">&gt;</span>jps
<span class="token number">19504</span> CepreiApplication
<span class="token number">21312</span> Launcher
<span class="token number">4432</span> Jps
<span class="token number">8740</span> KotlinCompileDaemon
<span class="token number">12088</span> RemoteMavenServer
<span class="token number">18540</span>

D:<span class="token punctuation">\</span>IDEA_2019_1_3<span class="token punctuation">\</span>WorkSpace<span class="token punctuation">\</span>statistics-analysis<span class="token operator">&gt;</span>jinfo <span class="token parameter variable">-flags</span> <span class="token number">19504</span>
Attaching to process ID <span class="token number">19504</span>, please wait<span class="token punctuation">..</span>.
Debugger attached successfully.
Server compiler detected.
JVM version is <span class="token number">25.162</span>-b12
Non-default VM flags: <span class="token parameter variable">-XX:-BytecodeVerificationLocal</span> <span class="token parameter variable">-XX:-BytecodeVerificationRemote</span> <span class="token parameter variable">-XX:CICompilerCount</span><span class="token operator">=</span><span class="token number">12</span> <span class="token parameter variable">-XX:InitialHeapSize</span><span class="token operator">=</span><span class="token number">532676608</span> <span class="token parameter variable">-XX:+ManagementServer</span> <span class="token parameter variable">-XX:MaxHeapSize</span><span class="token operator">=</span><span class="token number">851443712</span>
<span class="token number">0</span> <span class="token parameter variable">-XX:MaxNewSize</span><span class="token operator">=</span><span class="token number">2837970944</span> <span class="token parameter variable">-XX:MinHeapDeltaBytes</span><span class="token operator">=</span><span class="token number">524288</span> <span class="token parameter variable">-XX:NewSize</span><span class="token operator">=</span><span class="token number">177209344</span> <span class="token parameter variable">-XX:OldSize</span><span class="token operator">=</span><span class="token number">355467264</span> <span class="token parameter variable">-XX:TieredStopAtLevel</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-XX:+UseCompressedClassPointers</span> <span class="token parameter variable">-XX:+UseCompressedOops</span> -XX:+
UseFastUnorderedTimeStamps <span class="token parameter variable">-XX:-UseLargePagesIndividualAllocation</span> <span class="token parameter variable">-XX:+UseParallelGC</span>
Command line:  <span class="token parameter variable">-XX:TieredStopAtLevel</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-Xverify:none</span> <span class="token parameter variable">-Dspring.output.ansi.enabled</span><span class="token operator">=</span>always <span class="token parameter variable">-Dcom.sun.management.jmxremote</span> <span class="token parameter variable">-Dspring.jmx.enabled</span><span class="token operator">=</span>true <span class="token parameter variable">-Dspring.liveBeansView.mbeanDomain</span> <span class="token parameter variable">-Dsp</span>
<span class="token assign-left variable">ring.application.admin.enabled</span><span class="token operator">=</span>true -javaagent:D:<span class="token punctuation">\</span>IDEA_2019_1_3<span class="token punctuation">\</span>IntelliJ IDEA <span class="token number">2019.1</span>.3<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>idea_rt.jar<span class="token operator">=</span><span class="token number">52294</span>:D:<span class="token punctuation">\</span>IDEA_2019_1_3<span class="token punctuation">\</span>IntelliJ IDEA <span class="token number">2019.1</span>.3<span class="token punctuation">\</span>bin <span class="token parameter variable">-Dfile.encoding</span><span class="token operator">=</span>UTF-8

D:<span class="token punctuation">\</span>IDEA_2019_1_3<span class="token punctuation">\</span>WorkSpace<span class="token punctuation">\</span>statistics-analysis<span class="token operator">&gt;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="debug-run-configurations-idea-interface" tabindex="-1"><a class="header-anchor" href="#debug-run-configurations-idea-interface" aria-hidden="true">#</a> Debug/Run Configurations(IDEA Interface)</h3><blockquote><p>-XX:+PrintCommandLineFlags</p></blockquote><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230608145750396.png" alt="image-20230608145750396"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230608145825948.png" alt="image-20230608145825948"></p><h2 id="class-loading-subsystem" tabindex="-1"><a class="header-anchor" href="#class-loading-subsystem" aria-hidden="true">#</a> Class Loading Subsystem</h2><h3 id="ç±»åŠ è½½å™¨å’Œç±»çš„åŠ è½½è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨å’Œç±»çš„åŠ è½½è¿‡ç¨‹" aria-hidden="true">#</a> ç±»åŠ è½½å™¨å’Œç±»çš„åŠ è½½è¿‡ç¨‹</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920104243326.png" alt="image-20220920104243326"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920104757585.png" alt="image-20220920104757585"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920104740671.png" alt="image-20220920104740671"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920110604499.png" alt="image-20220920110604499"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920110910892.png" alt="image-20220920110910892"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920110924167.png" alt="image-20220920110924167"></p><h3 id="ç±»çš„åŠ è½½è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#ç±»çš„åŠ è½½è¿‡ç¨‹" aria-hidden="true">#</a> ç±»çš„åŠ è½½è¿‡ç¨‹</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920111431881.png" alt="image-20220920111431881"></p><p>ä¸€ä¸ªJavaæ–‡ä»¶ä»ç¼–ç å®Œæˆåˆ°æœ€ç»ˆè¿è¡Œï¼Œä¸€èˆ¬ä¼šç»å†ä¸¤ä¸ªé˜¶æ®µï¼šç¼–è¯‘æœŸã€è¿è¡ŒæœŸã€‚ç¼–è¯‘ï¼Œå³é€šè¿‡javacå‘½ä»¤ï¼Œå°†Javaæ–‡ä»¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—èŠ‚ç æ–‡ä»¶ï¼Œå³.classæ–‡ä»¶ï¼›è¿è¡Œï¼Œåˆ™æ˜¯å°†.classæ–‡ä»¶äº¤ç»™JVMæ‰§è¡Œã€‚è€Œæœ¬æ–‡æ‰€è¯´çš„ç±»åŠ è½½è¿‡ç¨‹å°±æ˜¯å°†.classæ–‡ä»¶ä¸­ç±»çš„å…ƒä¿¡æ¯åŠ è½½è¿›å†…å­˜ï¼Œåˆ›å»ºClasså¯¹è±¡å¹¶è¿›è¡Œè§£æã€åˆå§‹åŒ–ç±»å˜é‡ç­‰çš„è¿‡ç¨‹ JVMå¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±ä¼šå°†æ‰€æœ‰çš„ç±»åŠ è½½åˆ°å†…å­˜ï¼Œè€Œæ˜¯ç”¨åˆ°æŸä¸ªç±»ï¼Œæ‰ä¼šå»åŠ è½½ï¼ŒåªåŠ è½½ä¸€æ¬¡ï¼Œåç»­ä¼šè¯´åˆ°ç±»çš„åŠ è½½æ—¶æœº</p><ol start="2"><li>ç±»åŠ è½½è¯¦è§£ ç±»åŠ è½½åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šåŠ è½½ã€è¿æ¥ã€åˆå§‹åŒ–</li><li><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920112538821.png" alt="image-20220920112538821"></li></ol><h4 id="åŠ è½½" tabindex="-1"><a class="header-anchor" href="#åŠ è½½" aria-hidden="true">#</a> åŠ è½½</h4><p>åŠ è½½ <strong>ç±»çš„åŠ è½½ä¸»è¦çš„èŒè´£ä¸ºå°†.classæ–‡ä»¶çš„äºŒè¿›åˆ¶å­—èŠ‚æµè¯»å…¥å†…å­˜</strong>(JDK1.7åŠä¹‹å‰ä¸ºJVMå†…å­˜(æ–¹æ³•åŒº)ï¼ŒJDK1.8åŠä¹‹åä¸ºæœ¬åœ°å†…å­˜(å…ƒç©ºé—´))ï¼Œå¹¶<strong>åœ¨å †å†…å­˜ä¸­ä¸ºä¹‹åˆ›å»ºClasså¯¹è±¡</strong>ï¼Œ<strong>ä½œä¸º.classè¿›å…¥å†…å­˜åçš„æ•°æ®çš„è®¿é—®å…¥å£</strong>ã€‚</p><p><strong>åœ¨è¿™é‡Œåªæ˜¯è¯»å…¥äºŒè¿›åˆ¶å­—èŠ‚æµï¼Œåç»­çš„éªŒè¯é˜¶æ®µå°±æ˜¯è¦æ‹¿äºŒè¿›åˆ¶å­—èŠ‚æµæ¥éªŒè¯.classæ–‡ä»¶ï¼ŒéªŒè¯é€šè¿‡ï¼Œæ‰ä¼šå°†.classæ–‡ä»¶è½¬ä¸ºè¿è¡Œæ—¶æ•°æ®ç»“æ„</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920160057893.png" alt="image-20220920160057893"></p><p>â€‹ <strong>++æ‹“å±•</strong>ï¼š åœ¨<strong>JDK1.7åŠä»¥å‰</strong>ï¼ŒHot Spot JVM(æ™®éåœ¨ç”¨çš„JVM)å­˜åœ¨ä¸€å—å«åš<strong>æ–¹æ³•åŒº</strong>çš„å†…å­˜ï¼Œä¹Ÿç§°ä¹‹ä¸º<strong>æ°¸ä¹…ä»£</strong>ï¼Œè¿™å—åŒºåŸŸç”¨äºå­˜æ”¾ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»çš„å­—æ®µï¼Œç‰ˆæœ¬ï¼Œæ–¹æ³•ç­‰ï¼Œè¿™å—åŒºåŸŸï¼Œå¯ä»¥ç†è§£ä¸º.classæ–‡ä»¶è¿›å…¥å†…å­˜åçš„ä½ç½®ã€‚åœ¨<strong>JDK1.8</strong>ï¼Œå–æ¶ˆäº†æ–¹æ³•åŒºï¼Œå–è€Œä»£ä¹‹çš„æ˜¯<strong>å…ƒæ•°æ®åŒº</strong>ï¼Œè¯¥å…ƒæ•°æ®åŒºå¹¶éJVMå†…å­˜ï¼Œè€Œæ˜¯<strong>æœ¬åœ°å†…å­˜</strong>ã€‚æ­¤å¤–åœ¨JDK1.7æ—¶ï¼Œå°†å¸¸é‡æ± ä»æ–¹æ³•åŒºç§»é™¤ï¼Œåœ¨å †å†…å­˜å¼€è¾Ÿäº†ä¸€å—ç©ºé—´ä½œä¸ºå¸¸é‡æ± ï¼Œæœ‰äººè¯´è¿™æ˜¯ä¸ºå–æ¶ˆæ–¹æ³•åŒºåšçš„å‡†å¤‡ã€‚æ›´å¤šè¯·ç‚¹æˆ‘çœ‹æ€ç»´å¯¼å›¾æ€»ç»“ â€‹ <strong>++åŠ åˆ†é¡¹ï¼š ä¸ºä½•å–æ¶ˆæ–¹æ³•åŒº</strong>ï¼Ÿ â€‹ å®˜æ–¹è¯´æ³•ä¸ºï¼š<strong>ç§»é™¤æ°¸ä¹…ä»£æ˜¯ä¸ºèåˆHotSpot JVMä¸ JRockit VMè€Œåšå‡ºçš„åŠªåŠ›</strong>ï¼Œ<strong>å› ä¸ºJRockitæ²¡æœ‰æ°¸ä¹…ä»£</strong>ï¼Œä¸éœ€è¦é…ç½®æ°¸ä¹…ä»£ â€‹ ç°å®ä½¿ç”¨ä¸­å­˜åœ¨é—®é¢˜ï¼šæ–¹æ³•åŒºå­˜å‚¨ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¸æ¸…æ¥šä¸€ä¸ªç¨‹åºåˆ°åº•æœ‰å¤šå°‘ç±»éœ€è¦è¢«åŠ è½½ï¼Œä¸”æ–¹æ³•åŒºä½äºJVMå†…å­˜ï¼Œæˆ‘ä»¬ä¸æ¸…æ¥šéœ€è¦ç»™æ–¹æ³•åŒºåˆ†é…å¤šå¤§å†…å­˜ï¼Œå¤ªå°å®¹æ˜“PermGen OOMï¼Œå¤ªå¤§ï¼Œåœ¨è§¦å‘Full GCæ—¶åˆæå…¶å½±å“æ€§èƒ½ï¼ŒåŒæ—¶è¿˜å­˜åœ¨ä¸€äº›å†…å­˜æ³„éœ²çš„é—®é¢˜</p><h4 id="é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#é“¾æ¥" aria-hidden="true">#</a> é“¾æ¥</h4><h5 id="éªŒè¯" tabindex="-1"><a class="header-anchor" href="#éªŒè¯" aria-hidden="true">#</a> éªŒè¯</h5><p>è¯¥é˜¶æ®µä¸»è¦æ˜¯ä¸ºäº†<strong>ä¿è¯åŠ è½½è¿›æ¥çš„å­—èŠ‚æµç¬¦åˆJVMçš„è§„èŒƒ</strong>ï¼Œ<strong>ä¸ä¼šå¯¹JVMæœ‰å®‰å…¨æ€§é—®é¢˜</strong>ã€‚å…¶ä¸­æœ‰å¯¹å…ƒæ•°æ®çš„éªŒè¯ï¼Œä¾‹å¦‚æ£€æŸ¥ç±»æ˜¯å¦ç»§æ‰¿äº†è¢«finalä¿®é¥°çš„ç±»ï¼›è¿˜æœ‰å¯¹ç¬¦å·å¼•ç”¨çš„éªŒè¯ï¼Œä¾‹å¦‚æ ¡éªŒç¬¦å·å¼•ç”¨æ˜¯å¦å¯ä»¥é€šè¿‡å…¨é™å®šåæ‰¾åˆ°ï¼Œæˆ–è€…æ˜¯æ£€æŸ¥ç¬¦å·å¼•ç”¨çš„æƒé™(privateã€public)æ˜¯å¦ç¬¦åˆè¯­æ³•è§„å®šç­‰ã€‚</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920160256311.png" alt="image-20220920160256311"></p><p>ä¸»è¦åŒ…æ‹¬å››ç§éªŒè¯ï¼š<strong>æ–‡ä»¶æ ¼å¼éªŒè¯</strong> <strong>å…ƒæ•°æ®éªŒè¯</strong> <strong>å­—èŠ‚ç éªŒè¯</strong> <strong>ç¬¦å·å¼•ç”¨éªŒè¯</strong></p><h5 id="å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#å‡†å¤‡" aria-hidden="true">#</a> å‡†å¤‡</h5><p>å‡†å¤‡é˜¶æ®µçš„ä¸»è¦ä»»åŠ¡æ˜¯<strong>ä¸ºç±»çš„ç±»å˜é‡ï¼ˆstaticï¼‰å¼€è¾Ÿç©ºé—´å¹¶èµ‹é»˜è®¤å€¼</strong>ã€‚</p><p>1ã€é™æ€å˜é‡æ˜¯åŸºæœ¬ç±»å‹ï¼ˆintã€longã€shortã€charã€byteã€booleanã€floatã€doubleï¼‰çš„é»˜è®¤å€¼ä¸º0 2ã€é™æ€å˜é‡æ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œé»˜è®¤å€¼ä¸ºnull 3ã€é™æ€å¸¸é‡é»˜è®¤å€¼ä¸ºå£°æ˜æ—¶è®¾å®šçš„å€¼</p><p><strong>ä¾‹å¦‚ï¼špublic static final int i = 3; åœ¨å‡†å¤‡é˜¶æ®µï¼Œiçš„å€¼å³ä¸º3</strong></p><p><strong>static final åœ¨ç¼–è¯‘çš„æ—¶å€™å°±åˆ†é… å‡†å¤‡é˜¶æ®µä¼šæ˜¾ç¤ºåˆå§‹åŒ–</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoadingTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> num1 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token comment">//prepare:num = 3;//static finalåœ¨å‡†å¤‡é˜¶æ®µå°±æ˜¾ç¤ºåˆå§‹åŒ–</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//prepare:num = 0;initial:num = 1;å‡†å¤‡é˜¶æ®µçš„ä¸»è¦ä»»åŠ¡æ˜¯**ä¸ºç±»çš„ç±»å˜é‡ï¼ˆstaticï¼‰å¼€è¾Ÿç©ºé—´å¹¶èµ‹é»˜è®¤å€¼**</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¿™é‡Œä¸ä¼šä¸ºå®ä¾‹å˜é‡åˆ†é…åˆå§‹åŒ–ï¼Œ</strong> <strong>ç±»å˜é‡ä¼šåˆ†é…åœ¨æ–¹æ³•åŒºä¸­ï¼Œè€Œå®ä¾‹å˜é‡ä¼šéšç€å¯¹è±¡ä¸€èµ·åˆ†é…åˆ°Javaå †ä¸­</strong></p><h5 id="è§£æ" tabindex="-1"><a class="header-anchor" href="#è§£æ" aria-hidden="true">#</a> è§£æ</h5><p><strong>è¯¥é˜¶æ®µçš„ä¸»è¦èŒè´£ä¸ºå°†Classåœ¨å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨è½¬å˜ä¸ºç›´æ¥å¼•ç”¨</strong>ï¼Œ</p><p>æ­¤å¤„é’ˆå¯¹çš„æ˜¯<strong>é™æ€æ–¹æ³•åŠå±æ€§å’Œç§æœ‰æ–¹æ³•ä¸å±æ€§</strong>ï¼Œ<strong>å› ä¸ºè¿™ç±»æ–¹æ³•ä¸ç§æœ‰æ–¹æ³•ä¸èƒ½è¢«é‡å†™</strong>ï¼Œé™æ€å±æ€§åœ¨è¿è¡ŒæœŸä¹Ÿæ²¡æœ‰å¤šæ€è¿™ä¸€è¯´ï¼Œå³<strong>åœ¨ç¼–è¯‘å™¨å¯çŸ¥ï¼Œè¿è¡ŒæœŸä¸å¯å˜ï¼Œæ‰€ä»¥é€‚åˆåœ¨è¯¥é˜¶æ®µè§£æ</strong>ï¼Œè­¬å¦‚ç±»æ–¹æ³•mainæ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼Œä¸ºé™æ€è¿æ¥ï¼ŒåŒºåˆ«äºè¿è¡Œæ—¶çš„åŠ¨æ€è¿æ¥(åç»­æˆ‘ä¼šå†™å…³äºJVMå†…å­˜ç»“æ„çš„æ–‡ç« ï¼Œåœ¨è®²è§£æ ˆå¸§æ—¶ä¼šä»‹ç»åŠ¨æ€é“¾æ¥)ã€‚ <strong>ç¬¦å·å¼•ç”¨å³å­—ç¬¦ä¸²ï¼Œè¯´ç™½äº†å¯ä»¥æ˜¯ä¸€ä¸ªå­—æ®µåï¼Œæˆ–è€…ä¸€ä¸ªæ–¹æ³•å</strong>ï¼›<strong>ç›´æ¥å¼•ç”¨å³åç§»é‡</strong>ï¼Œ<strong>è¯´ç™½äº†å°±æ˜¯ç±»çš„å…ƒä¿¡æ¯ä½äºå†…å­˜çš„åœ°å€ä¸²</strong>ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªç±»çš„æ–¹æ³•ä¸ºtest()ï¼Œåˆ™ç¬¦å·å¼•ç”¨å³ä¸ºtestï¼Œè¿™ä¸ªæ–¹æ³•å­˜åœ¨äºå†…å­˜ä¸­çš„åœ°å€å‡è®¾ä¸º0x123456ï¼Œåˆ™è¿™ä¸ªåœ°å€åˆ™ä¸ºç›´æ¥å¼•ç”¨</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927090611262.png" alt="image-20220927090611262"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927090624171.png" alt="image-20220927090624171"></p><h4 id="åˆå§‹åŒ–" tabindex="-1"><a class="header-anchor" href="#åˆå§‹åŒ–" aria-hidden="true">#</a> åˆå§‹åŒ–</h4><p>ç±»çš„<strong>åˆå§‹åŒ–é¡ºåº</strong>ï¼šå…ˆæ‰§è¡Œçˆ¶ç±»é™æ€å˜é‡èµ‹å€¼ã€çˆ¶ç±»é™æ€åˆå§‹åŒ–å—ï¼Œå†æ‰§è¡Œå­ç±»é™æ€å±æ€§èµ‹å€¼ã€é™æ€åˆå§‹åŒ–å—</p><p><strong>æ‰§è¡Œç±»çš„æ„é€ å™¨æ–¹æ³•ï¼ˆclinitï¼ˆï¼‰ï¼‰çš„è¿‡ç¨‹ï¼ˆè´Ÿè´£ç»™staticå±æ€§æ˜¾ç¤ºèµ‹éé»˜è®¤å€¼ï¼‰</strong></p><p><strong>æ­¤æ–¹æ³•ä¸éœ€è¦å®šä¹‰ æ˜¯javacç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ ç±»å˜é‡ï¼ˆstaticï¼‰çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶è€Œæ¥</strong></p><p><strong>clinitï¼ˆï¼‰æ„é€ å™¨æ–¹æ³•ä¸­çš„æŒ‡ä»¤è¯­å¥æ˜¯æŒ‰ç…§æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåº</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920130631247.png" alt="image-20220920130631247"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920130824249.png" alt="image-20220920130824249"></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoadingTest1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//ç±»å˜é‡</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span><span class="token comment">//é™æ€ä»£ç å—</span>
        num <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        number <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//10</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>clinit()æ–¹æ³•æ˜¯javacç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ ç±»å˜é‡ï¼ˆstaticï¼‰çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶è€Œæ¥</strong></p><p><strong>å¦‚æœæ²¡æœ‰ç±»å˜é‡ï¼ˆstaticï¼‰çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—</strong> <strong>å°±ä¸ä¼šæœ‰clinit()æ–¹æ³•</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920131249704.png" alt="image-20220920131249704"></p><p><strong>ä»»ä½•ä¸€ä¸ªç±»ç”Ÿå£°æ˜åï¼Œå†…éƒ¨è‡³å°‘å­˜åœ¨ä¸€ä¸ªç±»çš„æ„é€ å™¨</strong></p><p>è‹¥è¯¥ç±»æœ‰çˆ¶ç±»ï¼š<strong>JVMä¿è¯å­ç±»çš„clinit()æ–¹æ³•æ‰§è¡Œå‰ çˆ¶ç±»çš„clinit()æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920132635850.png" alt="image-20220920132635850"></p><div class="language-Java line-numbers-mode" data-ext="Java"><pre class="language-Java"><code>//çˆ¶ç±»å…ˆåŠ è½½ å…¶æ¬¡åŠ è½½å­ç±» é™æ€å…ˆè¡Œ
public class ClassLoadingTest2 {
    static class Father{//çˆ¶ç±»å…ˆåŠ è½½
        static int num = 1;
        static {
            num = 2;
        }
    }
    static class Son extends Father{//å…¶æ¬¡åŠ è½½å­ç±»
        static int number = num;
    }

    public static void main(String[] args) {
        //çˆ¶ç±»å…ˆåŠ è½½ å…¶æ¬¡åŠ è½½å­ç±» é™æ€å…ˆè¡Œ
        System.out.println(Son.number);//2
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>JVMå¿…é¡»ä¿è¯ä¸€ä¸ªç±»çš„clinit()æ–¹æ³•åœ¨å¤šçº¿ç¨‹ä¸‹è¢«åŒæ­¥åŠ é”</strong></p><p><strong>ä¿è¯clinit()æ–¹æ³•åªåŠ è½½ä¸€æ¬¡</strong></p><p><strong>clinit()æ–¹æ³•</strong> <strong>clinit()æ–¹æ³•æ˜¯javacç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ ç±»å˜é‡ï¼ˆstaticï¼‰çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶è€Œæ¥</strong></p><p><strong>å¦‚æœæ²¡æœ‰ç±»å˜é‡ï¼ˆstaticï¼‰çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—</strong> <strong>å°±ä¸ä¼šæœ‰clinit()æ–¹æ³•</strong></p><h3 id="ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨" aria-hidden="true">#</a> ç±»åŠ è½½å™¨</h3><p><strong>å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰</strong></p><p><strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼ˆUser-Defined ClassLoaderï¼‰</strong></p><p><strong>æ‰€æœ‰æ´¾ç”ŸäºæŠ½è±¡ç±»ClassLoaderçš„ç±»åŠ è½½å™¨åˆ’åˆ†ä¸ºè‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong></p><p>äº†è§£è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼š</p><p>é€šè¿‡å‰é¢çš„åˆ†æå¯çŸ¥ï¼Œ<strong>å®ç°è‡ªå®šä¹‰ç±»åŠ è½½å™¨éœ€è¦ç»§æ‰¿ClassLoaderæˆ–è€…URLClassLoader</strong>ï¼Œ<strong>ç»§æ‰¿ClassLoaderåˆ™éœ€è¦è‡ªå·±é‡å†™findClass()æ–¹æ³•å¹¶ç¼–å†™åŠ è½½é€»è¾‘</strong>ï¼Œ<strong>ç»§æ‰¿URLClassLoaderåˆ™å¯ä»¥çœå»ç¼–å†™findClass()æ–¹æ³•ä»¥åŠclassæ–‡ä»¶åŠ è½½è½¬æ¢æˆå­—èŠ‚ç æµçš„ä»£ç </strong>ã€‚é‚£ä¹ˆ<strong>ç¼–å†™è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„æ„ä¹‰</strong>ä½•åœ¨å‘¢ï¼Ÿ</p><p>ç®€å•æ¥è®²:<strong>éš”ç¦»åŠ è½½ç±»</strong>ï¼Œ<strong>ä¿®æ”¹ç±»åŠ è½½æ–¹å¼</strong>ï¼Œ<strong>æ‰©å±•åŠ è½½æº</strong>ï¼Œ<strong>é˜²æ­¢æºç æ³„éœ²</strong></p><p>1.å½“classæ–‡ä»¶ä¸åœ¨ClassPathè·¯å¾„ä¸‹ï¼Œé»˜è®¤ç³»ç»Ÿç±»åŠ è½½å™¨æ— æ³•æ‰¾åˆ°è¯¥classæ–‡ä»¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„ClassLoaderæ¥åŠ è½½ç‰¹å®šè·¯å¾„ä¸‹çš„classæ–‡ä»¶ç”Ÿæˆclasså¯¹è±¡ã€‚</p><p>2.å½“ä¸€ä¸ªclassæ–‡ä»¶æ˜¯é€šè¿‡ç½‘ç»œä¼ è¾“å¹¶ä¸”å¯èƒ½ä¼šè¿›è¡Œç›¸åº”çš„åŠ å¯†æ“ä½œæ—¶ï¼Œéœ€è¦å…ˆå¯¹classæ–‡ä»¶è¿›è¡Œç›¸åº”çš„è§£å¯†åå†åŠ è½½åˆ°JVMå†…å­˜ä¸­ï¼Œè¿™ç§æƒ…å†µä¸‹ä¹Ÿéœ€è¦ç¼–å†™è‡ªå®šä¹‰çš„ClassLoaderå¹¶å®ç°ç›¸åº”çš„é€»è¾‘ã€‚</p><p>3.å½“éœ€è¦å®ç°çƒ­éƒ¨ç½²åŠŸèƒ½æ—¶(ä¸€ä¸ªclassæ–‡ä»¶é€šè¿‡ä¸åŒçš„ç±»åŠ è½½å™¨äº§ç”Ÿä¸åŒclasså¯¹è±¡ä»è€Œå®ç°çƒ­éƒ¨ç½²åŠŸèƒ½)ï¼Œéœ€è¦å®ç°è‡ªå®šä¹‰ClassLoaderçš„é€»è¾‘ã€‚</p><h4 id="å¼•å¯¼ç±»åŠ è½½å™¨-bootstrap-classloader" tabindex="-1"><a class="header-anchor" href="#å¼•å¯¼ç±»åŠ è½½å™¨-bootstrap-classloader" aria-hidden="true">#</a> å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰</h4><p>å¯åŠ¨ç±»åŠ è½½å™¨<strong>ä¸»è¦åŠ è½½çš„æ˜¯JVMè‡ªèº«éœ€è¦çš„ç±»</strong>ï¼Œè¿™ä¸ªç±»åŠ è½½<strong>ä½¿ç”¨C++è¯­è¨€å®ç°</strong>çš„ï¼Œæ˜¯<strong>è™šæ‹Ÿæœºè‡ªèº«çš„ä¸€éƒ¨åˆ†</strong>ï¼Œå®ƒ<strong>è´Ÿè´£å°† &lt;JAVA_HOME&gt;/libè·¯å¾„ä¸‹çš„æ ¸å¿ƒç±»åº“æˆ–-Xbootclasspathå‚æ•°æŒ‡å®šçš„è·¯å¾„ä¸‹çš„jaråŒ…åŠ è½½åˆ°å†…å­˜ä¸­</strong>ï¼Œæ³¨æ„ç”±äº<strong>è™šæ‹Ÿæœºæ˜¯æŒ‰ç…§æ–‡ä»¶åè¯†åˆ«åŠ è½½jaråŒ…çš„ï¼Œå¦‚rt.jarï¼Œå¦‚æœæ–‡ä»¶åä¸è¢«è™šæ‹Ÿæœºè¯†åˆ«ï¼Œå³ä½¿æŠŠjaråŒ…ä¸¢åˆ°libç›®å½•ä¸‹ä¹Ÿæ˜¯æ²¡æœ‰ä½œç”¨çš„</strong>(å‡ºäº<strong>å®‰å…¨è€ƒè™‘ï¼ŒBootstrapå¯åŠ¨ç±»åŠ è½½å™¨åªåŠ è½½åŒ…åä¸ºjavaã€javaxã€sunç­‰å¼€å¤´çš„ç±»</strong>)ã€‚</p><h4 id="æ‰©å±•ç±»åŠ è½½å™¨-extension-classloader" tabindex="-1"><a class="header-anchor" href="#æ‰©å±•ç±»åŠ è½½å™¨-extension-classloader" aria-hidden="true">#</a> æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰</h4><p>æ‰©å±•ç±»åŠ è½½å™¨æ˜¯æŒ‡Sunå…¬å¸(å·²è¢«Oracleæ”¶è´­)å®ç°çš„sun.misc.Launcher$ExtClassLoaderç±»ï¼Œç”±<strong>Javaè¯­è¨€å®ç°</strong>çš„ï¼Œæ˜¯<strong>Launcherçš„é™æ€å†…éƒ¨ç±»</strong>ï¼Œå®ƒ<strong>è´Ÿè´£åŠ è½½&lt;JAVA_HOME&gt;/lib/extç›®å½•ä¸‹æˆ–è€…ç”±ç³»ç»Ÿå˜é‡-Djava.ext.diræŒ‡å®šä½è·¯å¾„ä¸­çš„ç±»åº“</strong>ï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨æ ‡å‡†æ‰©å±•ç±»åŠ è½½å™¨ã€‚</p><h4 id="ç³»ç»Ÿç±»åŠ è½½å™¨-system-classloader" tabindex="-1"><a class="header-anchor" href="#ç³»ç»Ÿç±»åŠ è½½å™¨-system-classloader" aria-hidden="true">#</a> ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆSystem ClassLoaderï¼‰</h4><p>ä¹Ÿç§°åº”ç”¨ç¨‹åºåŠ è½½å™¨æ˜¯æŒ‡ Sunå…¬å¸å®ç°çš„sun.misc.Launcher$AppClassLoaderã€‚å®ƒ<strong>è´Ÿè´£åŠ è½½ç³»ç»Ÿç±»è·¯å¾„java -classpathæˆ–-D java.class.path æŒ‡å®šè·¯å¾„ä¸‹çš„ç±»åº“</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„<strong>classpathè·¯å¾„</strong>ï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨ç³»ç»Ÿç±»åŠ è½½å™¨ï¼Œ<strong>ä¸€èˆ¬æƒ…å†µä¸‹è¯¥ç±»åŠ è½½å™¨æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ï¼Œé€šè¿‡ClassLoader#getSystemClassLoader()æ–¹æ³•å¯ä»¥è·å–åˆ°è¯¥ç±»åŠ è½½å™¨</strong>ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoadingTest3</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//ç³»ç»Ÿç±»åŠ è½½å™¨è·å–</span>
        <span class="token class-name">ClassLoader</span> systemClassLoader <span class="token operator">=</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>systemClassLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//jdk.internal.loader.ClassLoaders$AppClassLoader@27c170f0</span>

        <span class="token comment">//ç³»ç»Ÿç±»åŠ è½½å™¨è·å–å…¶ä¸Šå±‚ æ‰©å±•ç±»åŠ è½½å™¨</span>
        <span class="token class-name">ClassLoader</span> systemClassLoaderParent <span class="token operator">=</span> systemClassLoader<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>systemClassLoaderParent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//jdk.internal.loader.ClassLoaders$PlatformClassLoader@4f3f5b24</span>

        <span class="token comment">//æ‰©å±•ç±»åŠ è½½å™¨è·å–å…¶ä¸Šå±‚ å¼•å¯¼ç±»åŠ è½½å™¨ --è·å–ä¸åˆ°</span>
        <span class="token class-name">ClassLoader</span> systemClassLoaderParentParent <span class="token operator">=</span> systemClassLoaderParent<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>systemClassLoaderParentParent<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//null</span>

        <span class="token comment">//å¯¹äºè‡ªå®šä¹‰ç±»åŠ è½½å™¨ é»˜è®¤ä½¿ç”¨ç³»ç»Ÿç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ClassLoadingTest3</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//jdk.internal.loader.ClassLoaders$AppClassLoader@27c170f0åŒç³»ç»Ÿç±»åŠ è½½å™¨</span>

        <span class="token comment">//Stringç±»çš„ç±»åŠ è½½å™¨æŸ¥çœ‹ å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½ ç³»ç»Ÿçš„æ ¸å¿ƒç±»åº“éƒ½æ˜¯ä½¿ç”¨å¼•å¯¼ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½çš„</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//null</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920134602495.png" alt="image-20220920134602495"></p><p><strong>è·å–ClassLoaderçš„æ–¹å¼</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920144548977.png" alt="image-20220920144548977"></p><h4 id="ç±»åŠ è½½å™¨é—´çš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨é—´çš„å…³ç³»" aria-hidden="true">#</a> ç±»åŠ è½½å™¨é—´çš„å…³ç³»</h4><p>æˆ‘ä»¬è¿›ä¸€æ­¥äº†è§£ç±»åŠ è½½å™¨é—´çš„å…³ç³»(å¹¶éæŒ‡ç»§æ‰¿å…³ç³»)ï¼Œä¸»è¦å¯ä»¥åˆ†ä¸ºä»¥ä¸‹4ç‚¹</p><p><strong>å¯åŠ¨ç±»åŠ è½½å™¨</strong>ï¼Œç”±C++å®ç°ï¼ŒåµŒå¥—åœ¨JVMå†…éƒ¨ åŠ è½½Javaæ ¸å¿ƒç±»åº“ æ²¡æœ‰çˆ¶ç±»ã€‚</p><p><strong>æ‹“å±•ç±»åŠ è½½å™¨(ExtClassLoader)</strong>ï¼Œæ´¾ç”ŸäºClassLoader ç”±Javaè¯­è¨€å®ç°ï¼Œçˆ¶ç±»åŠ è½½å™¨ä¸ºå¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆnull è·å–ä¸åˆ°ï¼‰</p><p>(Javaç¨‹åºé»˜è®¤åŠ è½½å™¨ï¼‰<strong>ç³»ç»Ÿç±»åŠ è½½å™¨(AppClassLoader)</strong>ï¼Œæ´¾ç”ŸäºClassLoader ç”±Javaè¯­è¨€å®ç°ï¼Œçˆ¶ç±»åŠ è½½å™¨ä¸ºæ‰©å±•ç±»åŠ è½½å™¨ExtClassLoader</p><p><strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>ï¼Œçˆ¶ç±»åŠ è½½å™¨è‚¯å®šä¸ºAppClassLoaderã€‚</p><h4 id="åŒäº²å§”æ´¾æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#åŒäº²å§”æ´¾æ¨¡å¼" aria-hidden="true">#</a> åŒäº²å§”æ´¾æ¨¡å¼</h4><p>åœ¨Javaçš„<strong>æ—¥å¸¸åº”ç”¨ç¨‹åºå¼€å‘ä¸­</strong>ï¼Œ<strong>ç±»çš„åŠ è½½å‡ ä¹æ˜¯ç”±å¼•å¯¼ï¼ˆBootstrapï¼‰ç±»åŠ è½½å™¨ã€æ‰©å±•ï¼ˆExtensionï¼‰ç±»åŠ è½½å™¨ã€ç³»ç»Ÿï¼ˆSystemï¼‰ç±»åŠ è½½å™¨ï¼ˆä¹Ÿç§°åº”ç”¨ç±»åŠ è½½å™¨ï¼‰3ç§ç±»åŠ è½½å™¨ç›¸äº’é…åˆæ‰§è¡Œçš„</strong>ï¼Œåœ¨å¿…è¦æ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJavaè™šæ‹Ÿæœºå¯¹classæ–‡ä»¶é‡‡ç”¨çš„æ˜¯æŒ‰éœ€åŠ è½½çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å½“éœ€è¦ä½¿ç”¨è¯¥ç±»æ—¶æ‰ä¼šå°†å®ƒçš„classæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ç”Ÿæˆclasså¯¹è±¡ï¼Œè€Œä¸”åŠ è½½æŸä¸ªç±»çš„classæ–‡ä»¶æ—¶ï¼Œ<strong>Javaè™šæ‹Ÿæœºé‡‡ç”¨çš„æ˜¯åŒäº²å§”æ´¾æ¨¡å¼å³æŠŠè¯·æ±‚äº¤ç”±çˆ¶ç±»å¤„ç†</strong>ï¼Œå®ƒ<strong>ä¸€ç§ä»»åŠ¡å§”æ´¾æ¨¡å¼--åŒäº²å§”æ´¾æ¨¡å¼</strong></p><p><strong>éç»§æ‰¿å…³ç³»</strong></p><p>åŒäº²å§”æ´¾æ¨¡å¼è¦æ±‚<strong>é™¤äº†é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨å¤–</strong>ï¼Œ<strong>å…¶ä½™çš„ç±»åŠ è½½å™¨éƒ½åº”å½“æœ‰è‡ªå·±çš„çˆ¶ç±»åŠ è½½å™¨</strong>ï¼Œè¯·æ³¨æ„åŒäº²å§”æ´¾æ¨¡å¼ä¸­çš„çˆ¶å­å…³ç³»<strong>å¹¶éé€šå¸¸æ‰€è¯´çš„ç±»ç»§æ‰¿å…³ç³»</strong>ï¼Œè€Œæ˜¯<strong>é‡‡ç”¨ç»„åˆå…³ç³»æ¥å¤ç”¨çˆ¶ç±»åŠ è½½å™¨çš„ç›¸å…³ä»£ç </strong>ï¼Œç±»åŠ è½½å™¨é—´çš„å…³ç³»å¦‚ä¸‹ï¼š</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920134602495.png" alt="image-20220920134602495"></p><p><strong>åŒäº²å§”æ´¾æ¨¡å¼æ˜¯åœ¨Java 1.2åå¼•å…¥çš„</strong>ï¼Œ<strong>å…¶å·¥ä½œåŸç†çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒå¹¶ä¸ä¼šè‡ªå·±å…ˆå»åŠ è½½ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨å»æ‰§è¡Œï¼Œå¦‚æœçˆ¶ç±»åŠ è½½å™¨è¿˜å­˜åœ¨å…¶çˆ¶ç±»åŠ è½½å™¨ï¼Œåˆ™è¿›ä¸€æ­¥å‘ä¸Šå§”æ‰˜ï¼Œä¾æ¬¡é€’å½’ï¼Œè¯·æ±‚æœ€ç»ˆå°†åˆ°è¾¾é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œå¦‚æœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥å®Œæˆç±»åŠ è½½ä»»åŠ¡ï¼Œå°±æˆåŠŸè¿”å›ï¼Œå€˜è‹¥çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆæ­¤åŠ è½½ä»»åŠ¡ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ï¼Œè¿™å°±æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ï¼Œå³æ¯ä¸ªå„¿å­éƒ½å¾ˆæ‡’ï¼Œæ¯æ¬¡æœ‰æ´»å°±ä¸¢ç»™çˆ¶äº²å»å¹²ï¼Œç›´åˆ°çˆ¶äº²è¯´è¿™ä»¶äº‹æˆ‘ä¹Ÿå¹²ä¸äº†æ—¶ï¼Œå„¿å­è‡ªå·±æƒ³åŠæ³•å»å®Œæˆ.</strong></p><h5 id="åŒäº²å§”æ´¾æ¨¡å¼ä¼˜åŠ¿" tabindex="-1"><a class="header-anchor" href="#åŒäº²å§”æ´¾æ¨¡å¼ä¼˜åŠ¿" aria-hidden="true">#</a> åŒäº²å§”æ´¾æ¨¡å¼ä¼˜åŠ¿</h5><h6 id="é¿å…é‡å¤åŠ è½½" tabindex="-1"><a class="header-anchor" href="#é¿å…é‡å¤åŠ è½½" aria-hidden="true">#</a> é¿å…é‡å¤åŠ è½½</h6><p><strong>é‡‡ç”¨åŒäº²å§”æ´¾æ¨¡å¼çš„æ˜¯å¥½å¤„æ˜¯Javaç±»éšç€å®ƒçš„ç±»åŠ è½½å™¨ä¸€èµ·å…·å¤‡äº†ä¸€ç§å¸¦æœ‰ä¼˜å…ˆçº§çš„å±‚æ¬¡å…³ç³»ï¼Œé€šè¿‡è¿™ç§å±‚çº§å…³å¯ä»¥é¿å…ç±»çš„é‡å¤åŠ è½½ï¼Œå½“çˆ¶äº²å·²ç»åŠ è½½äº†è¯¥ç±»æ—¶ï¼Œå°±æ²¡æœ‰å¿…è¦å­ClassLoaderå†åŠ è½½ä¸€æ¬¡ã€‚</strong></p><h6 id="å®‰å…¨å› ç´ -æ²™ç®±å®‰å…¨æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#å®‰å…¨å› ç´ -æ²™ç®±å®‰å…¨æœºåˆ¶" aria-hidden="true">#</a> å®‰å…¨å› ç´ -æ²™ç®±å®‰å…¨æœºåˆ¶</h6><p><strong>é˜²æ­¢æ ¸å¿ƒAPIè¢«éšæ„ç¯¡æ”¹</strong>ï¼ˆå¯¹æ ¸å¿ƒæºç çš„ä¿æŠ¤ï¼‰</p><p><strong>å…¶æ¬¡æ˜¯è€ƒè™‘åˆ°å®‰å…¨å› ç´ ï¼Œjavaæ ¸å¿ƒapiä¸­å®šä¹‰ç±»å‹ä¸ä¼šè¢«éšæ„æ›¿æ¢ï¼Œå‡è®¾é€šè¿‡ç½‘ç»œä¼ é€’ä¸€ä¸ªåä¸ºjava.lang.Integerçš„ç±»ï¼Œé€šè¿‡åŒäº²å§”æ‰˜æ¨¡å¼ä¼ é€’åˆ°å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œè€Œå¯åŠ¨ç±»åŠ è½½å™¨åœ¨æ ¸å¿ƒJava APIå‘ç°è¿™ä¸ªåå­—çš„ç±»ï¼Œå‘ç°è¯¥ç±»å·²è¢«åŠ è½½ï¼Œå¹¶ä¸ä¼šé‡æ–°åŠ è½½ç½‘ç»œä¼ é€’çš„è¿‡æ¥çš„java.lang.Integerï¼Œè€Œç›´æ¥è¿”å›å·²åŠ è½½è¿‡çš„Integer.classï¼Œè¿™æ ·ä¾¿å¯ä»¥é˜²æ­¢æ ¸å¿ƒAPIåº“è¢«éšæ„ç¯¡æ”¹ã€‚</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920154750258.png" alt="image-20220920154750258"></p><p><strong>å¯èƒ½ä½ ä¼šæƒ³ï¼Œå¦‚æœæˆ‘ä»¬åœ¨classpathè·¯å¾„ä¸‹è‡ªå®šä¹‰ä¸€ä¸ªåä¸ºjava.lang.SingleIntergeç±»(è¯¥ç±»æ˜¯èƒ¡ç¼–çš„)å‘¢ï¼Ÿè¯¥ç±»å¹¶ä¸å­˜åœ¨java.langä¸­ï¼Œç»è¿‡åŒäº²å§”æ‰˜æ¨¡å¼ï¼Œä¼ é€’åˆ°å¯åŠ¨ç±»åŠ è½½å™¨ä¸­ï¼Œç”±äºçˆ¶ç±»åŠ è½½å™¨è·¯å¾„ä¸‹å¹¶æ²¡æœ‰è¯¥ç±»ï¼Œæ‰€ä»¥ä¸ä¼šåŠ è½½ï¼Œå°†åå‘å§”æ‰˜ç»™å­ç±»åŠ è½½å™¨åŠ è½½ï¼Œæœ€ç»ˆä¼šé€šè¿‡ç³»ç»Ÿç±»åŠ è½½å™¨åŠ è½½è¯¥ç±»ã€‚ä½†æ˜¯è¿™æ ·åšæ˜¯ä¸å…è®¸ï¼Œå› ä¸ºjava.langæ˜¯æ ¸å¿ƒAPIåŒ…ï¼Œéœ€è¦è®¿é—®æƒé™ï¼Œå¼ºåˆ¶åŠ è½½å°†ä¼šæŠ¥å‡ºå¦‚ä¸‹å¼‚å¸¸</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920152230945.png" alt="image-20220920152230945"></p><p>java.lang.SecurityException: Prohibited package name: java.lang</p><p><strong>æ‰€ä»¥æ— è®ºå¦‚ä½•éƒ½æ— æ³•åŠ è½½æˆåŠŸçš„</strong></p><h5 id="ä»ä»£ç å±‚é¢äº†è§£å‡ ä¸ªjavaä¸­å®šä¹‰çš„ç±»åŠ è½½å™¨åŠå…¶åŒäº²å§”æ´¾æ¨¡å¼çš„å®ç°" tabindex="-1"><a class="header-anchor" href="#ä»ä»£ç å±‚é¢äº†è§£å‡ ä¸ªjavaä¸­å®šä¹‰çš„ç±»åŠ è½½å™¨åŠå…¶åŒäº²å§”æ´¾æ¨¡å¼çš„å®ç°" aria-hidden="true">#</a> ä»ä»£ç å±‚é¢äº†è§£å‡ ä¸ªJavaä¸­å®šä¹‰çš„ç±»åŠ è½½å™¨åŠå…¶åŒäº²å§”æ´¾æ¨¡å¼çš„å®ç°</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920151406561.png" alt="image-20220920151406561"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920140502286.png" alt="image-20220920140502286"></p><p><strong>ä»å›¾å¯ä»¥çœ‹å‡ºé¡¶å±‚çš„ç±»åŠ è½½å™¨æ˜¯ClassLoaderç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…¶åæ‰€æœ‰çš„ç±»åŠ è½½å™¨éƒ½ç»§æ‰¿è‡ªClassLoaderï¼ˆä¸åŒ…æ‹¬å¯åŠ¨ç±»åŠ è½½å™¨ï¼‰</strong></p><h5 id="çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨" aria-hidden="true">#</a> çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</h5><p>åœ¨Javaåº”ç”¨ä¸­å­˜åœ¨ç€å¾ˆå¤šæœåŠ¡æä¾›è€…æ¥å£ï¼ˆService Provider Interfaceï¼ŒSPIï¼‰ï¼Œè¿™äº›æ¥å£å…è®¸ç¬¬ä¸‰æ–¹ä¸ºå®ƒä»¬æä¾›å®ç°ï¼Œå¦‚å¸¸è§çš„ SPI æœ‰ JDBCã€JNDIç­‰ï¼Œè¿™äº› SPI çš„æ¥å£å±äº Java æ ¸å¿ƒåº“ï¼Œä¸€èˆ¬å­˜åœ¨rt.jaråŒ…ä¸­ï¼Œç”±Bootstrapç±»åŠ è½½å™¨åŠ è½½ï¼Œè€Œ SPI çš„ç¬¬ä¸‰æ–¹å®ç°ä»£ç åˆ™æ˜¯ä½œä¸ºJavaåº”ç”¨æ‰€ä¾èµ–çš„ jar åŒ…è¢«å­˜æ”¾åœ¨classpathè·¯å¾„ä¸‹ï¼Œç”±äºSPIæ¥å£ä¸­çš„ä»£ç ç»å¸¸éœ€è¦åŠ è½½å…·ä½“çš„ç¬¬ä¸‰æ–¹å®ç°ç±»å¹¶è°ƒç”¨å…¶ç›¸å…³æ–¹æ³•ï¼Œä½†SPIçš„æ ¸å¿ƒæ¥å£ç±»æ˜¯ç”±å¼•å¯¼ç±»åŠ è½½å™¨æ¥åŠ è½½çš„ï¼Œè€ŒBootstrapç±»åŠ è½½å™¨æ— æ³•ç›´æ¥åŠ è½½SPIçš„å®ç°ç±»ï¼ŒåŒæ—¶ç”±äºåŒäº²å§”æ´¾æ¨¡å¼çš„å­˜åœ¨ï¼ŒBootstrapç±»åŠ è½½å™¨ä¹Ÿæ— æ³•åå‘å§”æ‰˜AppClassLoaderåŠ è½½å™¨SPIçš„å®ç°ç±»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ç§ç‰¹æ®Šçš„ç±»åŠ è½½å™¨æ¥åŠ è½½ç¬¬ä¸‰æ–¹çš„ç±»åº“ï¼Œè€Œçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å°±æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚ çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆcontextClassLoaderï¼‰æ˜¯ä» JDK 1.2 å¼€å§‹å¼•å…¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡java.lang.Threadç±»ä¸­çš„getContextClassLoader()å’Œ setContextClassLoader(ClassLoader cl)æ–¹æ³•æ¥è·å–å’Œè®¾ç½®çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ã€‚å¦‚æœæ²¡æœ‰æ‰‹åŠ¨è®¾ç½®ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Œçº¿ç¨‹å°†ç»§æ‰¿å…¶çˆ¶çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Œåˆå§‹çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ˜¯ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰,åœ¨çº¿ç¨‹ä¸­è¿è¡Œçš„ä»£ç å¯ä»¥é€šè¿‡æ­¤ç±»åŠ è½½å™¨æ¥åŠ è½½ç±»å’Œèµ„æºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»¥jdbc.jaråŠ è½½ä¸ºä¾‹</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920152641999.png" alt="image-20220920152641999"></p><p>ä»å›¾å¯çŸ¥<strong>rt.jaræ ¸å¿ƒåŒ…æ˜¯æœ‰Bootstrapç±»åŠ è½½å™¨åŠ è½½çš„</strong>ï¼Œ<strong>å…¶å†…åŒ…å«SPIæ ¸å¿ƒæ¥å£ç±»ï¼Œç”±äºSPIä¸­çš„ç±»ç»å¸¸éœ€è¦è°ƒç”¨å¤–éƒ¨å®ç°ç±»çš„æ–¹æ³•ï¼Œè€Œjdbc.jaråŒ…å«å¤–éƒ¨å®ç°ç±»(jdbc.jarå­˜åœ¨äºclasspathè·¯å¾„)æ— æ³•é€šè¿‡Bootstrapç±»åŠ è½½å™¨åŠ è½½</strong>ï¼Œå› æ­¤åªèƒ½<strong>å§”æ´¾çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æŠŠjdbc.jarä¸­çš„å®ç°ç±»åŠ è½½åˆ°å†…å­˜ä»¥ä¾¿SPIç›¸å…³ç±»ä½¿ç”¨</strong>ã€‚æ˜¾ç„¶è¿™ç§çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨çš„åŠ è½½æ–¹å¼ç ´åäº†â€œåŒäº²å§”æ´¾æ¨¡å‹â€ï¼Œ<strong>å®ƒåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å¼ƒåŒäº²å§”æ´¾åŠ è½½é“¾æ¨¡å¼ï¼Œä½¿ç¨‹åºå¯ä»¥é€†å‘ä½¿ç”¨ç±»åŠ è½½å™¨ï¼Œå½“ç„¶è¿™ä¹Ÿä½¿å¾—Javaç±»åŠ è½½å™¨å˜å¾—æ›´åŠ çµæ´»</strong>ã€‚ä¸ºäº†è¿›ä¸€æ­¥è¯å®è¿™ç§åœºæ™¯ï¼Œä¸å¦¨çœ‹çœ‹DriverManagerç±»çš„æºç ï¼ŒDriverManageræ˜¯Javaæ ¸å¿ƒrt.jaråŒ…ä¸­çš„ç±»ï¼Œè¯¥ç±»ç”¨æ¥ç®¡ç†ä¸åŒæ•°æ®åº“çš„å®ç°é©±åŠ¨å³Driverï¼Œå®ƒä»¬éƒ½å®ç°äº†Javaæ ¸å¿ƒåŒ…ä¸­çš„java.sql.Driveræ¥å£ï¼Œå¦‚mysqlé©±åŠ¨åŒ…ä¸­çš„com.mysql.jdbc.Driverï¼Œè¿™é‡Œä¸»è¦çœ‹çœ‹å¦‚ä½•åŠ è½½å¤–éƒ¨å®ç°ç±»ï¼Œåœ¨DriverManageråˆå§‹åŒ–æ—¶ä¼šæ‰§è¡Œå¦‚ä¸‹ä»£ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//DriverManageræ˜¯Javaæ ¸å¿ƒåŒ…rt.jarçš„ç±»</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DriverManager</span> <span class="token punctuation">{</span>
	<span class="token comment">//çœç•¥ä¸å¿…è¦çš„ä»£ç </span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token function">loadInitialDrivers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰§è¡Œè¯¥æ–¹æ³•</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;JDBC DriverManager initialized&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">//loadInitialDriversæ–¹æ³•</span>
 <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">loadInitialDrivers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Providers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> <span class="token class-name">Void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">//åŠ è½½å¤–éƒ¨çš„Driverçš„å®ç°ç±»</span>
                <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Driver</span><span class="token punctuation">&gt;</span></span> loadedDrivers <span class="token operator">=</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Driver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment">//çœç•¥ä¸å¿…è¦çš„ä»£ç ......</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨DriverManagerç±»åˆå§‹åŒ–æ—¶æ‰§è¡Œäº†loadInitialDrivers()æ–¹æ³•,åœ¨è¯¥æ–¹æ³•ä¸­é€šè¿‡ServiceLoader.load(Driver.class);å»åŠ è½½å¤–éƒ¨å®ç°çš„é©±åŠ¨ç±»ï¼ŒServiceLoaderç±»ä¼šå»è¯»å–mysqlçš„jdbc.jarä¸‹META-INFæ–‡ä»¶çš„å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤º <img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220920153320008.png" alt="image-20220920153320008"></p><p>å¾ˆæ˜æ˜¾äº†ç¡®å®é€šè¿‡çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨åŠ è½½çš„ï¼Œå®é™…ä¸Š<strong>æ ¸å¿ƒåŒ…çš„SPIç±»å¯¹å¤–éƒ¨å®ç°ç±»çš„åŠ è½½éƒ½æ˜¯åŸºäºçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ‰§è¡Œçš„</strong>ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å®ç°äº†<strong>Javaæ ¸å¿ƒä»£ç å†…éƒ¨å»è°ƒç”¨å¤–éƒ¨å®ç°ç±»</strong>ã€‚æˆ‘ä»¬çŸ¥é“<strong>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨é»˜è®¤æƒ…å†µä¸‹å°±æ˜¯AppClassLoader</strong>ï¼Œ</p><p>é‚£<strong>ä¸ºä»€ä¹ˆä¸ç›´æ¥é€šè¿‡getSystemClassLoader()è·å–ç±»åŠ è½½å™¨æ¥åŠ è½½classpathè·¯å¾„ä¸‹çš„ç±»</strong>çš„å‘¢ï¼Ÿå…¶å®æ˜¯å¯è¡Œçš„ï¼Œä½†è¿™ç§ç›´æ¥ä½¿ç”¨getSystemClassLoader()æ–¹æ³•è·å–AppClassLoaderåŠ è½½ç±»æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œé‚£å°±æ˜¯ä»£ç <strong>éƒ¨ç½²åˆ°ä¸åŒæœåŠ¡æ—¶ä¼šå‡ºç°é—®é¢˜</strong>ï¼Œå¦‚æŠŠä»£ç éƒ¨ç½²åˆ°Java Webåº”ç”¨æœåŠ¡æˆ–è€…EJBä¹‹ç±»çš„æœåŠ¡å°†ä¼šå‡ºé—®é¢˜ï¼Œå› ä¸º<strong>è¿™äº›æœåŠ¡ä½¿ç”¨çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å¹¶éAppClassLoaderï¼Œè€Œæ˜¯Java Webåº”ç”¨æœè‡ªå®¶çš„ç±»åŠ è½½å™¨ï¼Œç±»åŠ è½½å™¨ä¸åŒ</strong>ã€‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”ç”¨è¯¥å°‘ç”¨getSystemClassLoader()ã€‚æ€»ä¹‹ä¸åŒçš„æœåŠ¡ä½¿ç”¨çš„å¯èƒ½é»˜è®¤ClassLoaderæ˜¯ä¸åŒçš„ï¼Œä½†<strong>ä½¿ç”¨çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ€»èƒ½è·å–åˆ°ä¸å½“å‰ç¨‹åºæ‰§è¡Œç›¸åŒçš„ClassLoaderï¼Œä»è€Œé¿å…ä¸å¿…è¦çš„é—®é¢˜</strong></p><h4 id="classloaderå¸è½½class" tabindex="-1"><a class="header-anchor" href="#classloaderå¸è½½class" aria-hidden="true">#</a> <strong>ClassLoaderå¸è½½Class</strong></h4><p>JVMä¸­çš„Classåªæœ‰æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼Œæ‰èƒ½è¢«GCå›æ”¶ï¼Œä¹Ÿå°±æ˜¯è¯¥Classè¢«å¸è½½ï¼ˆunloadï¼‰ï¼š</p><ul><li>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«GCã€‚</li><li>åŠ è½½è¯¥ç±»çš„ClassLoaderå®ä¾‹å·²ç»è¢«GCã€‚</li><li>è¯¥ç±»çš„java.lang.Classå¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ã€‚</li></ul><p><strong>GCçš„æ—¶æœºæˆ‘ä»¬æ˜¯ä¸å¯æ§çš„ï¼Œé‚£ä¹ˆåŒæ ·çš„æˆ‘ä»¬å¯¹äºClassçš„å¸è½½ä¹Ÿæ˜¯ä¸å¯æ§çš„</strong></p><h3 id="jvmä¸­åˆ¤æ–­classå¯¹è±¡ç›¸åŒçš„æ ‡å‡†" tabindex="-1"><a class="header-anchor" href="#jvmä¸­åˆ¤æ–­classå¯¹è±¡ç›¸åŒçš„æ ‡å‡†" aria-hidden="true">#</a> JVMä¸­åˆ¤æ–­classå¯¹è±¡ç›¸åŒçš„æ ‡å‡†</h3><p><strong>1.ç±»çš„å®Œæ•´ç±»åå¿…é¡»ä¸€è‡´ åŒ…æ‹¬åŒ…å</strong></p><p><strong>2.åŠ è½½è¿™ä¸ªç±»çš„ClassLoaderï¼ˆæŒ‡ç±»åŠ è½½å™¨çš„å®ä¾‹å¯¹è±¡ï¼‰å¿…é¡»ç›¸åŒ</strong></p><p>æ¢è¨€ä¹‹ åœ¨JVMä¸­ å³ä½¿ä¸¤ä¸ªç±»å¯¹è±¡ï¼ˆclasså¯¹è±¡ï¼‰æ¥æºäºåŒä¸€ä¸ªclassæ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹Ÿæœºæ‰€åŠ è½½ï¼Œä½†åªè¦åŠ è½½ä»–ä»¬çš„ClassLoaderå®ä¾‹å¯¹è±¡ä¸åŒï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç±»å¯¹è±¡ä¹Ÿæ˜¯ä¸åŒã€‚</p><h3 id="ç±»åŠ è½½å™¨çš„å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#ç±»åŠ è½½å™¨çš„å¼•ç”¨" aria-hidden="true">#</a> ç±»åŠ è½½å™¨çš„å¼•ç”¨</h3><p>JVMå¿…é¡»çŸ¥é“ä¸€ä¸ªç±»çš„ç±»å‹æ˜¯ç”±å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½è¿˜æ˜¯ç”±ç”¨æˆ·ç±»åŠ è½½å™¨åŠ è½½ã€‚</p><p><strong>è‹¥ç”±ç”¨æˆ·ç±»åŠ è½½å™¨åŠ è½½</strong>ï¼š<strong>JVMä¼šå°†è¿™ä¸ªç±»åŠ è½½å™¨çš„ä¸€ä¸ªå¼•ç”¨ä½œä¸ºç±»ä¿¡æ¯çš„ä¸€éƒ¨åˆ†ä¿å­˜åœ¨æ–¹æ³•åŒºï¼ˆjdk8å…ƒç©ºé—´ï¼‰ä¸­</strong>ï¼›å½“è§£æä¸€ä¸ªç±»å‹åˆ°å¦ä¸€ä¸ªç±»å‹çš„å¼•ç”¨çš„æ—¶å€™ï¼ŒJVMéœ€è¦ä¿è¯ä¸¤ä¸ªç±»å‹çš„ç±»åŠ è½½å™¨æ˜¯ç›¸åŒçš„ã€‚</p><h3 id="javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼" aria-hidden="true">#</a> Javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼</h3><p>ä¼šä¸ä¼š<strong>å¯¼è‡´ç±»çš„åˆå§‹åŒ–</strong> å†³å®šæ˜¯ä¸»åŠ¨ä½¿ç”¨è¿˜æ˜¯è¢«åŠ¨ä½¿ç”¨</p><h4 id="ä¸»åŠ¨ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ä¸»åŠ¨ä½¿ç”¨" aria-hidden="true">#</a> ä¸»åŠ¨ä½¿ç”¨</h4><p>1.åˆ›å»ºç±»çš„å®ä¾‹</p><p>2.è®¿é—®æŸä¸ªç±»æˆ–æ¥å£çš„é™æ€å˜é‡ï¼Œæˆ–è€…å¯¹è¯¥é™æ€å˜é‡èµ‹å€¼</p><p>3.è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•</p><p>4.åå°„ï¼ˆClass.forName(â€œå…¨ç±»åâ€)ï¼‰</p><p>5.åˆå§‹åŒ–ä¸€ä¸ªç±»çš„å­ç±»</p><p>6.Javaè™šæ‹Ÿæœºå¯åŠ¨æ—¶è¢«è¡¨æ˜ä¸ºå¯åŠ¨ç±»çš„ç±»</p><p>7.JDK7å¼€å§‹æä¾›çš„åŠ¨æ€è¯­è¨€æ”¯æŒï¼š</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922102407895.png" alt="image-20220922102407895"></p><h4 id="è¢«åŠ¨ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#è¢«åŠ¨ä½¿ç”¨" aria-hidden="true">#</a> è¢«åŠ¨ä½¿ç”¨</h4><p>é™¤äº†ä¸»åŠ¨ä½¿ç”¨çš„7ç§æƒ…å†µ å…¶ä»–ä½¿ç”¨Javaç±»çš„æ–¹å¼éƒ½è¢«çœ‹ä½œæ˜¯å¯¹ç±»çš„<strong>è¢«åŠ¨ä½¿ç”¨</strong>ï¼Œ<strong>éƒ½ä¸ä¼šå¯¼è‡´ç±»çš„åˆå§‹åŒ–</strong>ã€‚</p><h2 id="jvm-runtime-memory-area" tabindex="-1"><a class="header-anchor" href="#jvm-runtime-memory-area" aria-hidden="true">#</a> JVM Runtime Memory Area</h2><p>https://www.digitalocean.com/community/tutorials/java-jvm-memory-model-memory-management-in-java</p><p><strong>å†…å­˜</strong> æ˜¯<strong>ç¡¬ç›˜</strong>å’Œ<strong>CPU</strong>çš„<strong>ä¸­é—´ä»“åº“åŠæ¡¥æ¢</strong> <strong>æ‰¿è½½ç€æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„å®æ—¶è¿è¡Œ</strong>ã€‚</p><p><strong>JVM</strong>å†…å­˜å¸ƒå±€è§„å®šäº†Javaåœ¨è¿è¡Œè¿‡ç¨‹ä¸­<strong>å†…å­˜ç”³è¯·ï¼Œåˆ†é…ï¼Œç®¡ç†çš„ç­–ç•¥</strong>ã€‚<strong>ä¿è¯JVMçš„é«˜æ•ˆç¨³å®šè¿è¡Œ</strong></p><p><strong>ä¸åŒçš„JVMå¯¹äºå†…å­˜çš„åˆ’åˆ†æ–¹å¼å’Œç®¡ç†æœºåˆ¶å­˜åœ¨ç€éƒ¨åˆ†å·®å¼‚ã€‚</strong></p><p><strong>æ ¹æ®ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒ(Java SE 7 ç‰ˆ)ã€‹è§„å®š</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230402223725954.png" alt="image-20230402223725954"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922103933396.png" alt="image-20220922103933396"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922104555434.png" alt="image-20220922104555434">çº¢è‰²çš„ä¸ºå¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œç°è‰²çš„ä¸ºå•ä¸ªçº¿ç¨‹ç§æœ‰çš„ï¼Œå³</p><p><strong>çº¿ç¨‹é—´å…±äº«ï¼šå †ï¼Œå¯¹å¤–å†…å­˜ã€‚</strong></p><p><strong>æ¯ä¸ªçº¿ç¨‹ï¼šç‹¬ç«‹åŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ï¼Œæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆ</strong><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922104700100.png" alt="image-20220922104700100"></p><h3 id="ç¨‹åºè®¡æ•°å™¨-pc-regisster" tabindex="-1"><a class="header-anchor" href="#ç¨‹åºè®¡æ•°å™¨-pc-regisster" aria-hidden="true">#</a> ç¨‹åºè®¡æ•°å™¨ï¼ˆPC Regissterï¼‰</h3><p><strong>Program Counter Register</strong> ç¨‹åºè®¡æ•°å¯„å­˜å™¨</p><p><strong>ä½œç”¨ï¼šPC å¯„å­˜å™¨ ç”¨æ¥å‚¨å­˜æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ä»£ç ã€‚ç”±æ‰§è¡Œå¼•æ“è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922114918122.png" alt="image-20220922114918122"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922112757011.png" alt="image-20220922112757011"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922114457556.png" alt="image-20220922114457556"></p><p><strong>å†…å­˜ç©ºé—´å°ï¼Œçº¿ç¨‹ç§æœ‰</strong>ã€‚<strong>å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œ</strong>æ˜¯å°±æ˜¯<strong>é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡ŒæŒ‡ä»¤çš„å­—èŠ‚ç æŒ‡ä»¤</strong>ï¼Œ<strong>åˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è®¡æ•°å™¨å®Œæˆ</strong></p><p><strong>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œä¸€ä¸ª Java æ–¹æ³•</strong>ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯<strong>æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€</strong>ï¼›</p><p><strong>å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯ Native æ–¹æ³•</strong>ï¼Œè¿™ä¸ªè®¡æ•°å™¨çš„å€¼åˆ™ä¸º <strong>(Undefined)</strong>ã€‚</p><p><strong>æ­¤å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨ Java è™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½• OutOfMemoryError æƒ…å†µçš„åŒºåŸŸ</strong>ç¨‹åºè®¡æ•°å™¨çš„ç‰¹ç‚¹</p><p>1.çº¿ç¨‹éš”ç¦»æ€§ï¼Œæ¯ä¸ªçº¿ç¨‹å·¥ä½œæ—¶éƒ½æœ‰å±äºè‡ªå·±çš„ç‹¬ç«‹è®¡æ•°å™¨ã€‚ ã€€ã€€2.æ‰§è¡Œjavaæ–¹æ³•æ—¶ï¼Œç¨‹åºè®¡æ•°å™¨æ˜¯æœ‰å€¼çš„ï¼Œä¸”è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼ˆå‚è€ƒä¸Šä¸€å°èŠ‚çš„æè¿°ï¼‰ã€‚ ã€€ã€€3.æ‰§è¡Œnativeæœ¬åœ°æ–¹æ³•æ—¶ï¼Œç¨‹åºè®¡æ•°å™¨çš„å€¼ä¸ºç©ºï¼ˆUndefinedï¼‰ã€‚å› ä¸ºnativeæ–¹æ³•æ˜¯javaé€šè¿‡JNIç›´æ¥è°ƒç”¨æœ¬åœ°C/C++åº“ï¼Œå¯ä»¥è¿‘ä¼¼çš„è®¤ä¸ºnativeæ–¹æ³•ç›¸å½“äºC/C++æš´éœ²ç»™javaçš„ä¸€ä¸ªæ¥å£ï¼Œjavaé€šè¿‡è°ƒç”¨è¿™ä¸ªæ¥å£ä»è€Œè°ƒç”¨åˆ°C/C++æ–¹æ³•ã€‚ç”±äºè¯¥æ–¹æ³•æ˜¯é€šè¿‡C/C++è€Œä¸æ˜¯javaè¿›è¡Œå®ç°ã€‚é‚£ä¹ˆè‡ªç„¶æ— æ³•äº§ç”Ÿç›¸åº”çš„å­—èŠ‚ç ï¼Œå¹¶ä¸”C/C++æ‰§è¡Œæ—¶çš„å†…å­˜åˆ†é…æ˜¯ç”±è‡ªå·±è¯­è¨€å†³å®šçš„ï¼Œè€Œä¸æ˜¯ç”±JVMå†³å®šçš„</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922103004735.png" alt="image-20220922103004735"></p><h4 id="ç¨‹åºè®¡ç®—å™¨å¸¸è§é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#ç¨‹åºè®¡ç®—å™¨å¸¸è§é—®é¢˜" aria-hidden="true">#</a> ç¨‹åºè®¡ç®—å™¨å¸¸è§é—®é¢˜</h4><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922115103658.png" alt="image-20220922115103658"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922115138514.png" alt="image-20220922115138514"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922115320841.png" alt="image-20220922115320841"></p><h4 id="cpuæ—¶é—´ç‰‡" tabindex="-1"><a class="header-anchor" href="#cpuæ—¶é—´ç‰‡" aria-hidden="true">#</a> CPUæ—¶é—´ç‰‡ <img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922115459403.png" alt="image-20220922115459403"></h4><h4 id="cpu-å¹¶è¡Œ-å¹¶å‘" tabindex="-1"><a class="header-anchor" href="#cpu-å¹¶è¡Œ-å¹¶å‘" aria-hidden="true">#</a> <strong>CPU å¹¶è¡Œ å¹¶å‘</strong></h4><p><strong>å¹¶å‘ï¼šCPUå•ä¸ªæ ¸å¿ƒåŒæ—¶å¤„ç†å¤šä¸ªçº¿ç¨‹</strong>ï¼ˆå„ä¸ªçº¿ç¨‹äº‰å¤ºCPUæ—¶é—´ç‰‡ï¼Œåœ¨å„ä¸ªçº¿ç¨‹é—´æ¥å›é«˜é¢‘çš„åˆ‡æ¢ï¼‰</p><p><strong>å¹¶è¡Œï¼šCPUå¤šä¸ªæ ¸å¿ƒå¤„ç†å¤šä¸ªçº¿ç¨‹</strong></p><h3 id="è™šæ‹Ÿæœºæ ˆ-jvm-stack" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿæœºæ ˆ-jvm-stack" aria-hidden="true">#</a> è™šæ‹Ÿæœºæ ˆï¼ˆJVM Stackï¼‰</h3><p>**çº¿ç¨‹ç§æœ‰ï¼Œç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ä¸€è‡´ã€‚**æè¿°çš„æ˜¯ Java æ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼š<strong>æ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œæ—¶éƒ½ä¼šåºŠåˆ›å»ºä¸€ä¸ªæ ˆå¸§(Stack Frame)<strong>ç”¨äº</strong>å­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯</strong>ã€‚<strong>æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œç»“æŸï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§ä»è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹</strong>ã€‚<strong>è´Ÿè´£ç®¡ç†Javaç¨‹åºçš„è¿è¡Œ</strong></p><p><strong>å±€éƒ¨å˜é‡è¡¨</strong>ï¼šå­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§åŸºæœ¬ç±»å‹(booleanã€byteã€charã€shortã€intã€floatã€longã€double)ã€å¯¹è±¡å¼•ç”¨(reference ç±»å‹)å’Œ returnAddress ç±»å‹(æŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€)</p><p><strong>StackOverflowErrorï¼šçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ã€‚</strong><strong>OutOfMemoryErrorï¼šå¦‚æœè™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œè€Œæ‰©å±•æ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922121032602.png" alt="image-20220922121032602"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922121325647.png" alt="image-20220922121325647"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922121415970.png" alt="image-20220922121415970"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922120356973.png" alt="image-20220922120356973"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922120446022.png" alt="image-20220922120446022"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922120737732.png" alt="image-20220922120737732"></p><h4 id="æ ˆå¯èƒ½ä¼šå‡ºç°çš„å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#æ ˆå¯èƒ½ä¼šå‡ºç°çš„å¼‚å¸¸" aria-hidden="true">#</a> æ ˆå¯èƒ½ä¼šå‡ºç°çš„å¼‚å¸¸</h4><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922121753369.png" alt="image-20220922121753369"></p><h4 id="è®¾ç½®æ ˆå›ºå®šçš„å†…å­˜å¤§å°" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®æ ˆå›ºå®šçš„å†…å­˜å¤§å°" aria-hidden="true">#</a> è®¾ç½®æ ˆå›ºå®šçš„å†…å­˜å¤§å°</h4><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922121856779.png" alt="image-20220922121856779"></p><h4 id="æ ˆçš„å‚¨å­˜å•ä½-æ ˆå¸§" tabindex="-1"><a class="header-anchor" href="#æ ˆçš„å‚¨å­˜å•ä½-æ ˆå¸§" aria-hidden="true">#</a> æ ˆçš„å‚¨å­˜å•ä½-æ ˆå¸§</h4><p><strong>åŸºæœ¬å•ä½:æ ˆå¸§</strong> <strong>çº¿ç¨‹ä¸Šæ­£åœ¨æ‰§è¡Œçš„æ¯ä¸ªæ–¹æ³•å¯¹åº”ä¸€ä¸ªæ ˆå¸§</strong><strong>æ ˆ éµå¾ªå…ˆè¿›åå‡ºçš„åŸåˆ™ åªæœ‰pushå‹æ ˆ popå¼¹å‡ºæ ˆ</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922122019231.png" alt="image-20220922122019231"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922122228725.png" alt="image-20220922122228725"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922122243126.png" alt="image-20220922122243126"></p><h4 id="æ ˆå¸§çš„å†…éƒ¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#æ ˆå¸§çš„å†…éƒ¨ç»“æ„" aria-hidden="true">#</a> æ ˆå¸§çš„å†…éƒ¨ç»“æ„</h4><p><strong>æ¯ä¸€ä¸ªæ ˆå¸§</strong>éƒ½åŒ…æ‹¬äº†<strong>å±€éƒ¨å˜é‡è¡¨</strong>ã€<strong>æ“ä½œæ•°æ ˆ</strong>ã€åŠ¨æ€è¿æ¥ã€æ–¹æ³•è¿”å›åœ°å€å’Œä¸€äº›é¢å¤–çš„é™„åŠ ä¿¡æ¯ã€‚ <strong>åœ¨ç¼–è¯‘Javaç¨‹åºæºç çš„æ—¶å€™</strong>ï¼Œ<strong>æ ˆå¸§ä¸­éœ€è¦å¤šå¤§çš„å±€éƒ¨å˜é‡è¡¨ï¼Œéœ€è¦å¤šæ·±çš„æ“ä½œæ•°æ ˆå°±å·²ç»è¢«åˆ†æè®¡ç®— å‡ºæ¥</strong>ï¼Œå¹¶ä¸”<strong>å†™å…¥åˆ°æ–¹æ³•è¡¨çš„Codeå±æ€§ä¹‹ä¸­</strong>[2]ã€‚æ¢è¨€ä¹‹ï¼Œä¸€ä¸ªæ ˆå¸§éœ€è¦åˆ†é…å¤šå°‘å†…å­˜ï¼Œå¹¶ä¸ä¼šå—åˆ°ç¨‹åº è¿è¡ŒæœŸå˜é‡æ•°æ®çš„å½±å“ï¼Œè€Œä»…ä»…å–å†³äºç¨‹åºæºç å’Œå…·ä½“çš„è™šæ‹Ÿæœºå®ç°çš„æ ˆå†…å­˜å¸ƒå±€å½¢å¼ <img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922153214796.png" alt="image-20220922153214796"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922133628454.png" alt="image-20220922133628454"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922140150860.png" alt="image-20220922140150860"></p><h5 id="å±€éƒ¨å˜é‡è¡¨" tabindex="-1"><a class="header-anchor" href="#å±€éƒ¨å˜é‡è¡¨" aria-hidden="true">#</a> å±€éƒ¨å˜é‡è¡¨</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922140309136.png" alt="image-20220922140309136"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144053348.png" alt="image-20220922144053348"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922141344440.png" alt="image-20220922141344440"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922141157285.png" alt="image-20220922141157285"></p><h6 id="slotæ§½-é‡å¤åˆ©ç”¨" tabindex="-1"><a class="header-anchor" href="#slotæ§½-é‡å¤åˆ©ç”¨" aria-hidden="true">#</a> slotæ§½ é‡å¤åˆ©ç”¨</h6><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144036851.png" alt="image-20220922144036851"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144108124.png" alt="image-20220922144108124"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144120973.png" alt="image-20220922144120973"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144135710.png" alt="image-20220922144135710"></p><h6 id="é™æ€å˜é‡å’Œå±€éƒ¨å˜é‡çš„å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#é™æ€å˜é‡å’Œå±€éƒ¨å˜é‡çš„å¯¹æ¯”" aria-hidden="true">#</a> é™æ€å˜é‡å’Œå±€éƒ¨å˜é‡çš„å¯¹æ¯”</h6><p><strong>å±€éƒ¨å˜é‡å¿…é¡»æ˜¾æ€§åˆå§‹åŒ–</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144310733.png" alt="image-20220922144310733"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144332069.png" alt="image-20220922144332069"></p><h6 id="é™æ€æ–¹æ³•-éé™æ€æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨" tabindex="-1"><a class="header-anchor" href="#é™æ€æ–¹æ³•-éé™æ€æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨" aria-hidden="true">#</a> é™æ€æ–¹æ³•&amp;éé™æ€æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨</h6><p><strong>é™æ€æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ä¸­æ— thiså˜é‡ å› æ­¤é™æ€æ–¹æ³•ä¸­æ— æ³•ä½¿ç”¨this.</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922145200405.png" alt="image-20220922145200405"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144804451.png" alt="image-20220922144804451"></p><p><strong>éé™æ€æ–¹æ³•ä¸­é»˜è®¤éƒ½å­˜åœ¨thiså˜é‡</strong><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922145236412.png" alt="image-20220922145236412"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922144828044.png" alt="image-20220922144828044"></p><h5 id="æ“ä½œæ•°æ ˆ" tabindex="-1"><a class="header-anchor" href="#æ“ä½œæ•°æ ˆ" aria-hidden="true">#</a> æ“ä½œæ•°æ ˆ</h5><p>æ“ä½œæ•°æ ˆï¼ˆOperand Stackï¼‰ä¹Ÿå¸¸è¢«ç§°ä¸ºæ“ä½œæ ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªåå…¥å…ˆå‡ºï¼ˆLast In First Outï¼ŒLIFOï¼‰ æ ˆã€‚åŒå±€éƒ¨å˜é‡è¡¨ä¸€æ ·ï¼Œ<strong>æ“ä½œæ•°æ ˆçš„æœ€å¤§æ·±åº¦ä¹Ÿåœ¨ç¼–è¯‘çš„æ—¶å€™è¢«å†™å…¥åˆ°Codeå±æ€§çš„max_stacksæ•°æ®é¡¹ ä¹‹ä¸­</strong>ã€‚</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922153608081.png" alt="image-20220922153608081"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922150755930.png" alt="image-20220922150755930"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922150447171.png" alt="image-20220922150447171"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922150457435.png" alt="image-20220922150457435"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922150557178.png" alt="image-20220922150557178"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922150921447.png" alt="image-20220922150921447"></p><p><strong>ä»£ç æ¼”ç¤º</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922151651694.png" alt="image-20220922151651694"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922151601001.png" alt="image-20220922151601001"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922151610177.png" alt="image-20220922151610177"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922151618655.png" alt="image-20220922151618655"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922151630355.png" alt="image-20220922151630355"></p><h5 id="æ ˆé¡¶ç¼“å­˜æŠ€æœ¯" tabindex="-1"><a class="header-anchor" href="#æ ˆé¡¶ç¼“å­˜æŠ€æœ¯" aria-hidden="true">#</a> æ ˆé¡¶ç¼“å­˜æŠ€æœ¯</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220922152641277.png" alt="image-20220922152641277"></p><h5 id="åŠ¨æ€é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€é“¾æ¥" aria-hidden="true">#</a> åŠ¨æ€é“¾æ¥</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924115541013.png" alt="image-20220924115541013"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924115552912.png" alt="image-20220924115552912"></p><h5 id="æ–¹æ³•çš„è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•çš„è°ƒç”¨" aria-hidden="true">#</a> æ–¹æ³•çš„è°ƒç”¨</h5><h6 id="éè™šæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#éè™šæ–¹æ³•" aria-hidden="true">#</a> éè™šæ–¹æ³•</h6><p><strong>æ—©åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šäº† åœ¨è¿è¡Œæ—¶æ˜¯ä¸å¯å˜çš„</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924130607798.png" alt="image-20220924130607798"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924130732990.png" alt="image-20220924130718490"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924130747487.png" alt="image-20220924130747487"></p><h6 id="è™šæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#è™šæ–¹æ³•" aria-hidden="true">#</a> è™šæ–¹æ³•</h6><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927090842602.png" alt="image-20220927090842602"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924130821628.png" alt="image-20220924130821628"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924130804702.png" alt="image-20220924130804702"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924130858208.png" alt="image-20220924130858208"></p><h6 id="æ™®é€šè°ƒç”¨æŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#æ™®é€šè°ƒç”¨æŒ‡ä»¤" aria-hidden="true">#</a> æ™®é€šè°ƒç”¨æŒ‡ä»¤</h6><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924131136904.png" alt="image-20220924131136904"></p><h6 id="åŠ¨æ€è°ƒç”¨æŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€è°ƒç”¨æŒ‡ä»¤" aria-hidden="true">#</a> åŠ¨æ€è°ƒç”¨æŒ‡ä»¤</h6><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924131144565.png" alt="image-20220924131144565"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924131227943.png" alt="image-20220924131227943"><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924131239943.png" alt="image-20220924131239943"></p><h5 id="æ–¹æ³•è¿”å›åœ°å€" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•è¿”å›åœ°å€" aria-hidden="true">#</a> æ–¹æ³•è¿”å›åœ°å€</h5><p><strong>æ–¹æ³•è¿”å›</strong></p><p>å½“ä¸€ä¸ªæ–¹æ³•å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯èƒ½æœ‰<strong>æ­£å¸¸é€€å‡º</strong>å’Œ<strong>å¼‚å¸¸é€€å‡º</strong>ä¸¤ç§æƒ…å†µã€‚</p><p><strong>æ­£å¸¸é€€å‡º</strong>æ˜¯æŒ‡æ–¹æ³•æ­£å¸¸å®Œæˆæ“ä½œå¹¶é€€å‡ºï¼Œæ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œå¦‚æœå½“å‰æ–¹æ³•æ­£å¸¸å®Œæˆï¼Œåˆ™æ ¹æ®å½“å‰æ–¹æ³•è¿”å›çš„å­—èŠ‚ç æŒ‡ä»¤è¿›è¡Œå¤„ç†ã€‚è¯¥æ–¹æ³•è¿”å›çš„å­—èŠ‚ç æŒ‡ä»¤ä¸­æœ‰å¯èƒ½å­˜åœ¨è¿”å›å€¼ï¼Œä¹Ÿå¯èƒ½ä¸å­˜åœ¨è¿”å›å€¼ã€‚</p><p><strong>å¼‚å¸¸é€€å‡º</strong>æ˜¯æŒ‡æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°å¼‚å¸¸ï¼Œå¹¶ä¸”è¿™ä¸ªå¼‚å¸¸åœ¨æ–¹æ³•ä½“å†…éƒ¨æ²¡æœ‰å¾—åˆ°å¤„ç†ï¼Œå¯¼è‡´æ–¹æ³•é€€å‡ºã€‚ä¹Ÿå°±æ˜¯è¯´æ— è®ºæ˜¯Javaè™šæ‹ŸæœºæŠ›å‡ºçš„å¼‚å¸¸è¿˜æ˜¯ä»£ç ä¸­ä½¿ç”¨throwäº§ç”Ÿçš„å¼‚å¸¸ï¼Œåªè¦åœ¨æœ¬æ–¹æ³•çš„å¼‚å¸¸è¡¨ä¸­æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œå°±ä¼šå¯¼è‡´æ–¹æ³•é€€å‡ºã€‚</p><p>æ— è®ºæ–¹æ³•é‡‡ç”¨ä½•ç§æ–¹å¼é€€å‡ºï¼Œ<strong>åœ¨æ–¹æ³•é€€å‡ºåéƒ½éœ€è¦è¿”å›åˆ°æ–¹æ³•è¢«è°ƒç”¨çš„ä½ç½®ï¼Œç¨‹åºæ‰èƒ½ç»§ç»­æ‰§è¡Œ</strong>ï¼Œæ–¹æ³•è¿”å›æ—¶å¯èƒ½éœ€è¦åœ¨å½“å‰æ ˆå¸§ä¸­ä¿å­˜ä¸€äº›ä¿¡æ¯ï¼Œç”¨æ¥å¸®å®ƒæ¢å¤å…¶ä¸Šå±‚æ–¹æ³•çš„æ‰§è¡ŒçŠ¶æ€ã€‚<strong>æ–¹æ³•é€€å‡ºè¿‡ç¨‹å®é™…ä¸Šç­‰åŒäºæŠŠå½“å‰æ ˆå¸§å‡ºæ ˆ</strong>ï¼Œå› æ­¤é€€å‡ºå¯ä»¥æ‰§è¡Œçš„æ“ä½œæœ‰ï¼š<strong>æ¢å¤ä¸Šå±‚æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨å’Œæ“ä½œæ•°æ ˆï¼Œå¦‚æœæœ‰è¿”å›å€¼ï¼Œéœ€è¦å°†è¿”å›å€¼å‹å…¥è°ƒç”¨è€…çš„æ“ä½œæ•°æ ˆä¸­</strong>ï¼ŒåŒæ—¶<strong>è°ƒæ•´PCè®¡æ•°å™¨çš„å€¼ä»¥æŒ‡å‘æ–¹æ³•è°ƒç”¨æŒ‡ä»¤åçš„ä¸‹ä¸€æ¡æŒ‡ä»¤</strong>ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>æ–¹æ³•æ­£å¸¸é€€å‡ºæ—¶ï¼Œè°ƒç”¨è€…çš„PCè®¡æ•°å™¨å€¼å¯ä»¥ä½œä¸ºè¿”å›åœ°å€</strong>ï¼Œæ ˆå¸§ä¸­å¯èƒ½ä¿å­˜æ­¤è®¡æ•°å€¼ï¼Œ<strong>è€Œæ–¹æ³•å¼‚å¸¸é€€å‡ºæ—¶ï¼Œè¿”å›åœ°å€æ˜¯é€šè¿‡å¼‚å¸¸å¤„ç†å™¨è¡¨ç¡®å®šçš„</strong>ï¼Œæ ˆå¸§ä¸­ä¸€èˆ¬ä¸ä¼šä¿å­˜æ­¤éƒ¨åˆ†ä¿¡æ¯</p><h5 id="é™„åŠ ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#é™„åŠ ä¿¡æ¯" aria-hidden="true">#</a> é™„åŠ ä¿¡æ¯</h5><h4 id="æ–¹æ³•çš„ç»“æŸ-æ ˆçš„pop" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•çš„ç»“æŸ-æ ˆçš„pop" aria-hidden="true">#</a> æ–¹æ³•çš„ç»“æŸ-æ ˆçš„pop</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * è™šæ‹Ÿæœºæ ˆçš„æŸ¥çœ‹
 * æ–¹æ³•çš„ç»“æŸåˆ†ä¸ºä¸¤ç§ ä¸€ç§æ˜¯æ­£å¸¸çš„å‡½æ•°è¿”å›(return) ä¸€ç§æ˜¯æŠ›å‡ºå¼‚å¸¸çš„ç»“æŸ éƒ½ä¼šå¯¼è‡´æ ˆå¸§pop
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoadingTest6</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">ClassLoadingTest6</span> classLoadingTest6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassLoadingTest6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>classLoadingTest6<span class="token punctuation">.</span><span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Eddie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//        System.out.println(10/0);</span>
        <span class="token keyword">return</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">method3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">method3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è™šæ‹Ÿæœºæ ˆç›¸å…³é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿæœºæ ˆç›¸å…³é¢è¯•é¢˜" aria-hidden="true">#</a> è™šæ‹Ÿæœºæ ˆç›¸å…³é¢è¯•é¢˜</h4><p><strong>â‘ ï¼šä¸¾ä¾‹æ ˆæº¢å‡ºçš„æƒ…å†µï¼Ÿï¼ˆæº¢å‡ºå¼‚å¸¸ï¼šStackOverFlowErrorï¼‰</strong></p><p>â€‹ é€šè¿‡-Xssè®¾ç½®æ ˆçš„å¤§å°</p><p><strong>â‘¡ï¼šè°ƒæ•´æ ˆçš„å¤§å°ï¼Œå°±èƒ½ä¿è¯ä¸å‡ºç°æ ˆæº¢å‡ºå—ï¼Ÿ</strong></p><p>â€‹ æ— æ³•ä¿è¯ï¼›æ¯”å¦‚é€’å½’è°ƒç”¨æ— å½’æƒ…å†µæ—¶ï¼›</p><p><strong>â‘¢ï¼šåˆ†é…çš„æ ˆå†…å­˜è¶Šå¤§è¶Šå¥½å—ï¼Ÿ</strong></p><p>â€‹ åªæ˜¯é¿å…è¿‡æ—©çš„å‡ºç°æº¢å‡ºå¼‚å¸¸ï¼šStackOverFlowError</p><p>â€‹ æ ˆå†…å­˜å¤§äº† ä¼šå½±å“çº¿ç¨‹æ•°çš„æ•°é‡ ä¼šæŒ¤å åˆ«çš„å†…å­˜ç©ºé—´</p><p><strong>â‘£ï¼šåƒåœ¾å›æ”¶ä¼šæ¶‰åŠåˆ°è™šæ‹Ÿæœºæ ˆå—ï¼Ÿ</strong></p><p>â€‹ ä¸ä¼šçš„ï¼›è¿›æ ˆå‡ºæ ˆ</p><p><strong>â‘¤ï¼šæ–¹æ³•ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨ï¼Ÿ</strong></p><p>â€‹ å…·ä½“é—®é¢˜å…·ä½“åˆ†æ</p><p>â€‹ æ¯”å¦‚StringBuilder çº¿ç¨‹ä¸å®‰å…¨</p><p>â€‹ StringBufferçº¿ç¨‹å®‰å…¨</p><h3 id="æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" tabindex="-1"><a class="header-anchor" href="#æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" aria-hidden="true">#</a> æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</h3><p><strong>æœ¬åœ°æ–¹æ³•æ ˆæ˜¯ç”¨äºç®¡ç†æœ¬åœ°æ–¹æ³•çš„è°ƒç”¨</strong></p><p><strong>å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨äº†ä¸€ä¸ªæœ¬åœ°æ–¹æ³•æ—¶ï¼Œå®ƒå°±è¿›å…¥äº†ä¸€ä¸ªå…¨æ–°çš„å¹¶ä¸”ä¸å†å—è™šæ‹Ÿæœºé™åˆ¶çš„ä¸–ç•Œã€‚å®ƒå’Œè™šæ‹Ÿæœºæœ‰åŒæ ·çš„æƒé™ã€‚</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924141814214.png" alt="image-20220924141814214"></p><h4 id="æœ¬åœ°æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æœ¬åœ°æ–¹æ³•" aria-hidden="true">#</a> æœ¬åœ°æ–¹æ³•</h4><p>Nativeæ ‡è¯† æœ¬åœ°æ–¹æ³•</p><p>ä¸€ä¸ªNative Methodå°±æ˜¯ä¸€ä¸ªJavaè°ƒç”¨éJavaä»£ç çš„æ¥å£ã€‚</p><p><strong>ä¸ºäº†å’ŒJavaç¯å¢ƒå¤–äº¤äº’</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924141918126.png" alt="image-20220924141918126"></p><p>ä¾‹å¦‚çº¿ç¨‹åœ¨è°ƒç”¨Startï¼ˆï¼‰æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹æ—¶ å®é™…æ˜¯ç³»ç»Ÿè°ƒç”¨æœ¬åœ°æ–¹æ³•start0ï¼ˆï¼‰æ¥å¯åŠ¨çº¿ç¨‹</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220924142141419.png" alt="image-20220924142141419"></p><h3 id="å †-heep" tabindex="-1"><a class="header-anchor" href="#å †-heep" aria-hidden="true">#</a> å †ï¼ˆheepï¼‰</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230131120051541.png" alt="image-20230131120051541"></p><h5 id="åˆ†åŒº" tabindex="-1"><a class="header-anchor" href="#åˆ†åŒº" aria-hidden="true">#</a> åˆ†åŒº</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927101930526.png" alt="image-20220927101930526"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927101843595.png" alt="image-20220927101843595"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927102014262.png" alt="image-20220927102014262"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927101916109.png" alt="image-20220927101916109"></p><h5 id="åˆ†åŒºæ€æƒ³" tabindex="-1"><a class="header-anchor" href="#åˆ†åŒºæ€æƒ³" aria-hidden="true">#</a> åˆ†åŒºæ€æƒ³</h5><p>ç ”ç©¶è¡¨æ˜ï¼šä¸åŒçš„å¯¹è±¡ ç”Ÿå‘½å‘¨æœŸä¸åŒ ç™¾åˆ†ä¹‹70-ç™¾åˆ†ä¹‹90çš„å¯¹è±¡éƒ½æ˜¯ä¸´æ—¶å¯¹è±¡ï¼ˆæœç”Ÿå¤•æ­»ï¼‰</p><p>æ–°ç”Ÿä»£ï¼šæœ‰EdenåŒºå’Œä¸¤ä¸ªå¹¸å­˜è€…åŒºSurvivor0ä»¥åŠSurvivor1ï¼ˆfromä»¥åŠtoï¼‰æ„æˆï¼›toæ€»ä¸ºç©ºã€‚</p><p>è€å¹´ä»£ï¼šå­˜æ”¾åœ¨æ–°ç”Ÿä»£ä¸­ç»å†å¤šæ¬¡GCï¼ˆé˜ˆå€¼é»˜è®¤15ï¼‰ä»ç„¶å­˜æ´»çš„å¯¹è±¡</p><p><strong>åˆ†åŒºçš„å”¯ä¸€ç†ç”±å°±æ˜¯ä¼˜åŒ–GCçš„æ€§èƒ½</strong></p><h5 id="æ–°ç”Ÿä»£" tabindex="-1"><a class="header-anchor" href="#æ–°ç”Ÿä»£" aria-hidden="true">#</a> æ–°ç”Ÿä»£</h5><p>æ–°å¯¹è±¡å’Œæ²¡è¾¾åˆ°ä¸€å®šå¹´é¾„çš„å¯¹è±¡éƒ½åœ¨æ–°ç”Ÿä»£</p><p>**Survivor0å’ŒSurvivor1æ°¸è¿œåªæœ‰ä¸€ä¸ªåœ¨è¢«ä½¿ç”¨ ä¸¤ä¸ªä¸ä¼šåŒæ—¶ä½¿ç”¨ ** å³æœ‰ä¸€ä¸ªå¹¸å­˜è€…ç©ºé—´æ€»æ˜¯ç©ºçš„</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927101941987.png" alt="image-20220927101941987"></p><h5 id="è€å¹´ä»£" tabindex="-1"><a class="header-anchor" href="#è€å¹´ä»£" aria-hidden="true">#</a> è€å¹´ä»£</h5><p>è¢«é•¿æ—¶é—´ä½¿ç”¨çš„å¯¹è±¡ï¼Œè€å¹´ä»£çš„å†…å­˜ç©ºé—´åº”è¯¥è¦æ¯”å¹´è½»ä»£æ›´å¤§</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927101954168.png" alt="image-20220927101954168"></p><h5 id="å…ƒç©ºé—´-éå †" tabindex="-1"><a class="header-anchor" href="#å…ƒç©ºé—´-éå †" aria-hidden="true">#</a> å…ƒç©ºé—´ï¼ˆéå †ï¼‰</h5><p>ï¼ˆJDK1.8 ä¹‹å‰å«æ°¸ä¹…ä»£ï¼‰ï¼šåƒä¸€äº›æ–¹æ³•ä¸­çš„æ“ä½œä¸´æ—¶å¯¹è±¡ç­‰ï¼ŒJDK1.8 ä¹‹å‰æ˜¯å ç”¨ JVM å†…å­˜ï¼ŒJDK1.8 ä¹‹åç›´æ¥ä½¿ç”¨ç‰©ç†å†…å­˜</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927102003408.png" alt="image-20220927102003408"></p><h5 id="è®¾ç½®å †å†…å­˜å¤§å°å’Œ-oom" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®å †å†…å­˜å¤§å°å’Œ-oom" aria-hidden="true">#</a> è®¾ç½®å †å†…å­˜å¤§å°å’Œ OOM</h5><h5 id="æ‰‹åŠ¨è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#æ‰‹åŠ¨è®¾ç½®" aria-hidden="true">#</a> æ‰‹åŠ¨è®¾ç½®</h5><p>å¼€å‘ä¸­å»ºè®®å°†åˆå§‹å †å†…å­˜ å’Œ æœ€å¤§å †å†…å­˜è®¾ç½®ä¸ºä¸€æ ·çš„å€¼</p><p>-Xms6000m -Xmx6000m</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927103311050.png" alt="image-20220927103311050"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927102743735.png" alt="image-20220927102743735"></p><h5 id="é»˜è®¤æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#é»˜è®¤æƒ…å†µ" aria-hidden="true">#</a> é»˜è®¤æƒ…å†µ</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">//è¿”å› JVM å †å¤§å°</span>
    <span class="token keyword">long</span> initalMemory <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">;</span>
    <span class="token comment">//è¿”å› JVM å †çš„æœ€å¤§å†…å­˜</span>
    <span class="token keyword">long</span> maxMemory <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-Xms : &quot;</span><span class="token operator">+</span>initalMemory <span class="token operator">+</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-Xmx : &quot;</span><span class="token operator">+</span>maxMemory <span class="token operator">+</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»ç»Ÿå†…å­˜å¤§å°ï¼š&quot;</span> <span class="token operator">+</span> initalMemory <span class="token operator">*</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">+</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»ç»Ÿå†…å­˜å¤§å°ï¼š&quot;</span> <span class="token operator">+</span> maxMemory <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">+</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//-Xms : 254M</span>
    <span class="token comment">//-Xmx : 4064M</span>
    <span class="token comment">//ç³»ç»Ÿå†…å­˜å¤§å°ï¼š15G</span>
    <span class="token comment">//ç³»ç»Ÿå†…å­˜å¤§å°ï¼š15G</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="æŸ¥çœ‹-è®¾ç½®çš„å‚æ•°" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹-è®¾ç½®çš„å‚æ•°" aria-hidden="true">#</a> æŸ¥çœ‹ è®¾ç½®çš„å‚æ•°</h5><p>ä¸¤ç§æ–¹å¼</p><p>â‘ :cmd--jps--jstat -gc è¿›ç¨‹id</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927105415037.png" alt="image-20220927105415037"></p><p>â‘¡:-XX:+PrintGCDetails</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927105528630.png" alt="image-20220927105528630"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927105607060.png" alt="image-20220927105607060"></p><h5 id="æŸ¥çœ‹-jvm-å †å†…å­˜åˆ†é…" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹-jvm-å †å†…å­˜åˆ†é…" aria-hidden="true">#</a> æŸ¥çœ‹ JVM å †å†…å­˜åˆ†é…</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927110813485.png" alt="image-20220927110813485"></p><h5 id="å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" aria-hidden="true">#</a> å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</h5><p>æˆ‘ä»¬çš„å¾ˆå¤šå¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•æ­»çš„</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šè¢«åˆ†é…åˆ°EdenåŒº(ä¸€äº›å¤§å¯¹è±¡ç‰¹æ®Šå¤„ç†)</p><p>è¿™äº›å¯¹è±¡ç»è¿‡ç¬¬ä¸€æ¬¡Minor GCåï¼Œå¦‚æœä»ç„¶å­˜æ´»ï¼Œå°†ä¼šè¢«ç§»åˆ°SurvivoråŒºã€‚å¯¹è±¡åœ¨SurvivoråŒºä¸­æ¯ç†¬è¿‡ä¸€æ¬¡Minor GCï¼Œå¹´é¾„å°±ä¼šå¢åŠ 1å²ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼Œå°±ä¼šè¢«ç§»åŠ¨åˆ°å¹´è€ä»£ä¸­</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927111435033.png" alt="image-20220927111435033"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927113802658.png" alt="image-20220927113802658"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927114247641.png" alt="image-20220927114247641"></p><h5 id="å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹" aria-hidden="true">#</a> å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹</h5><p>å…¶ä¸­ å¹¸å­˜è€…åŒºçš„fromåŒºå’ŒtoåŒºå¤åˆ¶ï¼ˆå¤åˆ¶ç®—æ³•ï¼‰ä¹‹åè¿›è¡Œäº¤æ¢ è°ç©ºè°ä¸ºto</p><p>ä¸€GCä¸€äº¤æ¢ è°ç©ºè°æ˜¯to</p><p>å…³äºGCï¼šé¢‘ç¹åœ¨æ–°ç”Ÿä»£ä¸­æ”¶é›† å¾ˆå°‘åœ¨è€å¹´ä»£ä¸­æ”¶é›†ï¼Œå‡ ä¹ä¸åœ¨æ°¸ä¹…ä»£/å…ƒç©ºé—´ä¸­æ”¶é›†</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927114457272.png" alt="image-20220927114457272"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927134856686.png" alt="image-20220927134856686"></p><h5 id="å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹çš„ç‰¹æ®Šæƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹çš„ç‰¹æ®Šæƒ…å†µ" aria-hidden="true">#</a> å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹çš„ç‰¹æ®Šæƒ…å†µ</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927121647339.png" alt="image-20220927121647339"></p><h5 id="gc-åƒåœ¾å›æ”¶ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#gc-åƒåœ¾å›æ”¶ç®€ä»‹" aria-hidden="true">#</a> GC åƒåœ¾å›æ”¶ç®€ä»‹</h5><p><strong>æˆ‘ä»¬çš„å¾ˆå¤šå¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•æ­»çš„</strong> <strong>å› æ­¤Minor GCä¼šé¢‘ç¹çš„è§¦å‘</strong></p><p><strong>Minor GCæ˜¯EdenåŒºæ»¡æ—¶è§¦å‘ï¼ˆSurvivoråŒºæ»¡ä¸ä¼šè§¦å‘Minor GCï¼‰</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927124003012.png" alt="image-20220927124003012"></p><p>Major GCçš„é€Ÿåº¦ æ¯” Minor GCé€šå¸¸ è¦æ…¢10å€ä»¥ä¸Š ä»è€ŒSTWçš„æ—¶é—´æ›´é•¿</p><p><strong>è°ƒä¼˜æ—¶è¦å‡å°‘Major GCçš„è§¦å‘æ¬¡æ•° Full GCçš„è§¦å‘æ¬¡æ•°</strong></p><h5 id="å†…å­˜åˆ†é…ç­–ç•¥-å¯¹è±¡promotionç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#å†…å­˜åˆ†é…ç­–ç•¥-å¯¹è±¡promotionç­–ç•¥" aria-hidden="true">#</a> å†…å­˜åˆ†é…ç­–ç•¥ï¼ˆå¯¹è±¡Promotionç­–ç•¥ï¼‰</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927141828861.png" alt="image-20220927141828861"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927141855732.png" alt="image-20220927141855732"></p><p><strong>å¤§å¯¹è±¡ç›´æ¥åˆ†é…åˆ°è€å¹´ä»£ï¼ˆæ–°ç”Ÿä»£æ— æ³•æ‰¿è½½çš„å¤§å¯¹è±¡ ç›´æ¥åˆ†é…åˆ°è€å¹´ä»£ï¼‰</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927142308928.png" alt="image-20220927142308928"></p><h5 id="å †ç©ºé—´çš„å‚æ•°è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#å †ç©ºé—´çš„å‚æ•°è®¾ç½®" aria-hidden="true">#</a> å †ç©ºé—´çš„å‚æ•°è®¾ç½®</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927154321104.png" alt="image-20220927154321104"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927153736307.png" alt="image-20220927153736307"></p><h5 id="ç©ºé—´åˆ†é…æ‹…ä¿" tabindex="-1"><a class="header-anchor" href="#ç©ºé—´åˆ†é…æ‹…ä¿" aria-hidden="true">#</a> ç©ºé—´åˆ†é…æ‹…ä¿</h5><p><strong>ç›®å‰æ¥è®²jdk7ä»¥æ¥ ç©ºé—´åˆ†é…æ‹…ä¿ é»˜è®¤ä¸ºtrue</strong></p><p><strong>å³ï¼šæ£€æµ‹åˆ°è€å¹´ä»£çš„æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡çš„æ€»ç©ºé—´ï¼ˆæœ€åæƒ…å†µä¸‹æ–°ç”Ÿä»£çš„æ‰€æœ‰å¯¹è±¡éƒ½å­˜æ´»ä¸‹æ¥è¦æ™‹å‡åˆ°è€å¹´ä»£ï¼‰</strong></p><p>â€‹ <strong>æ£€æµ‹åˆ°è€å¹´ä»£çš„æœ€å¤§å¯ç”¨è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡çš„å¹³å‡å¤§å°ï¼ˆæŒ‰ç…§å¾€æ¬¡çš„æ™‹å‡ç»Ÿè®¡ï¼‰</strong></p><p>â€‹ <strong>éƒ½ä¼šè¿›è¡ŒMinor GC å¦åˆ™è¿›è¡ŒFull GC</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927153800393.png" alt="image-20220927153800393"></p><h5 id="tlab" tabindex="-1"><a class="header-anchor" href="#tlab" aria-hidden="true">#</a> TLAB</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927151535365.png" alt="image-20220927151535365"></p><h5 id="å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" tabindex="-1"><a class="header-anchor" href="#å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" aria-hidden="true">#</a> å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927155518020.png" alt="image-20220927155518020"></p><h5 id="é€ƒé€¸åˆ†æ" tabindex="-1"><a class="header-anchor" href="#é€ƒé€¸åˆ†æ" aria-hidden="true">#</a> é€ƒé€¸åˆ†æ</h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927164118327.png" alt="image-20220927164118327"></p><p>é€ƒé€¸åˆ†æåœ¨JITç¼–è¯‘å™¨ä½¿ç”¨</p><p>æ‰§è¡Œå¼•æ“æ˜¯è§£é‡Šå™¨å’ŒJITç¼–è¯‘å™¨æ··åˆä½¿ç”¨çš„</p><p><strong>Hotspotè™šæ‹Ÿæœºæ²¡æœ‰æ ˆä¸Šåˆ†é… å› æ­¤æ˜¯é€šè¿‡æ ‡é‡æ›¿æ¢å®ç°çš„ï¼›</strong> <strong>æ ‡é‡æ›¿æ¢å°†èšåˆé‡ï¼ˆå¯¹è±¡ï¼‰æ‰“æ•£æˆæ ‡é‡ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠå¯¹è±¡çš„å¼•ç”¨ï¼‰</strong></p><p>æ¢è¨€ä¹‹ï¼šåœ¨Hotspotè™šæ‹Ÿæœºä¸­ é€šè¿‡é€ƒé€¸åˆ†æ å‘ç°äº†æœªå‘ç”Ÿé€ƒé€¸çš„å¯¹è±¡ å¯ä»¥è¿›è¡Œæ ‡é‡æ›¿æ¢ å°†å…¶å­˜å‚¨äºæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨é‡Œã€‚å‡è½»å †ç©ºé—´çš„å‹åŠ›ï¼ˆGCçš„é¢‘ç‡ï¼‰</p><p><strong>é€ƒé€¸åˆ†æ(Escape Analysis)*<em>æ˜¯ç›®å‰ Java è™šæ‹Ÿæœºä¸­æ¯”è¾ƒå‰æ²¿çš„ä¼˜åŒ–æŠ€æœ¯*</em>ã€‚è¿™æ˜¯ä¸€ç§å¯ä»¥æœ‰æ•ˆå‡å°‘ Java ç¨‹åºä¸­åŒæ­¥è´Ÿè½½å’Œå†…å­˜å †åˆ†é…å‹åŠ›çš„è·¨å‡½æ•°å…¨å±€æ•°æ®æµåˆ†æç®—æ³•</strong>ã€‚é€šè¿‡é€ƒé€¸åˆ†æï¼ŒJava Hotspot ç¼–è¯‘å™¨èƒ½å¤Ÿåˆ†æå‡ºä¸€ä¸ªæ–°çš„å¯¹è±¡çš„å¼•ç”¨çš„ä½¿ç”¨èŒƒå›´ä»è€Œå†³å®šæ˜¯å¦è¦å°†è¿™ä¸ªå¯¹è±¡åˆ†é…åˆ°å †ä¸Šã€‚</p><p><strong>JDK7ä»¥æ¥é»˜è®¤å¼€å¯é€ƒé€¸åˆ†æï¼›</strong></p><p><strong>å¼€å‘ä¸­ èƒ½ä½¿ç”¨å±€éƒ¨å˜é‡çš„å°±å°½é‡ä¸åœ¨æ–¹æ³•å¤–å®šä¹‰ï¼›</strong></p><p>é€ƒé€¸åˆ†æçš„åŸºæœ¬è¡Œä¸ºå°±æ˜¯åˆ†æå¯¹è±¡åŠ¨æ€ä½œç”¨åŸŸï¼š</p><ul><li><strong>å½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œå¯¹è±¡åªåœ¨æ–¹æ³•å†…éƒ¨ä½¿ç”¨ï¼Œåˆ™è®¤ä¸ºæ²¡æœ‰å‘ç”Ÿé€ƒé€¸ã€‚</strong></li><li><strong>å½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œå®ƒè¢«å¤–éƒ¨æ–¹æ³•æ‰€å¼•ç”¨ï¼Œåˆ™è®¤ä¸ºå‘ç”Ÿé€ƒé€¸ã€‚ä¾‹å¦‚ä½œä¸ºè°ƒç”¨å‚æ•°ä¼ é€’åˆ°å…¶ä»–åœ°æ–¹ä¸­ï¼Œç§°ä¸ºæ–¹æ³•é€ƒé€¸ã€‚</strong></li></ul><p>ä¾‹å¦‚ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">StringBuffer</span> <span class="token function">craeteStringBuffer</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> sb<span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>StringBuffer sb</code>æ˜¯ä¸€ä¸ªæ–¹æ³•å†…éƒ¨å˜é‡ï¼Œä¸Šè¿°ä»£ç ä¸­ç›´æ¥å°†sbè¿”å›ï¼Œè¿™æ ·è¿™ä¸ª StringBuffer æœ‰å¯èƒ½è¢«å…¶ä»–æ–¹æ³•æ‰€æ”¹å˜ï¼Œè¿™æ ·å®ƒçš„ä½œç”¨åŸŸå°±ä¸åªæ˜¯åœ¨æ–¹æ³•å†…éƒ¨ï¼Œè™½ç„¶å®ƒæ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œä½†æ˜¯å…¶é€ƒé€¸åˆ°äº†æ–¹æ³•å¤–éƒ¨ã€‚ç”šè‡³è¿˜æœ‰å¯èƒ½è¢«å¤–éƒ¨çº¿ç¨‹è®¿é—®åˆ°ï¼Œè­¬å¦‚èµ‹å€¼ç»™ç±»å˜é‡æˆ–å¯ä»¥åœ¨å…¶ä»–çº¿ç¨‹ä¸­è®¿é—®çš„å®ä¾‹å˜é‡ï¼Œç§°ä¸ºçº¿ç¨‹é€ƒé€¸ã€‚</p><p>ä¸Šè¿°ä»£ç å¦‚æœæƒ³è¦ <code>StringBuffer sb</code>ä¸é€ƒå‡ºæ–¹æ³•ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createStringBuffer</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ç›´æ¥è¿”å› StringBufferï¼Œé‚£ä¹ˆ StringBuffer å°†ä¸ä¼šé€ƒé€¸å‡ºæ–¹æ³•ã€‚</p><p><strong>å‚æ•°è®¾ç½®ï¼š</strong></p><ul><li>åœ¨ JDK 6u23 ç‰ˆæœ¬ä¹‹åï¼ŒHotSpot ä¸­é»˜è®¤å°±å·²ç»å¼€å¯äº†é€ƒé€¸åˆ†æ</li><li>å¦‚æœä½¿ç”¨è¾ƒæ—©ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡<code>-XX&quot;+DoEscapeAnalysis</code>æ˜¾å¼å¼€å¯</li></ul><p>å¼€å‘ä¸­ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œå°±ä¸è¦åœ¨æ–¹æ³•å¤–å®šä¹‰ã€‚</p><h5 id="ä½¿ç”¨é€ƒé€¸åˆ†æ-ç¼–è¯‘å™¨å¯ä»¥å¯¹ä»£ç åšä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨é€ƒé€¸åˆ†æ-ç¼–è¯‘å™¨å¯ä»¥å¯¹ä»£ç åšä¼˜åŒ–" aria-hidden="true">#</a> <strong>ä½¿ç”¨é€ƒé€¸åˆ†æï¼Œç¼–è¯‘å™¨å¯ä»¥å¯¹ä»£ç åšä¼˜åŒ–ï¼š</strong></h5><p>**åŸºäºé€ƒé€¸åˆ†æï¼š**<strong>é€ƒé€¸åˆ†ææ˜¯ä»¥ä¸‹ä¸‰ä¸ªæ“ä½œçš„å¤§å‰æ</strong></p><p><strong>å¯¹æœªå‘ç”Ÿé€ƒé€¸çš„å¯¹è±¡ï¼š</strong></p><p><strong>æ ˆä¸Šåˆ†é…</strong> å³åˆ†é…åˆ°æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ä¸­ï¼ˆå±€éƒ¨å˜é‡è¡¨ä¸­åªå­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠå¯¹è±¡çš„å¼•ç”¨ï¼‰ï¼›</p><p>å› æ­¤è¦å¯¹æœªå‘ç”Ÿé€ƒé€¸çš„å¯¹è±¡è¿›è¡Œ<strong>æ ‡é‡æ›¿æ¢</strong>å°†<strong>èšåˆé‡ï¼ˆå¯¹è±¡ï¼‰æ‰“æ•£æˆæ ‡é‡ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠå¯¹è±¡çš„å¼•ç”¨ï¼‰</strong></p><ul><li><strong>æ ˆä¸Šåˆ†é…</strong>ï¼šå°†å †åˆ†é…è½¬åŒ–ä¸ºæ ˆåˆ†é…ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨å­ç¨‹åºä¸­è¢«åˆ†é…ï¼Œè¦ä½¿æŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆæ°¸è¿œä¸ä¼šé€ƒé€¸ï¼Œå¯¹è±¡å¯èƒ½æ˜¯æ ˆåˆ†é…çš„å€™é€‰ï¼Œè€Œä¸æ˜¯å †åˆ†é…</li><li><strong>åŒæ­¥çœç•¥</strong>ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡è¢«å‘ç°åªèƒ½ä»ä¸€ä¸ªçº¿ç¨‹è¢«è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªå¯¹è±¡çš„æ“ä½œå¯ä»¥ä¸è€ƒè™‘åŒæ­¥</li><li><strong>åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢</strong>ï¼šæœ‰çš„å¯¹è±¡å¯èƒ½ä¸éœ€è¦ä½œä¸ºä¸€ä¸ªè¿ç»­çš„å†…å­˜ç»“æ„å­˜åœ¨ä¹Ÿå¯ä»¥è¢«è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå¯¹è±¡çš„éƒ¨åˆ†ï¼ˆæˆ–å…¨éƒ¨ï¼‰å¯ä»¥ä¸å­˜å‚¨åœ¨å†…å­˜ï¼Œè€Œå­˜å‚¨åœ¨ CPU å¯„å­˜å™¨ï¼ˆJavaçš„Hotspotä¸­çš„æ ˆï¼‰--<strong>æ ‡é‡æ›¿æ¢å¯ä»¥è§†ä¸ºæ ˆä¸Šåˆ†é…çš„ä¸€ç§ç‰¹ä¾‹</strong>ï¼›</li></ul><p>JIT ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´æ ¹æ®é€ƒé€¸åˆ†æçš„ç»“æœï¼Œå‘ç°å¦‚æœä¸€ä¸ªå¯¹è±¡å¹¶æ²¡æœ‰é€ƒé€¸å‡ºæ–¹æ³•çš„è¯ï¼Œå°±å¯èƒ½è¢«ä¼˜åŒ–æˆæ ˆä¸Šåˆ†é…ã€‚åˆ†é…å®Œæˆåï¼Œç»§ç»­åœ¨è°ƒç”¨æ ˆå†…æ‰§è¡Œï¼Œæœ€åçº¿ç¨‹ç»“æŸï¼Œæ ˆç©ºé—´è¢«å›æ”¶ï¼Œå±€éƒ¨å˜é‡å¯¹è±¡ä¹Ÿè¢«å›æ”¶ã€‚è¿™æ ·å°±æ— éœ€è¿›è¡Œåƒåœ¾å›æ”¶äº†ã€‚</p><p>å¸¸è§æ ˆä¸Šåˆ†é…çš„åœºæ™¯ï¼šæˆå‘˜å˜é‡èµ‹å€¼ã€æ–¹æ³•è¿”å›å€¼ã€å®ä¾‹å¼•ç”¨ä¼ é€’</p><p><strong>ä»£ç ä¼˜åŒ–ä¹‹åŒæ­¥çœç•¥ï¼ˆé”æ¶ˆé™¤ï¼‰</strong></p><ul><li>çº¿ç¨‹åŒæ­¥çš„ä»£ä»·æ˜¯ç›¸å½“é«˜çš„ï¼ŒåŒæ­¥çš„åæœæ˜¯é™ä½å¹¶å‘æ€§å’Œæ€§èƒ½</li><li>åœ¨åŠ¨æ€ç¼–è¯‘åŒæ­¥å—çš„æ—¶å€™ï¼ŒJIT ç¼–è¯‘å™¨å¯ä»¥å€ŸåŠ©é€ƒé€¸åˆ†ææ¥åˆ¤æ–­åŒæ­¥å—æ‰€ä½¿ç”¨çš„é”å¯¹è±¡æ˜¯å¦èƒ½å¤Ÿè¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®è€Œæ²¡æœ‰è¢«å‘å¸ƒåˆ°å…¶ä»–çº¿ç¨‹ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆ JIT ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿™ä¸ªåŒæ­¥å—çš„æ—¶å€™å°±ä¼šå–æ¶ˆå¯¹è¿™ä¸ªä»£ç çš„åŒæ­¥ã€‚è¿™æ ·å°±èƒ½å¤§å¤§æé«˜å¹¶å‘æ€§å’Œæ€§èƒ½ã€‚è¿™ä¸ªå–æ¶ˆåŒæ­¥çš„è¿‡ç¨‹å°±å«åš<strong>åŒæ­¥çœç•¥ï¼Œä¹Ÿå«é”æ¶ˆé™¤</strong>ã€‚</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">keep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Object</span> keeper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">synchronized</span><span class="token punctuation">(</span>keeper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>keeper<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚ä¸Šä»£ç ï¼Œä»£ç ä¸­å¯¹ keeper è¿™ä¸ªå¯¹è±¡è¿›è¡ŒåŠ é”ï¼Œä½†æ˜¯ keeper å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåªåœ¨ <code>keep()</code>æ–¹æ³•ä¸­ï¼Œå¹¶ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æ‰€è®¿é—®åˆ°ï¼Œæ‰€ä»¥åœ¨ JITç¼–è¯‘é˜¶æ®µå°±ä¼šè¢«ä¼˜åŒ–æ‰ã€‚ä¼˜åŒ–æˆï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">keep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Object</span> keeper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>keeper<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä»£ç ä¼˜åŒ–ä¹‹æ ‡é‡æ›¿æ¢</strong></p><p><strong>æ ‡é‡</strong>ï¼ˆScalarï¼‰æ˜¯æŒ‡ä¸€ä¸ªæ— æ³•å†åˆ†è§£æˆæ›´å°çš„æ•°æ®çš„æ•°æ®ã€‚Java ä¸­çš„åŸå§‹æ•°æ®ç±»å‹å°±æ˜¯æ ‡é‡ã€‚</p><p>ç›¸å¯¹çš„ï¼Œé‚£äº›çš„è¿˜å¯ä»¥åˆ†è§£çš„æ•°æ®å«åš<strong>èšåˆé‡</strong>ï¼ˆAggregateï¼‰ï¼ŒJava ä¸­çš„å¯¹è±¡å°±æ˜¯èšåˆé‡ï¼Œå› ä¸ºå…¶è¿˜å¯ä»¥åˆ†è§£æˆå…¶ä»–èšåˆé‡å’Œæ ‡é‡ã€‚</p><p>åœ¨ JIT é˜¶æ®µï¼Œé€šè¿‡é€ƒé€¸åˆ†æç¡®å®šè¯¥å¯¹è±¡ä¸ä¼šè¢«å¤–éƒ¨è®¿é—®ï¼Œå¹¶ä¸”å¯¹è±¡å¯ä»¥è¢«è¿›ä¸€æ­¥åˆ†è§£æ—¶ï¼ŒJVM ä¸ä¼šåˆ›å»ºè¯¥å¯¹è±¡ï¼Œè€Œä¼šå°†è¯¥å¯¹è±¡æˆå‘˜å˜é‡åˆ†è§£è‹¥å¹²ä¸ªè¢«è¿™ä¸ªæ–¹æ³•ä½¿ç”¨çš„æˆå‘˜å˜é‡æ‰€ä»£æ›¿ã€‚è¿™äº›ä»£æ›¿çš„æˆå‘˜å˜é‡åœ¨æ ˆå¸§æˆ–å¯„å­˜å™¨ï¼ˆJavaçš„Hotspotä¸­çš„æ ˆï¼‰ä¸Šåˆ†é…ç©ºé—´ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯<strong>æ ‡é‡æ›¿æ¢</strong>ã€‚</p><p>é€šè¿‡ <code>-XX:+EliminateAllocations</code> å¯ä»¥å¼€å¯æ ‡é‡æ›¿æ¢ï¼Œ<code>-XX:+PrintEliminateAllocations</code> æŸ¥çœ‹æ ‡é‡æ›¿æ¢æƒ…å†µã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token class-name">Point</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span>ï¼ˆ<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span>ï¼‰<span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;point.x=&quot;</span><span class="token operator">+</span>point<span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token string">&quot;; point.y=&quot;</span><span class="token operator">+</span>point<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> x<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>     
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç ä¸­ï¼Œpoint å¯¹è±¡å¹¶æ²¡æœ‰é€ƒé€¸å‡º <code>alloc()</code> æ–¹æ³•ï¼Œå¹¶ä¸” point å¯¹è±¡æ˜¯å¯ä»¥æ‹†è§£æˆæ ‡é‡çš„ã€‚é‚£ä¹ˆï¼ŒJIT å°±ä¸ä¼šç›´æ¥åˆ›å»º Point å¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ä¸¤ä¸ªæ ‡é‡ int x ï¼Œint y æ¥æ›¿ä»£ Point å¯¹è±¡ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;point.x=&quot;</span><span class="token operator">+</span>x<span class="token operator">+</span><span class="token string">&quot;; point.y=&quot;</span><span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>      
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä»£ç ä¼˜åŒ–ä¹‹æ ˆä¸Šåˆ†é…</strong></p><p>æˆ‘ä»¬é€šè¿‡ JVM å†…å­˜åˆ†é…å¯ä»¥çŸ¥é“ JAVA ä¸­çš„å¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸Šè¿›è¡Œåˆ†é…ï¼Œå½“å¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™ï¼Œéœ€è¦ä¾é  GC è¿›è¡Œå›æ”¶å†…å­˜ï¼Œå¦‚æœå¯¹è±¡æ•°é‡è¾ƒå¤šçš„æ—¶å€™ï¼Œä¼šç»™ GC å¸¦æ¥è¾ƒå¤§å‹åŠ›ï¼Œä¹Ÿé—´æ¥å½±å“äº†åº”ç”¨çš„æ€§èƒ½ã€‚ä¸ºäº†å‡å°‘ä¸´æ—¶å¯¹è±¡åœ¨å †å†…åˆ†é…çš„æ•°é‡ï¼ŒJVM é€šè¿‡é€ƒé€¸åˆ†æç¡®å®šè¯¥å¯¹è±¡ä¸ä¼šè¢«å¤–éƒ¨è®¿é—®ã€‚é‚£å°±é€šè¿‡æ ‡é‡æ›¿æ¢å°†è¯¥å¯¹è±¡åˆ†è§£åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œè¿™æ ·è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å°±å¯ä»¥éšæ ˆå¸§å‡ºæ ˆè€Œé”€æ¯ï¼Œå°±å‡è½»äº†åƒåœ¾å›æ”¶çš„å‹åŠ›ã€‚</p><h5 id="é€ƒé€¸åˆ†ææ€»ç»“" tabindex="-1"><a class="header-anchor" href="#é€ƒé€¸åˆ†ææ€»ç»“" aria-hidden="true">#</a> <strong>é€ƒé€¸åˆ†ææ€»ç»“ï¼š</strong></h5><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927164103083.png" alt="image-20220927164103083"></p><p>å…³äºé€ƒé€¸åˆ†æçš„è®ºæ–‡åœ¨1999å¹´å°±å·²ç»å‘è¡¨äº†ï¼Œä½†ç›´åˆ°JDK 1.6æ‰æœ‰å®ç°ï¼Œè€Œä¸”è¿™é¡¹æŠ€æœ¯åˆ°å¦‚ä»Šä¹Ÿå¹¶ä¸æ˜¯ååˆ†æˆç†Ÿçš„ã€‚</p><p><strong>å…¶æ ¹æœ¬åŸå› å°±æ˜¯æ— æ³•ä¿è¯é€ƒé€¸åˆ†æçš„æ€§èƒ½æ¶ˆè€—ä¸€å®šèƒ½é«˜äºä»–çš„æ¶ˆè€—ã€‚è™½ç„¶ç»è¿‡é€ƒé€¸åˆ†æå¯ä»¥åšæ ‡é‡æ›¿æ¢ã€æ ˆä¸Šåˆ†é…ã€å’Œé”æ¶ˆé™¤ã€‚ä½†æ˜¯é€ƒé€¸åˆ†æè‡ªèº«ä¹Ÿæ˜¯éœ€è¦è¿›è¡Œä¸€ç³»åˆ—å¤æ‚çš„åˆ†æçš„ï¼Œè¿™å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªç›¸å¯¹è€—æ—¶çš„è¿‡ç¨‹ã€‚</strong></p><p>ä¸€ä¸ªæç«¯çš„ä¾‹å­ï¼Œå°±æ˜¯ç»è¿‡é€ƒé€¸åˆ†æä¹‹åï¼Œå‘ç°æ²¡æœ‰ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸é€ƒé€¸çš„ã€‚é‚£è¿™ä¸ªé€ƒé€¸åˆ†æçš„è¿‡ç¨‹å°±ç™½ç™½æµªè´¹æ‰äº†ã€‚</p><p>è™½ç„¶è¿™é¡¹æŠ€æœ¯å¹¶ä¸ååˆ†æˆç†Ÿï¼Œä½†æ˜¯ä»–ä¹Ÿæ˜¯å³æ—¶ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯ä¸­ä¸€ä¸ªååˆ†é‡è¦çš„æ‰‹æ®µã€‚</p><h3 id="æ–¹æ³•åŒº-method-area" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•åŒº-method-area" aria-hidden="true">#</a> æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰</h3><h4 id="æ–¹æ³•åŒºçš„ç†è§£" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•åŒºçš„ç†è§£" aria-hidden="true">#</a> æ–¹æ³•åŒºçš„ç†è§£</h4><p><strong>æ–¹æ³•åŒºæ˜¯ä¸€ç§è§„èŒƒ</strong> ä¸ç”¨çš„JVMç‰ˆæœ¬çš„æ–¹æ³•åŒºçš„</p><p><strong>å…·ä½“å®ç°ä¸åŒ</strong></p><p>æ¯”å¦‚<strong>JDK8ä»¥å‰çš„æ°¸ä¹…ä»£</strong>ä»¥åŠ<strong>JDK8ä»¥æ¥çš„å…ƒç©ºé—´</strong></p><p>è™½ç„¶ Java è™šæ‹Ÿæœºè§„èŒƒæŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒå´æœ‰ä¸€ä¸ªåˆ«åå«åš <strong>Non-Heapï¼ˆéå †ï¼‰</strong>ï¼Œç›®çš„åº”è¯¥æ˜¯ä¸ Java å †åŒºåˆ†å¼€æ¥ã€‚æ‰€ä»¥ï¼Œæ–¹æ³•åŒºå¯ä»¥çœ‹ä½œæ˜¯ä¸€å—<strong>ç‹¬ç«‹</strong>äº Java å †çš„å†…å­˜ç©ºé—´ã€‚</p><p>æ–¹æ³•åŒºä¸ Java å †ä¸€æ ·ï¼Œæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸã€‚æ–¹æ³•åŒºåœ¨ JVM å¯åŠ¨æ—¶å°±ä¼šè¢«åˆ›å»ºï¼Œå¹¶ä¸”å®ƒçš„å®é™…çš„ç‰©ç†å†…å­˜ç©ºé—´æ˜¯å¯ä»¥<strong>ä¸è¿ç»­</strong>çš„ï¼Œå…³é—­ JVM å°±ä¼šé‡Šæ”¾è¿™ä¸ªåŒºåŸŸçš„å†…å­˜</p><p>æ–¹æ³•åŒºæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„å†…å­˜ï¼Œåœ¨java8ä»¥å‰æ˜¯æ”¾åœ¨JVMå†…å­˜ä¸­çš„ï¼Œç”±æ°¸ä¹…ä»£å®ç°ï¼Œå—JVMå†…å­˜å¤§å°å‚æ•°çš„é™åˆ¶ï¼Œåœ¨java8ä¸­ç§»é™¤äº†æ°¸ä¹…ä»£çš„å†…å®¹ï¼Œæ–¹æ³•åŒºç”±å…ƒç©ºé—´(Meta Space)å®ç°ï¼Œå¹¶ç›´æ¥æ”¾åˆ°äº†æœ¬åœ°å†…å­˜ä¸­ï¼Œä¸å—JVMå‚æ•°çš„é™åˆ¶ï¼ˆå½“ç„¶ï¼Œå¦‚æœç‰©ç†å†…å­˜è¢«å æ»¡äº†ï¼Œæ–¹æ³•åŒºä¹Ÿä¼šæŠ¥OOMï¼‰ï¼Œå¹¶ä¸”å°†åŸæ¥æ”¾åœ¨æ–¹æ³•åŒºçš„å­—ç¬¦ä¸²å¸¸é‡æ± å’Œé™æ€å˜é‡éƒ½è½¬ç§»åˆ°äº†Javaå †ä¸­</p><h4 id="æ–¹æ³•åŒºåœ¨-jdk6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•åŒºåœ¨-jdk6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚" aria-hidden="true">#</a> æ–¹æ³•åŒºåœ¨ JDK6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚</h4><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024232451041.png" alt="image-20221024232451041"></p><h4 id="ä¸ºä»€ä¹ˆè¦å»æ°¸ä¹…ä»£" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦å»æ°¸ä¹…ä»£" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆè¦å»æ°¸ä¹…ä»£</h4><p><strong>åˆå¹¶HotSpotå’ŒJRockit--ä¸ºäº†å…¼å®¹JRocketè™šæ‹Ÿæœºï¼ˆæ— æ°¸ä¹…ä»£æ¦‚å¿µï¼‰</strong></p><p>JRockitä»æ¥æ²¡æœ‰æ‰€è°“çš„æ°¸ä¹…ä»£ï¼Œä¹Ÿä¸éœ€è¦å¼€å‘è¿ç»´äººå‘˜è®¾ç½®æ°¸ä¹…ä»£çš„å¤§å°ï¼Œä½†æ˜¯è¿è¡Œè‰¯å¥½ã€‚åŒæ—¶ä¹Ÿä¸ç”¨æ‹…å¿ƒè¿è¡Œæ€§èƒ½é—®é¢˜äº†,åœ¨è¦†ç›–åˆ°çš„æµ‹è¯•ä¸­, ç¨‹åºå¯åŠ¨å’Œè¿è¡Œé€Ÿåº¦é™ä½ä¸è¶…è¿‡1%ï¼Œä½†æ˜¯è¿™ç‚¹æ€§èƒ½æŸå¤±æ¢æ¥äº†æ›´å¤§çš„å®‰å…¨ä¿éšœ</p><p><strong>ä¸ºæ°¸ä¹…ä»£è®¾ç½®ç©ºé—´å¤§å°æ˜¯å¾ˆéš¾ç¡®å®šçš„ã€‚</strong></p><p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå¦‚æœåŠ¨æ€åŠ è½½ç±»è¿‡å¤šï¼Œå®¹æ˜“äº§ç”Ÿ Perm åŒºçš„ OOMã€‚å¦‚æœæŸä¸ªå®é™… Web å·¥ç¨‹ä¸­ï¼Œå› ä¸ºåŠŸèƒ½ç‚¹æ¯”è¾ƒå¤šï¼Œåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¦ä¸æ–­åŠ¨æ€åŠ è½½å¾ˆå¤šç±»ï¼Œç»å¸¸å‡ºç° OOMã€‚è€Œå…ƒç©ºé—´å’Œæ°¸ä¹…ä»£æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œå…ƒç©ºé—´ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œæ‰€ä»¥é»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç©ºé—´çš„å¤§å°ä»…å—æœ¬åœ°å†…å­˜é™åˆ¶</p><p><strong>å¯¹æ°¸ä¹…ä»£è¿›è¡Œè°ƒä¼˜è¾ƒå›°éš¾</strong></p><h4 id="stringtable-ä¸ºä»€ä¹ˆè¦è°ƒæ•´" tabindex="-1"><a class="header-anchor" href="#stringtable-ä¸ºä»€ä¹ˆè¦è°ƒæ•´" aria-hidden="true">#</a> <strong>StringTable ä¸ºä»€ä¹ˆè¦è°ƒæ•´</strong></h4><p>å› ä¸º<strong>æ°¸ä¹…ä»£çš„å›æ”¶æ•ˆç‡å¾ˆä½</strong>ï¼Œåœ¨ <strong>full gc çš„æ—¶å€™æ‰ä¼šè§¦å‘</strong>ã€‚è€Œ full GC æ˜¯è€å¹´ä»£çš„ç©ºé—´ä¸è¶³ã€æ°¸ä¹…ä»£ä¸è¶³æ—¶æ‰ä¼šè§¦å‘ã€‚è¿™å°±<strong>å¯¼è‡´äº†<code>StringTable</code> å›æ”¶æ•ˆç‡ä¸é«˜</strong>ã€‚è€Œæˆ‘ä»¬å¼€å‘ä¸­ä¼šæœ‰å¤§é‡çš„å­—ç¬¦ä¸²è¢«åˆ›å»ºï¼Œå›æ”¶æ•ˆç‡ä½ï¼Œå¯¼è‡´æ°¸ä¹…ä»£å†…å­˜ä¸è¶³ã€‚<strong>æ”¾åˆ°å †é‡Œï¼Œèƒ½åŠæ—¶å›æ”¶å†…å­˜</strong></p><h4 id="æ–¹æ³•åŒº-method-area-çš„å†…éƒ¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•åŒº-method-area-çš„å†…éƒ¨ç»“æ„" aria-hidden="true">#</a> æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰çš„å†…éƒ¨ç»“æ„</h4><p>æ–¹æ³•åŒºç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„<strong>ç±»ä¿¡æ¯</strong>ã€<strong>å¸¸é‡</strong>ã€<strong>é™æ€å˜é‡</strong>ã€<strong>å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç¼“å­˜</strong>ç­‰</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024233701796.png" alt="image-20221024233701796"></p><p><strong>ç±»å‹ä¿¡æ¯</strong></p><p>å¯¹æ¯ä¸ªåŠ è½½çš„ç±»å‹ï¼ˆ ç±» classã€æ¥å£ interfaceã€æšä¸¾ enumã€æ³¨è§£ annotationï¼‰ï¼ŒJVM å¿…é¡»åœ¨æ–¹æ³•åŒºä¸­å­˜å‚¨ä»¥ä¸‹ç±»å‹ä¿¡æ¯ï¼š</p><ol><li>è¿™ä¸ªç±»å‹çš„å®Œæ•´æœ‰æ•ˆåç§°ï¼ˆå…¨å=åŒ…å.ç±»åï¼‰</li><li>è¿™ä¸ªç±»å‹ç›´æ¥çˆ¶ç±»çš„å®Œæ•´æœ‰æ•ˆåï¼ˆå¯¹äº interface æˆ–æ˜¯ java. lang.Object ï¼Œéƒ½æ²¡æœ‰çˆ¶ç±»ï¼‰</li><li>è¿™ä¸ªç±»å‹çš„ä¿®é¥°ç¬¦ï¼ˆ public ï¼Œ abstractï¼Œ final çš„æŸä¸ªå­é›†ï¼‰</li><li>è¿™ä¸ªç±»å‹ç›´æ¥æ¥å£çš„ä¸€ä¸ªæœ‰åºåˆ—è¡¨</li></ol><p><strong>åŸŸï¼ˆFieldï¼‰ä¿¡æ¯</strong></p><ul><li>JVMå¿…é¡»åœ¨æ–¹æ³•åŒºä¸­ä¿å­˜ç±»å‹çš„æ‰€æœ‰åŸŸï¼ˆfieldï¼Œä¹Ÿç§°ä¸ºå±æ€§ï¼‰çš„ç›¸å…³ä¿¡æ¯ä»¥åŠåŸŸçš„å£°æ˜é¡ºåºï¼›</li><li>åŸŸçš„ç›¸å…³ä¿¡æ¯åŒ…æ‹¬ï¼šåŸŸåç§°ã€ åŸŸç±»å‹ã€åŸŸä¿®é¥°ç¬¦ï¼ˆpublicï¼Œ privateï¼Œprotectedï¼Œ staticï¼Œ finalï¼Œ volatileï¼Œ transient çš„æŸä¸ªå­é›†ï¼‰</li></ul><p><strong>æ–¹æ³•ï¼ˆMethodï¼‰ä¿¡æ¯</strong></p><p>JVM å¿…é¡»ä¿å­˜æ‰€æœ‰æ–¹æ³•çš„ä»¥ä¸‹ä¿¡æ¯ï¼ŒåŒåŸŸä¿¡æ¯ä¸€æ ·åŒ…æ‹¬å£°æ˜é¡ºåºï¼š</p><ul><li>æ–¹æ³•åç§°</li><li>æ–¹æ³•çš„è¿”å›ç±»å‹ï¼ˆæˆ–voidï¼‰</li><li>æ–¹æ³•å‚æ•°çš„æ•°é‡å’Œç±»å‹ï¼ˆæŒ‰é¡ºåºï¼‰</li><li>æ–¹æ³•çš„ä¿®é¥°ç¬¦ï¼ˆpublicï¼Œ privateï¼Œ protectedï¼Œ staticï¼Œ finalï¼Œsynchronizedï¼Œ native ï¼Œ abstract çš„ä¸€ä¸ªå­é›†ï¼‰</li><li>æ–¹æ³•çš„å­—èŠ‚ç ï¼ˆbytecodesï¼‰ã€æ“ä½œæ•°æ ˆã€å±€éƒ¨å˜é‡è¡¨åŠå¤§å°ï¼ˆ abstract å’Œ native æ–¹æ³•é™¤å¤–ï¼‰</li><li>å¼‚å¸¸è¡¨ï¼ˆ abstract å’Œ native æ–¹æ³•é™¤å¤–ï¼‰æ¯ä¸ªå¼‚å¸¸å¤„ç†çš„å¼€å§‹ä½ç½®ã€ç»“æŸä½ç½®ã€ä»£ç å¤„ç†åœ¨ç¨‹åºè®¡æ•°å™¨ä¸­çš„åç§»åœ°å€ã€è¢«æ•è·çš„å¼‚å¸¸ç±»çš„å¸¸é‡æ± ç´¢å¼•</li></ul><p><strong>è¿è¡Œæ—¶å¸¸é‡æ± </strong></p><ul><li>åœ¨åŠ è½½ç±»å’Œç»“æ„åˆ°è™šæ‹Ÿæœºåï¼Œå°±ä¼šåˆ›å»ºå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± </li><li>å¸¸é‡æ± è¡¨ï¼ˆConstant Pool Tableï¼‰æ˜¯ Class æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå­˜å‚¨ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œ<strong>è¿™éƒ¨åˆ†å†…å®¹å°†åœ¨ç±»åŠ è½½åå­˜æ”¾åˆ°æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­</strong></li><li>JVM ä¸ºæ¯ä¸ªå·²åŠ è½½çš„ç±»å‹ï¼ˆç±»æˆ–æ¥å£ï¼‰éƒ½ç»´æŠ¤ä¸€ä¸ªå¸¸é‡æ± ã€‚æ± ä¸­çš„æ•°æ®é¡¹åƒæ•°ç»„é¡¹ä¸€æ ·ï¼Œæ˜¯é€šè¿‡ç´¢å¼•è®¿é—®çš„</li><li>è¿è¡Œæ—¶å¸¸é‡æ± ä¸­åŒ…å«å„ç§ä¸åŒçš„å¸¸é‡ï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨å°±å·²ç»æ˜ç¡®çš„æ•°å€¼å­—é¢é‡ï¼Œä¹ŸåŒ…æ‹¬åˆ°è¿è¡ŒæœŸè§£æåæ‰èƒ½å¤Ÿè·å¾—çš„æ–¹æ³•æˆ–å­—æ®µå¼•ç”¨ã€‚æ­¤æ—¶ä¸å†æ˜¯å¸¸é‡æ± ä¸­çš„ç¬¦å·åœ°å€äº†ï¼Œè¿™é‡Œæ¢ä¸ºçœŸå®åœ°å€ <ul><li>è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œç›¸å¯¹äº Class æ–‡ä»¶å¸¸é‡æ± çš„å¦ä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯ï¼š<strong>åŠ¨æ€æ€§</strong>ï¼ŒJava è¯­è¨€å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰ç¼–è¯‘æœŸé—´æ‰èƒ½äº§ç”Ÿï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯ä»¥å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­ï¼ŒString ç±»çš„ <code>intern()</code> æ–¹æ³•å°±æ˜¯è¿™æ ·çš„</li></ul></li><li>å½“åˆ›å»ºç±»æˆ–æ¥å£çš„è¿è¡Œæ—¶å¸¸é‡æ± æ—¶ï¼Œå¦‚æœæ„é€ è¿è¡Œæ—¶å¸¸é‡æ± æ‰€éœ€çš„å†…å­˜ç©ºé—´è¶…è¿‡äº†æ–¹æ³•åŒºæ‰€èƒ½æä¾›çš„æœ€å¤§å€¼ï¼Œåˆ™ JVM ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚</li></ul><p>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œç†è§£è¿è¡Œæ—¶å¸¸é‡æ± çš„è¯ï¼Œæˆ‘ä»¬å…ˆæ¥è¯´è¯´å­—èŠ‚ç æ–‡ä»¶ï¼ˆClass æ–‡ä»¶ï¼‰ä¸­çš„å¸¸é‡æ± ï¼ˆå¸¸é‡æ± è¡¨ï¼‰</p><p><strong>å¸¸é‡æ± </strong></p><p>ä¸€ä¸ªæœ‰æ•ˆçš„å­—èŠ‚ç æ–‡ä»¶ä¸­é™¤äº†åŒ…å«ç±»çš„ç‰ˆæœ¬ä¿¡æ¯ã€å­—æ®µã€æ–¹æ³•ä»¥åŠæ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜åŒ…å«ä¸€é¡¹ä¿¡æ¯é‚£å°±æ˜¯å¸¸é‡æ± è¡¨ï¼ˆConstant Pool Tableï¼‰ï¼ŒåŒ…å«å„ç§å­—é¢é‡å’Œå¯¹ç±»å‹ã€åŸŸå’Œæ–¹æ³•çš„ç¬¦å·å¼•ç”¨ã€‚</p><p>å¸¸é‡æ± å¯ä»¥çœ‹ä½œæ˜¯ä¸€å¼ è¡¨ï¼Œè™šæ‹ŸæœºæŒ‡ä»¤æ ¹æ®è¿™å¼ å¸¸é‡è¡¨æ‰¾åˆ°è¦æ‰§è¡Œçš„<strong>ç±»å</strong>ã€<strong>æ–¹æ³•å</strong>ã€<strong>å‚æ•°ç±»å‹</strong>ã€<strong>å­—é¢é‡ç­‰ç±»å‹</strong></p><h4 id="æ–¹æ³•åŒºçš„å…·ä½“å®ç°-å…·ä½“jvmç‰ˆæœ¬å…·ä½“åˆ†æ" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•åŒºçš„å…·ä½“å®ç°-å…·ä½“jvmç‰ˆæœ¬å…·ä½“åˆ†æ" aria-hidden="true">#</a> æ–¹æ³•åŒºçš„å…·ä½“å®ç°ï¼ˆå…·ä½“JVMç‰ˆæœ¬å…·ä½“åˆ†æï¼‰</h4><p><strong>JDK8</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024231619374.png" alt="image-20221024231619374"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221025000437132.png" alt="image-20221025000437132"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024235559325.png" alt="image-20221024235559325"></p><h4 id="æ–¹æ³•åŒºçš„å‚æ•°è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•åŒºçš„å‚æ•°è®¾ç½®" aria-hidden="true">#</a> æ–¹æ³•åŒºçš„å‚æ•°è®¾ç½®</h4><ul><li>æ°¸ä¹…ä»£ï¼šOutOfMemoryError:PermGen space</li><li>å…ƒç©ºé—´ï¼šOutOfMemoryError:Metaspace</li></ul><h5 id="jdk8ä»¥å‰" tabindex="-1"><a class="header-anchor" href="#jdk8ä»¥å‰" aria-hidden="true">#</a> JDK8ä»¥å‰</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token operator">-</span><span class="token constant">XX</span><span class="token operator">:</span><span class="token class-name">PermSize</span><span class="token operator">=</span><span class="token class-name">N</span> <span class="token comment">//æ–¹æ³•åŒº (æ°¸ä¹…ä»£) åˆå§‹åˆ†é…ç©ºé—´ï¼Œé»˜è®¤å€¼ä¸º 20.75M</span>
<span class="token operator">-</span><span class="token constant">XX</span><span class="token operator">:</span><span class="token class-name">MaxPermSize</span><span class="token operator">=</span><span class="token class-name">N</span> <span class="token comment">//æ–¹æ³•åŒº (æ°¸ä¹…ä»£) æœ€å¤§å¯åˆ†é…ç©ºé—´ã€‚32ä½æœºå™¨é»˜è®¤æ˜¯64Mï¼Œ64ä½æœºå™¨é»˜è®¤æ˜¯82M</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="jdk8ä»¥æ¥" tabindex="-1"><a class="header-anchor" href="#jdk8ä»¥æ¥" aria-hidden="true">#</a> JDK8ä»¥æ¥</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token operator">-</span><span class="token constant">XX</span><span class="token operator">:</span><span class="token class-name">MetaspaceSize</span><span class="token operator">=</span><span class="token class-name">N</span> <span class="token comment">//æ–¹æ³•åŒº (å…ƒç©ºé—´) åˆå§‹åˆ†é…ç©ºé—´ï¼Œå¦‚æœæœªæŒ‡å®šæ­¤æ ‡å¿—ï¼Œåˆ™å…ƒç©ºé—´å°†æ ¹æ®è¿è¡Œæ—¶çš„åº”ç”¨ç¨‹åºéœ€æ±‚åŠ¨æ€åœ°é‡æ–°è°ƒæ•´å¤§å°ã€‚</span>
<span class="token operator">-</span><span class="token constant">XX</span><span class="token operator">:</span><span class="token class-name">MaxMetaspaceSize</span><span class="token operator">=</span><span class="token class-name">N</span> <span class="token comment">//æ–¹æ³•åŒº (å…ƒç©ºé—´) æœ€å¤§å¯åˆ†é…ç©ºé—´ï¼Œé»˜è®¤å€¼ä¸º -1ï¼Œå³æ²¡æœ‰é™åˆ¶</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶" aria-hidden="true">#</a> æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶</h4><p>æ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†ä¸»è¦å›æ”¶ä¸¤éƒ¨åˆ†å†…å®¹ï¼š<strong>å¸¸é‡æ± ä¸­åºŸå¼ƒçš„å¸¸é‡å’Œä¸å†ä½¿ç”¨çš„ç±»å‹</strong>ã€‚</p><p>å…ˆæ¥è¯´è¯´æ–¹æ³•åŒºå†…å¸¸é‡æ± ä¹‹ä¸­ä¸»è¦å­˜æ”¾çš„ä¸¤å¤§ç±»å¸¸é‡ï¼šå­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚å­—é¢é‡æ¯”è¾ƒæ¥è¿‘ Java è¯­è¨€å±‚æ¬¡çš„å¸¸é‡æ¦‚å¿µï¼Œå¦‚æ–‡æœ¬å­—ç¬¦ä¸²ã€è¢«å£°æ˜ä¸º final çš„å¸¸é‡å€¼ç­‰ã€‚è€Œç¬¦å·å¼•ç”¨åˆ™å±äºç¼–è¯‘åŸç†æ–¹é¢çš„æ¦‚å¿µï¼ŒåŒ…æ‹¬ä¸‹é¢ä¸‰ç±»å¸¸é‡ï¼š</p><ul><li>ç±»å’Œæ¥å£çš„å…¨é™å®šå</li><li>å­—æ®µçš„åç§°å’Œæè¿°ç¬¦</li><li>æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦</li></ul><p>HotSpot è™šæ‹Ÿæœºå¯¹å¸¸é‡æ± çš„å›æ”¶ç­–ç•¥æ˜¯å¾ˆæ˜ç¡®çš„ï¼Œåªè¦å¸¸é‡æ± ä¸­çš„å¸¸é‡æ²¡æœ‰è¢«ä»»ä½•åœ°æ–¹å¼•ç”¨ï¼Œå°±å¯ä»¥è¢«å›æ”¶</p><p>åˆ¤å®šä¸€ä¸ªç±»å‹æ˜¯å¦å±äºâ€œä¸å†è¢«ä½¿ç”¨çš„ç±»â€ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š</p><ul><li>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»åŠå…¶ä»»ä½•æ´¾ç”Ÿå­ç±»çš„å®ä¾‹</li><li>åŠ è½½è¯¥ç±»çš„ç±»åŠ è½½å™¨å·²ç»è¢«å›æ”¶ï¼Œè¿™ä¸ªæ¡ä»¶é™¤éæ˜¯ç»è¿‡ç²¾å¿ƒè®¾è®¡çš„å¯æ›¿æ¢ç±»åŠ è½½å™¨çš„åœºæ™¯ï¼Œå¦‚ OSGiã€JSP çš„é‡åŠ è½½ç­‰ï¼Œå¦åˆ™é€šå¸¸å¾ˆéš¾è¾¾æˆ</li><li>è¯¥ç±»å¯¹åº”çš„ java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•</li></ul><p>Java è™šæ‹Ÿæœºè¢«å…è®¸å †æ»¡è¶³ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶çš„æ— ç”¨ç±»è¿›è¡Œå›æ”¶ï¼Œè¿™é‡Œè¯´çš„ä»…ä»…æ˜¯â€œè¢«å…è®¸â€ï¼Œè€Œå¹¶ä¸æ˜¯å’Œå¯¹è±¡ä¸€æ ·ï¼Œä¸ä½¿ç”¨äº†å°±å¿…ç„¶ä¼šå›æ”¶ã€‚æ˜¯å¦å¯¹ç±»è¿›è¡Œå›æ”¶ï¼ŒHotSpot è™šæ‹Ÿæœºæä¾›äº† <code>-Xnoclassgc</code> å‚æ•°è¿›è¡Œæ§åˆ¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>-verbose:class</code> ä»¥åŠ <code>-XX:+TraceClassLoading</code> ã€<code>-XX:+TraceClassUnLoading</code> æŸ¥çœ‹ç±»åŠ è½½å’Œå¸è½½ä¿¡æ¯ã€‚</p><p>åœ¨å¤§é‡ä½¿ç”¨åå°„ã€åŠ¨æ€ä»£ç†ã€CGLib ç­‰ ByteCode æ¡†æ¶ã€åŠ¨æ€ç”Ÿæˆ JSP ä»¥åŠ OSGi è¿™ç±»é¢‘ç¹è‡ªå®šä¹‰ ClassLoader çš„åœºæ™¯éƒ½éœ€è¦è™šæ‹Ÿæœºå…·å¤‡ç±»å¸è½½çš„åŠŸèƒ½ï¼Œä»¥ä¿è¯æ°¸ä¹…ä»£ä¸ä¼šæº¢å‡º</p><h2 id="java-object" tabindex="-1"><a class="header-anchor" href="#java-object" aria-hidden="true">#</a> Java Object</h2><p>==<strong>Every object has associated a monitor</strong>==</p><h3 id="åˆ›å»ºå¯¹è±¡çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºå¯¹è±¡çš„æ–¹å¼" aria-hidden="true">#</a> åˆ›å»ºå¯¹è±¡çš„æ–¹å¼</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024161545402.png" alt="image-20221024161545402"></p><h3 id="åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤" aria-hidden="true">#</a> åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024165832529.png" alt="image-20221024165832529"></p><p><strong>----åŠ è½½ç±»å…ƒä¿¡æ¯</strong></p><p><strong>----ä¸ºå¯¹è±¡åˆ†é…å†…å­˜</strong></p><p><strong>----å¤„ç†å¹¶å‘é—®é¢˜</strong></p><p><strong>----å±æ€§çš„é»˜è®¤åˆå§‹åŒ–ï¼ˆé›¶å€¼åˆå§‹åŒ–ï¼‰</strong></p><p><strong>----è®¾ç½®å¯¹è±¡å¤´ä¿¡æ¯</strong></p><p><strong>----init()æ–¹æ³•è¿›è¡Œåˆå§‹åŒ– æ˜¾ç¤ºåˆå§‹åŒ– ä»£ç å—ä¸­åˆå§‹åŒ– æ„é€ å™¨åˆå§‹åŒ–</strong></p><p>1.åˆ¤æ–­å¯¹è±¡å¯¹åº”çš„ç±»æ˜¯å¦å®ŒæˆåŠ è½½</p><p>è™šæ‹Ÿæœºåœ¨é‡åˆ°ä¸€æ¡newæŒ‡ä»¤ï¼Œé¦–å…ˆæ£€æŸ¥è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨MetaSpaceçš„å¸¸é‡æ± ä¸­å®šä½åˆ°ä¸€ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¹¶ä¸”æ£€æŸ¥è¿™ä¸ªç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½è§£æåˆå§‹åŒ–ï¼ˆå³åˆ¤æ–­ç±»å…ƒä¿¡æ¯æ˜¯å¦å­˜åœ¨ï¼‰ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆåœ¨åŒäº²å§”æ´¾æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨å½“å‰ç±»åŠ è½½å™¨ä»¥ClassLoader+åŒ…å+ç±»åï¼ˆå…¨ç±»åï¼‰ä¸ºkeyè¿›è¡ŒæŸ¥æ‰¾å¯¹åº”çš„.classæ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶ åˆ™ä¼šæŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸ã€‚å¦‚æœæ‰¾åˆ°ï¼Œåˆ™è¿›è¡Œç±»åŠ è½½ï¼Œå¹¶åœ¨å †ç©ºé—´ç”Ÿæˆå¯¹åº”çš„Classå¯¹è±¡</p><p>2.ä¸ºå¯¹è±¡åˆ†é…å†…å­˜</p><p>2.1å†…å­˜è§„æ•´--æŒ‡é’ˆç¢°æ’</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024171423090.png" alt="image-20221024171423090"></p><p>2.2å†…å­˜ä¸è§„æ•´</p><h3 id="å†…å­˜å¸ƒå±€" tabindex="-1"><a class="header-anchor" href="#å†…å­˜å¸ƒå±€" aria-hidden="true">#</a> å†…å­˜å¸ƒå±€</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024174142826.png" alt="image-20221024174142826"></p><p>ä¾‹å­</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024174859555.png" alt="image-20221024174859555"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024174521816.png" alt="image-20221024174521816"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221024174554702.png" alt="image-20221024174554702"></p><h3 id="è®¿é—®å®šä½" tabindex="-1"><a class="header-anchor" href="#è®¿é—®å®šä½" aria-hidden="true">#</a> è®¿é—®å®šä½</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221120140242580.png" alt="image-20221120140242580"></p><p>ä¸¤ç§æ–¹å¼</p><p><strong>ç›´æ¥å¼•ç”¨ï¼ˆHotspotè™šæ‹Ÿæœºé‡‡ç”¨ï¼‰</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221120140736479.png" alt="image-20221120140736479"></p><p>å¥æŸ„è®¿é—®</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20221120140810444.png" alt="image-20221120140810444"></p><h2 id="jvm-garbage-collection" tabindex="-1"><a class="header-anchor" href="#jvm-garbage-collection" aria-hidden="true">#</a> JVM Garbage Collection</h2><blockquote><p>Java ä¸­çš„åƒåœ¾å›æ”¶ï¼ˆGarbage Collectionï¼‰æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ï¼Œè¿™æ„å‘³ç€ç¨‹åºå‘˜ä¸å¿…æ‰‹åŠ¨ç®¡ç†å†…å­˜ã€‚Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰é€šè¿‡åƒåœ¾å›æ”¶å™¨ï¼ˆGarbage Collectorï¼‰è‡ªåŠ¨æ£€æµ‹å’Œæ¸…é™¤æ— ç”¨çš„å¯¹è±¡ï¼Œä»è€Œé‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºå¯ä»¥ç»§ç»­è¿è¡Œã€‚</p><p>ä¸»è¦æ˜¯åœ¨Heap Areaè¿›è¡Œ</p><p>åƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œè´Ÿè´£å›æ”¶ä¸å†è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚å½“åƒåœ¾å›æ”¶å™¨å‘ç°ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨æ—¶ï¼Œå®ƒä¼šå°†å…¶æ ‡è®°ä¸ºå¯å›æ”¶çš„ï¼Œç„¶åé‡Šæ”¾å…¶å ç”¨çš„å†…å­˜ç©ºé—´ã€‚</p></blockquote><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230402225441859.png" alt="image-20230402225441859"></p><h3 id="heap-area" tabindex="-1"><a class="header-anchor" href="#heap-area" aria-hidden="true">#</a> Heap Area</h3><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230131120051541.png" alt="image-20230131120051541"></p><h3 id="memory-allocation-strategy" tabindex="-1"><a class="header-anchor" href="#memory-allocation-strategy" aria-hidden="true">#</a> Memory allocation strategy</h3><blockquote><p>JavaæŠ€æœ¯ä½“ç³»çš„è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œæœ€æ ¹æœ¬çš„ç›®æ ‡æ˜¯è‡ªåŠ¨åŒ–åœ°è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼šè‡ªåŠ¨ç»™å¯¹è±¡åˆ†é…å†…å­˜ä»¥åŠè‡ªåŠ¨å›æ”¶åˆ†é…ç»™å¯¹è±¡çš„å†…å­˜ã€‚</p><ul><li><p><strong>å¯¹è±¡ä¼˜å…ˆåœ¨Edenå›­åŒºè¿›è¡Œåˆ†é…</strong></p><ul><li>Edenå›­åŒºæœ‰ä¸€å—å¾ˆå°çš„åŒºåŸŸTLABï¼šå½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼ŒJVMé¦–å…ˆä¸ºè¯¥çº¿ç¨‹åˆ†é…ä¸€ä¸ªTLABï¼Œå¹¶å°†è¯¥çº¿ç¨‹çš„TLABæŒ‡å‘EdenåŒºã€‚ç„¶åï¼Œè¯¥<strong>çº¿ç¨‹å¯ä»¥åœ¨è‡ªå·±çš„TLABä¸­åˆ†é…å¯¹è±¡ï¼Œæ— éœ€å’Œå…¶ä»–çº¿ç¨‹ç«äº‰EdenåŒºçš„ç©ºé—´ï¼Œè¿™æ ·å¯ä»¥å‡å°‘é”çš„äº‰ç”¨ï¼Œæé«˜å¯¹è±¡åˆ†é…æ•ˆç‡ã€‚</strong></li></ul></li><li><p><strong>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</strong></p></li><li><p><strong>è¶…è¿‡å¹´é¾„é˜ˆå€¼-XXï¼šMaxTenuringThresholdé»˜è®¤15çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£</strong></p></li><li><p><strong>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š</strong>å¦‚æœåœ¨Survivorç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivorç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£</p></li><li><p><strong>ç©ºé—´åˆ†é…æ‹…ä¿-XXï¼šHandlePromotionFailure</strong></p><p>æ£€æµ‹åˆ°è€å¹´ä»£çš„æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡çš„æ€»ç©ºé—´ï¼ˆæœ€åæƒ…å†µä¸‹æ–°ç”Ÿä»£çš„æ‰€æœ‰å¯¹è±¡éƒ½å­˜æ´»ä¸‹æ¥è¦æ™‹å‡åˆ°è€å¹´ä»£ï¼‰</p><p>æ£€æµ‹åˆ°è€å¹´ä»£çš„æœ€å¤§å¯ç”¨è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡çš„å¹³å‡å¤§å°ï¼ˆæŒ‰ç…§å¾€æ¬¡çš„æ™‹å‡ç»Ÿè®¡ï¼‰éƒ½ä¼šè¿›è¡ŒMinor GC å¦åˆ™è¿›è¡ŒFull GC</p></li></ul><p><strong>å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹ï¼š</strong></p><ol><li>é¦–å…ˆï¼Œå½“ç¨‹åºéœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼ŒJVMä¼šåœ¨å †åŒºä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´æ¥å­˜å‚¨è¯¥å¯¹è±¡ã€‚å¦‚æœæœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ï¼Œåˆ™è¿›è¡Œä¸‹ä¸€æ­¥ï¼›å¦åˆ™ï¼Œä¼šè§¦å‘åƒåœ¾æ”¶é›†å™¨æ¥å›æ”¶ä¸€äº›ä¸å†ä½¿ç”¨çš„å¯¹è±¡ï¼Œä»¥è…¾å‡ºè¶³å¤Ÿçš„å†…å­˜ç©ºé—´ã€‚</li><li>æ¥ä¸‹æ¥ï¼ŒJVMä¼šå°†è¯¥å¯¹è±¡æ‰€éœ€çš„å†…å­˜åˆ†é…ç»™å®ƒï¼Œæ­¤æ—¶è¿˜æœªåˆå§‹åŒ–è¯¥å¯¹è±¡çš„æˆå‘˜å˜é‡ã€‚</li><li>ç„¶åï¼ŒJVMä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„æ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–å…¶æˆå‘˜å˜é‡ã€‚</li><li>æœ€åï¼ŒJVMè¿”å›è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œä½¿ç¨‹åºå¯ä»¥é€šè¿‡è¯¥å¼•ç”¨æ¥æ“ä½œè¯¥å¯¹è±¡ã€‚</li></ol><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927114457272.png" alt="image-20220927114457272"></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927114247641.png" alt="image-20220927114247641"></p></blockquote><h3 id="minor-gc-major-gc-full-gc" tabindex="-1"><a class="header-anchor" href="#minor-gc-major-gc-full-gc" aria-hidden="true">#</a> Minor GCï¼ŒMajor GCï¼ŒFull GC</h3><blockquote><p>åœ¨ Java ä¸­ï¼ŒPartial GC å’Œ Full GC æ˜¯ä¸¤ç§ä¸åŒçš„åƒåœ¾å›æ”¶æ–¹å¼ã€‚</p><p>Partial GC</p><p>æ˜¯æŒ‡åªå¯¹ Java å †å†…å­˜çš„éƒ¨åˆ†åŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œæ¯”å¦‚åªå¯¹æ–°ç”Ÿä»£æˆ–è€å¹´ä»£è¿›è¡Œå›æ”¶ã€‚Partial GC é€šå¸¸å¯ä»¥åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šYoung GC å’Œ Old GCã€‚Young GCï¼ˆæˆ–ç§°ä¸º Minor GCï¼‰æ˜¯é’ˆå¯¹æ–°ç”Ÿä»£å†…å­˜åŒºåŸŸçš„åƒåœ¾å›æ”¶ï¼Œè€Œ Old GCï¼ˆæˆ–ç§°ä¸º Major GCï¼‰æ˜¯é’ˆå¯¹è€å¹´ä»£å†…å­˜åŒºåŸŸçš„åƒåœ¾å›æ”¶ã€‚åœ¨æ‰§è¡Œ Partial GC æ—¶ï¼Œåªæœ‰ç›¸åº”çš„å†…å­˜åŒºåŸŸä¼šè¢«å›æ”¶ï¼Œè€Œå…¶ä»–å†…å­˜åŒºåŸŸåˆ™ä¸ä¼šå—åˆ°å½±å“ã€‚å› æ­¤ï¼ŒPartial GC çš„æ‰§è¡Œæ—¶é—´é€šå¸¸æ¯” Full GC æ›´çŸ­ï¼Œå¹¶ä¸”ä¸ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºçš„æš‚åœã€‚</p><ul><li>Minor GC</li><li>Major GC</li><li>Mixed GCï¼ˆOnly G1ï¼‰</li></ul><p>Full GC</p><p>æ˜¯æŒ‡å¯¹æ•´ä¸ª Java å †å†…å­˜è¿›è¡Œåƒåœ¾å›æ”¶ï¼ŒåŒ…æ‹¬æ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚Full GC çš„æ‰§è¡Œæ—¶é—´é€šå¸¸æ¯” Partial GC æ›´é•¿ï¼Œå¹¶ä¸”éœ€è¦æš‚åœåº”ç”¨ç¨‹åºã€‚åœ¨ Full GC æ‰§è¡ŒæœŸé—´ï¼Œæ‰€æœ‰åº”ç”¨ç¨‹åºçº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ã€‚ç”±äº Full GC éœ€è¦æ‰«ææ•´ä¸ª Java å †å†…å­˜ï¼Œå› æ­¤å…¶æ‰§è¡Œæ—¶é—´å’Œé¢‘ç‡éƒ½åº”è¯¥å°½é‡é™ä½ï¼Œä»¥ä¿è¯åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</p></blockquote><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20220927124003012.png" alt="image-20220927124003012"></p><h3 id="trigger-conditions-for-gc" tabindex="-1"><a class="header-anchor" href="#trigger-conditions-for-gc" aria-hidden="true">#</a> Trigger conditions for GC</h3><blockquote><p>åœ¨ Java ä¸­ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šæ ¹æ®ä¸€å®šçš„ç­–ç•¥å’Œæ¡ä»¶æ¥è§¦å‘åƒåœ¾å›æ”¶ã€‚ä¸‹é¢åˆ—ä¸¾äº†ä¸€äº›è§¦å‘ GC çš„æƒ…å†µï¼š</p><ol><li>ç³»ç»Ÿç©ºé—²æ—¶ï¼šå½“ç³»ç»Ÿç©ºé—²æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨å¯èƒ½ä¼šè¢«è§¦å‘ä»¥å›æ”¶æ— ç”¨çš„å¯¹è±¡ï¼Œä»¥ä¾¿é‡Šæ”¾å†…å­˜ä¾›ç³»ç»Ÿä½¿ç”¨ã€‚</li><li>å†…å­˜ä¸è¶³æ—¶ï¼šå½“ JVM å‘ç°å½“å‰çš„å†…å­˜ä¸è¶³ä»¥æ”¯æŒç¨‹åºè¿è¡Œæ—¶ï¼Œåƒåœ¾å›æ”¶å™¨å¯èƒ½ä¼šè¢«è§¦å‘ä»¥å›æ”¶æ— ç”¨çš„å¯¹è±¡ï¼Œä»¥è…¾å‡ºæ›´å¤šçš„ç©ºé—´ã€‚</li><li>ç¨‹åºè°ƒç”¨ System.gc() æ–¹æ³•ï¼šç¨‹åºå¯ä»¥è°ƒç”¨ System ç±»çš„é™æ€æ–¹æ³• gc() æ¥è¯·æ±‚åƒåœ¾å›æ”¶å™¨ç«‹å³è¿è¡Œã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šè¯¥æ–¹æ³•åªæ˜¯å‘åƒåœ¾å›æ”¶å™¨å‘é€äº†ä¸€ä¸ªè¯·æ±‚ï¼Œåƒåœ¾å›æ”¶å™¨æ˜¯å¦ä¼šç«‹å³å›æ”¶å¯¹è±¡ï¼Œä»ç„¶ç”±åƒåœ¾å›æ”¶å™¨è‡ªè¡Œå†³å®šã€‚</li><li>ç¨‹åºè°ƒç”¨ Runtime.getRuntime().gc() æ–¹æ³•ï¼šä¸ System.gc() æ–¹æ³•ç±»ä¼¼ï¼Œç¨‹åºä¹Ÿå¯ä»¥è°ƒç”¨ Runtime ç±»çš„ gc() æ–¹æ³•æ¥è¯·æ±‚åƒåœ¾å›æ”¶å™¨ç«‹å³è¿è¡Œã€‚</li><li>å¯¹è±¡åˆ›å»ºæ—¶ï¼šAllocation Failure,åƒåœ¾å›æ”¶å™¨å¯èƒ½ä¼šè¢«è§¦å‘ä»¥å›æ”¶æ— ç”¨çš„å¯¹è±¡ã€‚ï¼ˆå¯¹è±¡æœ€åˆå…ˆåˆ†é…åˆ°EdenåŒº è‹¥åˆ†é…æ—¶Edenå›­åŒºæ»¡äº†å°±è§¦å‘MinorGCï¼‰</li><li>å¯¹è±¡å­˜æ´»æ—¶é—´ï¼šå½“ç¨‹åºä¸­çš„å¯¹è±¡å·²ç»å­˜åœ¨ä¸€å®šæ—¶é—´ï¼Œæˆ–è€…å¯¹è±¡è¾¾åˆ°äº†ä¸€å®šçš„å¹´é¾„ï¼ˆé˜ˆå€¼ï¼‰ï¼Œåƒåœ¾å›æ”¶å™¨å¯èƒ½ä¼šè¢«è§¦å‘ä»¥å›æ”¶æ— ç”¨çš„å¯¹è±¡ã€‚Survivor==&gt;OG</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ç¨‹åºå¯ä»¥é€šè¿‡è°ƒç”¨ System.gc() æˆ–è€… Runtime.getRuntime().gc() æ–¹æ³•æ¥è¯·æ±‚åƒåœ¾å›æ”¶å™¨ç«‹å³è¿è¡Œï¼Œä½†æ˜¯å®é™…ä¸Šåƒåœ¾å›æ”¶å™¨æ˜¯å¦ä¼šç«‹å³å›æ”¶å¯¹è±¡ï¼Œè¿˜æ˜¯ç”±åƒåœ¾å›æ”¶å™¨è‡ªè¡Œå†³å®šã€‚å› æ­¤ï¼Œåœ¨å¼€å‘ä¸­ï¼Œåº”è¯¥é¿å…è¿‡å¤šåœ°ä¾èµ–åƒåœ¾å›æ”¶å™¨çš„è¿è¡Œæ¥é‡Šæ”¾èµ„æºï¼Œè€Œæ˜¯è¦åˆç†åœ°ä½¿ç”¨å†…å­˜ï¼ŒåŠæ—¶é‡Šæ”¾ä¸å†éœ€è¦çš„å¯¹è±¡ï¼Œä»¥ä¿è¯ç¨‹åºçš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</p></blockquote><h3 id="garbage-collection-algorithm" tabindex="-1"><a class="header-anchor" href="#garbage-collection-algorithm" aria-hidden="true">#</a> Garbage collection algorithm</h3><blockquote><p>Java ä¸­çš„åƒåœ¾æ”¶é›†ç®—æ³•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><em><strong>æ ‡è®°-æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweep Algorithmï¼‰</strong></em></li></ul><p>æ ‡è®°-æ¸…é™¤ç®—æ³•æ˜¯æœ€ç®€å•ã€æœ€åŸºç¡€çš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚</p><p>å®ƒ<strong>åˆ†ä¸ºæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªé˜¶æ®µï¼š</strong></p><p>æ ‡è®°é˜¶æ®µä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œéå†æ‰€æœ‰å¯è¾¾å¯¹è±¡å¹¶æ‰“ä¸Šæ ‡è®°ï¼›</p><p>æ¸…é™¤é˜¶æ®µåˆ™ä»å¤´åˆ°å°¾éå†æ•´ä¸ªå †ç©ºé—´ï¼Œæ¸…é™¤æ‰€æœ‰æ²¡æœ‰æ ‡è®°çš„å¯¹è±¡ã€‚</p><p>è¿™ä¸ªç®—æ³•çš„<strong>ç¼ºç‚¹æ˜¯ä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜ç¢ç‰‡ï¼Œä»è€Œé™ä½å†…å­˜åˆ©ç”¨ç‡</strong>ã€‚</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230403001405673.png" alt="image-20230403001405673"></p><ul><li><em><strong>å¤åˆ¶ç®—æ³•ï¼ˆCopying Algorithmï¼‰</strong></em></li></ul><p>å¤åˆ¶ç®—æ³•å°†å †ç©ºé—´<strong>åˆ’åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªåŒºåŸŸ</strong>ã€‚å½“è¯¥åŒºåŸŸçš„å†…å­˜ç”¨å°½æ—¶ï¼Œå°†å…¶ä¸­å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€ä¸ªåŒºåŸŸä¸­ï¼Œç„¶åæ¸…ç©ºåŸæ¥çš„åŒºåŸŸã€‚</p><p>è¿™ç§ç®—æ³•å®ç°ç®€å•ï¼Œä¸ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œ</p><p>ä½†æ˜¯<strong>ä¼šæµªè´¹ä¸€åŠçš„å†…å­˜ç©ºé—´</strong>ã€‚</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230403001436434.png" alt="image-20230403001436434"></p><ul><li><em><strong>æ ‡è®°-æ•´ç†ç®—æ³•ï¼ˆMark-Compact Algorithmï¼‰</strong></em></li></ul><p>æ ‡è®°-æ•´ç†ç®—æ³•æ˜¯åœ¨æ ‡è®°-æ¸…é™¤ç®—æ³•çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›ä¼˜åŒ–ã€‚</p><p>å®ƒ<strong>åŒæ ·åˆ†ä¸ºæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªé˜¶æ®µ</strong>ï¼š</p><p>æ ‡è®°é˜¶æ®µéå†æ‰€æœ‰å¯è¾¾å¯¹è±¡å¹¶æ‰“ä¸Šæ ‡è®°ï¼›</p><p>æ¸…é™¤é˜¶æ®µå°†æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ç§»åŠ¨åˆ°å †çš„ä¸€ç«¯ï¼Œç„¶åæ¸…ç†æ‰å †ç©ºé—´çš„å¦ä¸€ç«¯ã€‚</p><p>è¿™ç§ç®—æ³•å¯ä»¥é¿å…å†…å­˜ç¢ç‰‡çš„äº§ç”Ÿï¼Œ</p><p>ä½†æ˜¯<strong>ç§»åŠ¨å­˜æ´»çš„å¯¹è±¡éœ€è¦è€—è´¹é¢å¤–çš„æ—¶é—´å’Œç©ºé—´</strong>ã€‚</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230403001416453.png" alt="image-20230403001416453"></p><ul><li><em><strong>åˆ†ä»£æ”¶é›†ç®—æ³•ï¼ˆGenerational Collection Algorithmï¼‰</strong></em></li></ul><p>åˆ†ä»£æ”¶é›†ç®—æ³•æ˜¯å½“å‰ Java åƒåœ¾å›æ”¶å™¨ä¸­<strong>æœ€å¸¸ç”¨çš„ç®—æ³•ä¹‹ä¸€</strong>ã€‚</p><p>å®ƒå°†å †ç©ºé—´åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸¤ä¸ªåŒºåŸŸï¼Œ</p><p>æ–°ç”Ÿä»£ä¸­å¤§å¤šæ•°å¯¹è±¡æ˜¯çŸ­æš‚çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å¤åˆ¶ç®—æ³•æ¥è¿›è¡Œåƒåœ¾å›æ”¶ï¼›</p><p>è€å¹´ä»£ä¸­çš„å¯¹è±¡åˆ™æ›´åŠ ç¨³å®šï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ ‡è®°-æ•´ç†ç®—æ³•æ¥è¿›è¡Œåƒåœ¾å›æ”¶ã€‚</p><p>åˆ†ä»£æ”¶é›†ç®—æ³•åˆ©ç”¨ä¸åŒå¹´é¾„æ®µå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒï¼Œæé«˜åƒåœ¾å›æ”¶çš„æ•ˆç‡ã€‚</p><ul><li><em><strong>å¢é‡å¼æ”¶é›†ç®—æ³•ï¼ˆIncremental Collection Algorithmï¼‰</strong></em></li></ul><p>å¢é‡å¼æ”¶é›†ç®—æ³•å°†åƒåœ¾å›æ”¶è¿‡ç¨‹åˆ†ä¸ºå¤šä¸ªå°é˜¶æ®µï¼Œåœ¨æ¯ä¸ªå°é˜¶æ®µä¹‹é—´å…è®¸ç¨‹åºæ‰§è¡Œä¸€æ®µæ—¶é—´ã€‚è¿™ç§ç®—æ³•å¯ä»¥è®©åƒåœ¾å›æ”¶çš„è¿‡ç¨‹é€æ¸è¿›è¡Œï¼Œä¸ä¼šé€ æˆé•¿æ—¶é—´çš„åœé¡¿ã€‚ä½†æ˜¯è¿™ç§ç®—æ³•éœ€è¦å¯¹ç¨‹åºè¿è¡Œçš„çŠ¶æ€åšå‡ºä¸€äº›å‡è®¾ï¼Œå¦‚æœè¿™äº›å‡è®¾å‡ºç°é”™è¯¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´åƒåœ¾å›æ”¶çš„ä¸å®Œæ•´ã€‚å› æ­¤ï¼Œå¢é‡å¼æ”¶é›†ç®—æ³•å¹¶ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½é€‚ç”¨ã€‚</p></blockquote><h3 id="garbage-collector" tabindex="-1"><a class="header-anchor" href="#garbage-collector" aria-hidden="true">#</a> Garbage Collector</h3><blockquote><p>HotSpot has four garbage collectors:</p><ul><li><strong>Serial:</strong> All garbage collection events are conducted serially in one thread. JVM executes the compaction after each garbage collection.</li><li><strong>Parallel:</strong> JVM uses multiple threads for minor garbage collection. It uses a single thread for major garbage collection and Old Generation compaction. Alternatively, the Parallel Old variant uses multiple threads for major garbage collection and Old Generation compaction.</li><li><strong>CMS (Concurrent Mark Sweep):</strong> Multiple threads are used for minor garbage collection using the same algorithm as Parallel. Major garbage collection is multi-threaded, like Parallel Old. Still CMS runs concurrently alongside application processes to minimize â€œstop the worldâ€ events (i.e., when the garbage collector running stops the application). Here, the JVM does not perform compaction of memory.</li><li><strong>G1 (Garbage First):</strong> The newest garbage collector is intended as a replacement for CMS. It is parallel and concurrent, like CMS. However, it works quite differently under the hood than older garbage collectors.</li></ul><p><strong>Till java 8, <code>parallel</code> GC was default algorithm.===&gt;Since java 9, <code>G1</code> has been set as default GC algorithm.</strong></p></blockquote><blockquote><p><strong>Serial</strong>:</p><p>Serialï¼ˆä¸²è¡Œï¼‰æ”¶é›†å™¨æ˜¯æœ€åŸºæœ¬ã€å†å²æœ€æ‚ ä¹…çš„åƒåœ¾æ”¶é›†å™¨äº†ã€‚å¤§å®¶çœ‹åå­—å°±çŸ¥é“è¿™ä¸ªæ”¶é›†å™¨æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨äº†ã€‚å®ƒçš„ <strong>â€œå•çº¿ç¨‹â€</strong> çš„æ„ä¹‰ä¸ä»…ä»…æ„å‘³ç€å®ƒåªä¼šä½¿ç”¨ä¸€æ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œï¼Œæ›´é‡è¦çš„æ˜¯å®ƒåœ¨<strong>è¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œçš„æ—¶å€™å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹</strong>ï¼ˆ <strong>&quot;Stop The World&quot;</strong> ï¼‰ï¼Œ<strong>ç›´åˆ°å®ƒæ”¶é›†ç»“æŸ</strong>ã€‚</p><p><strong>æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</strong></p><p>å®ƒ<strong>ç®€å•è€Œé«˜æ•ˆï¼ˆä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹ç›¸æ¯”ï¼‰</strong>ã€‚Serial æ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œè‡ªç„¶å¯ä»¥è·å¾—å¾ˆé«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚Serial æ”¶é›†å™¨å¯¹äºè¿è¡Œåœ¨ Client æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºæ¥è¯´æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230403003634648.png" alt="image-20230403003634648"></p></blockquote><blockquote><p><strong>Parallel Scavenge</strong>:</p><p><strong>JDK1.8 é»˜è®¤æ”¶é›†å™¨</strong></p><p><strong>Parallel Scavenge æ”¶é›†å™¨å…³æ³¨ç‚¹æ˜¯ååé‡ï¼ˆé«˜æ•ˆç‡çš„åˆ©ç”¨ CPUï¼‰ã€‚CMS ç­‰åƒåœ¾æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ›´å¤šçš„æ˜¯ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼ˆæé«˜ç”¨æˆ·ä½“éªŒï¼‰ã€‚æ‰€è°“ååé‡å°±æ˜¯ CPU ä¸­ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸ CPU æ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼ã€‚</strong> Parallel Scavenge æ”¶é›†å™¨æä¾›äº†å¾ˆå¤šå‚æ•°ä¾›ç”¨æˆ·æ‰¾åˆ°æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–æœ€å¤§ååé‡ï¼Œå¦‚æœå¯¹äºæ”¶é›†å™¨è¿ä½œä¸å¤ªäº†è§£ï¼Œæ‰‹å·¥ä¼˜åŒ–å­˜åœ¨å›°éš¾çš„æ—¶å€™ï¼Œä½¿ç”¨ Parallel Scavenge æ”¶é›†å™¨é…åˆè‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ï¼ŒæŠŠå†…å­˜ç®¡ç†ä¼˜åŒ–äº¤ç»™è™šæ‹Ÿæœºå»å®Œæˆä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p><p><strong>æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</strong></p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230403003100936.png" alt="image-20230403003100936"></p></blockquote><blockquote><p><strong>CMSï¼ˆConcurrent Mark Sweepï¼‰</strong>:</p><p><strong>ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚å®ƒéå¸¸ç¬¦åˆåœ¨æ³¨é‡ç”¨æˆ·ä½“éªŒçš„åº”ç”¨ä¸Šä½¿ç”¨ã€‚</strong></p><p><strong>CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ HotSpot è™šæ‹Ÿæœºç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œå®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹ï¼ˆåŸºæœ¬ä¸Šï¼‰åŒæ—¶å·¥ä½œã€‚</strong></p><p>ä¸»è¦ä¼˜ç‚¹ï¼š<strong>å¹¶å‘æ”¶é›†ã€ä½åœé¡¿</strong>ã€‚</p><p>æ˜æ˜¾çš„ç¼ºç‚¹ï¼š</p><ul><li><strong>å¯¹ CPU èµ„æºæ•æ„Ÿï¼›</strong></li><li><strong>æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼›</strong></li><li><strong>å®ƒä½¿ç”¨çš„å›æ”¶ç®—æ³•-â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¼šå¯¼è‡´æ”¶é›†ç»“æŸæ—¶ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿã€‚</strong></li></ul><p><strong>Mark Sweep</strong>è¿™ä¸¤ä¸ªè¯å¯ä»¥çœ‹å‡ºï¼ŒCMS æ”¶é›†å™¨æ˜¯ä¸€ç§ <strong>â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•</strong>å®ç°çš„ï¼Œå®ƒçš„è¿ä½œè¿‡ç¨‹ç›¸æ¯”äºå‰é¢å‡ ç§åƒåœ¾æ”¶é›†å™¨æ¥è¯´æ›´åŠ å¤æ‚ä¸€äº›ã€‚æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼š</p><ul><li><strong>åˆå§‹æ ‡è®°ï¼š</strong> æš‚åœæ‰€æœ‰çš„å…¶ä»–çº¿ç¨‹ï¼Œå¹¶è®°å½•ä¸‹ç›´æ¥ä¸ root ç›¸è¿çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿« ï¼›</li><li><strong>å¹¶å‘æ ‡è®°ï¼š</strong> åŒæ—¶å¼€å¯ GC å’Œç”¨æˆ·çº¿ç¨‹ï¼Œç”¨ä¸€ä¸ªé—­åŒ…ç»“æ„å»è®°å½•å¯è¾¾å¯¹è±¡ã€‚ä½†åœ¨è¿™ä¸ªé˜¶æ®µç»“æŸï¼Œè¿™ä¸ªé—­åŒ…ç»“æ„å¹¶ä¸èƒ½ä¿è¯åŒ…å«å½“å‰æ‰€æœ‰çš„å¯è¾¾å¯¹è±¡ã€‚å› ä¸ºç”¨æˆ·çº¿ç¨‹å¯èƒ½ä¼šä¸æ–­çš„æ›´æ–°å¼•ç”¨åŸŸï¼Œæ‰€ä»¥ GC çº¿ç¨‹æ— æ³•ä¿è¯å¯è¾¾æ€§åˆ†æçš„å®æ—¶æ€§ã€‚æ‰€ä»¥è¿™ä¸ªç®—æ³•é‡Œä¼šè·Ÿè¸ªè®°å½•è¿™äº›å‘ç”Ÿå¼•ç”¨æ›´æ–°çš„åœ°æ–¹ã€‚</li><li><strong>é‡æ–°æ ‡è®°ï¼š</strong> é‡æ–°æ ‡è®°é˜¶æ®µå°±æ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ä¸ºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µçš„æ—¶é—´ç¨é•¿ï¼Œè¿œè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µæ—¶é—´çŸ­</li><li><strong>å¹¶å‘æ¸…é™¤ï¼š</strong> å¼€å¯ç”¨æˆ·çº¿ç¨‹ï¼ŒåŒæ—¶ GC çº¿ç¨‹å¼€å§‹å¯¹æœªæ ‡è®°çš„åŒºåŸŸåšæ¸…æ‰«ã€‚</li></ul><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230403003741563.png" alt="image-20230403003741563"></p></blockquote><blockquote><p><strong>G1 (Garbage-First)</strong> :</p><p><strong>ä¸€æ¬¾é¢å‘æœåŠ¡å™¨çš„åƒåœ¾æ”¶é›†å™¨,ä¸»è¦é’ˆå¯¹é…å¤‡å¤šé¢—å¤„ç†å™¨åŠå¤§å®¹é‡å†…å­˜çš„æœºå™¨. ä»¥æé«˜æ¦‚ç‡æ»¡è¶³ GC åœé¡¿æ—¶é—´è¦æ±‚çš„åŒæ—¶,è¿˜å…·å¤‡é«˜ååé‡æ€§èƒ½ç‰¹å¾.</strong></p><p>å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li><strong>å¹¶è¡Œä¸å¹¶å‘</strong>ï¼šG1 èƒ½å……åˆ†åˆ©ç”¨ CPUã€å¤šæ ¸ç¯å¢ƒä¸‹çš„ç¡¬ä»¶ä¼˜åŠ¿ï¼Œä½¿ç”¨å¤šä¸ª CPUï¼ˆCPU æˆ–è€… CPU æ ¸å¿ƒï¼‰æ¥ç¼©çŸ­ Stop-The-World åœé¡¿æ—¶é—´ã€‚éƒ¨åˆ†å…¶ä»–æ”¶é›†å™¨åŸæœ¬éœ€è¦åœé¡¿ Java çº¿ç¨‹æ‰§è¡Œçš„ GC åŠ¨ä½œï¼ŒG1 æ”¶é›†å™¨ä»ç„¶å¯ä»¥é€šè¿‡å¹¶å‘çš„æ–¹å¼è®© java ç¨‹åºç»§ç»­æ‰§è¡Œã€‚</li><li><strong>åˆ†ä»£æ”¶é›†</strong>ï¼šè™½ç„¶ G1 å¯ä»¥ä¸éœ€è¦å…¶ä»–æ”¶é›†å™¨é…åˆå°±èƒ½ç‹¬ç«‹ç®¡ç†æ•´ä¸ª GC å †ï¼Œä½†æ˜¯è¿˜æ˜¯ä¿ç•™äº†åˆ†ä»£çš„æ¦‚å¿µã€‚</li><li><strong>ç©ºé—´æ•´åˆ</strong>ï¼šä¸ CMS çš„â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¸åŒï¼ŒG1 ä»æ•´ä½“æ¥çœ‹æ˜¯åŸºäºâ€œæ ‡è®°-æ•´ç†â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼›ä»å±€éƒ¨ä¸Šæ¥çœ‹æ˜¯åŸºäºâ€œæ ‡è®°-å¤åˆ¶â€ç®—æ³•å®ç°çš„ã€‚</li><li><strong>å¯é¢„æµ‹çš„åœé¡¿</strong>ï¼šè¿™æ˜¯ G1 ç›¸å¯¹äº CMS çš„å¦ä¸€ä¸ªå¤§ä¼˜åŠ¿ï¼Œé™ä½åœé¡¿æ—¶é—´æ˜¯ G1 å’Œ CMS å…±åŒçš„å…³æ³¨ç‚¹ï¼Œä½† G1 é™¤äº†è¿½æ±‚ä½åœé¡¿å¤–ï¼Œè¿˜èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼Œèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ã€‚</li></ul><p>G1 æ”¶é›†å™¨çš„è¿ä½œå¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li><strong>åˆå§‹æ ‡è®°</strong></li><li><strong>å¹¶å‘æ ‡è®°</strong></li><li><strong>æœ€ç»ˆæ ‡è®°</strong></li><li><strong>ç­›é€‰å›æ”¶</strong></li></ul><p><strong>G1 æ”¶é›†å™¨åœ¨åå°ç»´æŠ¤äº†ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆé€‰æ‹©å›æ”¶ä»·å€¼æœ€å¤§çš„ Region(è¿™ä¹Ÿå°±æ˜¯å®ƒçš„åå­— Garbage-First çš„ç”±æ¥)</strong> ã€‚è¿™ç§ä½¿ç”¨ Region åˆ’åˆ†å†…å­˜ç©ºé—´ä»¥åŠæœ‰ä¼˜å…ˆçº§çš„åŒºåŸŸå›æ”¶æ–¹å¼ï¼Œä¿è¯äº† G1 æ”¶é›†å™¨åœ¨æœ‰é™æ—¶é—´å†…å¯ä»¥å°½å¯èƒ½é«˜çš„æ”¶é›†æ•ˆç‡ï¼ˆæŠŠå†…å­˜åŒ–æ•´ä¸ºé›¶ï¼‰ã€‚</p><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230403003811253.png" alt="image-20230403003811253"></p></blockquote><h3 id="judgment-of-the-object-of-death" tabindex="-1"><a class="header-anchor" href="#judgment-of-the-object-of-death" aria-hidden="true">#</a> Judgment of the object of death</h3><blockquote><p>åœ¨ Java ä¸­ï¼Œæ­»äº¡å¯¹è±¡æ˜¯æŒ‡æ— æ³•å†è¢«åº”ç”¨ç¨‹åºè®¿é—®åˆ°çš„å¯¹è±¡ã€‚Java åƒåœ¾å›æ”¶å™¨ä¼šå®šæœŸæ‰«æå†…å­˜ï¼Œæ‰¾åˆ°è¿™äº›æ­»äº¡å¯¹è±¡ï¼Œå¹¶å°†å…¶å›æ”¶é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚Java ä¸­åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºæ­»äº¡å¯¹è±¡çš„æ–¹æ³•æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p><ol><li><p><strong>å¼•ç”¨è®¡æ•°æ³•</strong>ï¼šæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œå½“æœ‰å¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡æ—¶ï¼Œè®¡æ•°å™¨åŠ  1ï¼Œå½“å¼•ç”¨è¢«é”€æ¯æ—¶ï¼Œè®¡æ•°å™¨å‡ 1ã€‚å½“è®¡æ•°å™¨çš„å€¼ä¸º 0 æ—¶ï¼Œè¯¥å¯¹è±¡è¢«åˆ¤å®šä¸ºæ­»äº¡å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œå¼•ç”¨è®¡æ•°æ³•æ— æ³•è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜(<strong>åƒåœ¾ç›¸äº’å¼•ç”¨é—®é¢˜</strong>)ï¼Œå³ä¸¤ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ä¹‹é—´äº’ç›¸å¼•ç”¨ï¼Œå¯¼è‡´å®ƒä»¬çš„å¼•ç”¨è®¡æ•°å™¨çš„å€¼æ°¸è¿œä¸ä¸º 0ï¼Œè¿™æ ·è¿™äº›å¯¹è±¡å°±ä¼šä¸€ç›´å­˜åœ¨äºå†…å­˜ä¸­è€Œæ— æ³•è¢«å›æ”¶ã€‚</p></li><li><p><strong>å¯è¾¾æ€§åˆ†æç®—æ³•</strong>ï¼š<strong>å¯è¾¾æ€§åˆ†æç®—æ³•æ˜¯ä¸€ç§å¸¸ç”¨çš„åƒåœ¾å›æ”¶ç®—æ³•</strong>ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„â€œGC Rootsâ€å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›æ ¹å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾ï¼Œæ‰¾åˆ°æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ï¼Œæœªè¢«éå†åˆ°çš„å¯¹è±¡å³ä¸ºæ­»äº¡å¯¹è±¡ã€‚Java ä¸­çš„ <strong>GC Roots</strong> å¯¹è±¡åŒ…æ‹¬ï¼š</p><ul><li>è™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡</li><li>æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡</li><li>æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡</li><li>æœ¬åœ°æ–¹æ³•æ ˆä¸­ JNIï¼ˆJava Native Interfaceï¼‰å¼•ç”¨çš„å¯¹è±¡</li></ul><p><img src="https://eddie-typora-image.oss-cn-shenzhen.aliyuncs.com/typora-user-images/image-20230402234130605.png" alt="image-20230402234130605"></p></li></ol><p>å¯è¾¾æ€§åˆ†æç®—æ³•å¯ä»¥å¤„ç†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿè¯†åˆ«å‡ºä¸å†ä¸ GC Roots å¯¹è±¡ç›¸è¿çš„ä¸€ç»„å¯¹è±¡ï¼Œå³ä¸ºä¸å¯è¾¾å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡ä¼šè¢«åˆ¤å®šä¸ºæ­»äº¡å¯¹è±¡å¹¶è¿›è¡Œå›æ”¶ã€‚</p></blockquote><h3 id="the-reference-type-of-the-object" tabindex="-1"><a class="header-anchor" href="#the-reference-type-of-the-object" aria-hidden="true">#</a> The reference type of the object</h3><blockquote><p>åœ¨ Java ä¸­ï¼Œå¼•ç”¨ç±»å‹ç”¨äºæè¿°ä¸€ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­çš„ä½¿ç”¨æƒ…å†µå’Œå¼•ç”¨æ–¹å¼ï¼ŒJava ä¸­å…±æœ‰å››ç§å¼•ç”¨ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ol><li><strong>å¼ºå¼•ç”¨ï¼ˆStrong Referenceï¼‰</strong>ï¼šæœ€å¸¸è§çš„å¼•ç”¨ç±»å‹ï¼Œä¹Ÿæ˜¯é»˜è®¤çš„å¼•ç”¨ç±»å‹ã€‚<strong>å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨</strong>ï¼Œ<strong>åƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶</strong>å®ƒï¼Œå³ä½¿è¯¥å¯¹è±¡å·²ç»æ²¡æœ‰è¢«ä»»ä½•å˜é‡æ‰€å¼•ç”¨ã€‚å½“ç¨‹åºä¸­çš„æŸä¸ªå¯¹è±¡æ‹¥æœ‰å¼ºå¼•ç”¨æ—¶ï¼Œè¯¥å¯¹è±¡å°±ä¸€ç›´å­˜åœ¨äºå†…å­˜ä¸­ï¼Œç›´åˆ°è¯¥å¼•ç”¨è¢«æ˜¾å¼åœ°è®¾ç½®ä¸º null æˆ–è€…è¢«èµ‹å€¼ä¸ºå…¶ä»–å¯¹è±¡ã€‚</li><li><strong>è½¯å¼•ç”¨ï¼ˆSoft Referenceï¼‰ï¼š<strong>ç”¨äºæè¿°ä¸€äº›æœ‰ç”¨ä½†éå¿…é¡»çš„å¯¹è±¡ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åªæœ‰è½¯å¼•ç”¨ï¼Œé‚£ä¹ˆåœ¨</strong>å†…å­˜ä¸è¶³æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨å¯èƒ½ä¼šå›æ”¶å®ƒ</strong>ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´ã€‚å½“ç¨‹åºéœ€è¦è¯¥å¯¹è±¡æ—¶ï¼Œå¯ä»¥é€šè¿‡è½¯å¼•ç”¨é‡æ–°è·å–å®ƒã€‚åœ¨ Java ä¸­ï¼Œè½¯å¼•ç”¨é€šå¸¸ç”¨äºç¼“å­˜ã€‚</li><li>**å¼±å¼•ç”¨ï¼ˆWeak Referenceï¼‰ï¼š**ç”¨äºæè¿°ä¸€äº›éå¿…é¡»çš„å¯¹è±¡ï¼Œæ¯”è½¯å¼•ç”¨æ›´åŠ å¼±åŒ–ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åªæœ‰å¼±å¼•ç”¨ï¼Œé‚£ä¹ˆåœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œ<strong>æ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šè¢«å›æ”¶</strong>ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´ã€‚å¼±å¼•ç”¨é€šå¸¸ç”¨äºè§£å†³å†…å­˜æ³„æ¼é—®é¢˜ï¼Œæ¯”å¦‚åœ¨å¯¹è±¡ä¸å…¶å®ƒå¯¹è±¡ä¹‹é—´å­˜åœ¨å¾ªç¯å¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¼±å¼•ç”¨å¯ä»¥è§£é™¤è¿™ç§å¾ªç¯å¼•ç”¨ã€‚</li><li><strong>è™šå¼•ç”¨ï¼ˆPhantom Referenceï¼‰ï¼š<strong>ç”¨äº</strong>æè¿°é‚£äº›å·²ç»è¢«å›æ”¶çš„å¯¹è±¡</strong>ã€‚è™šå¼•ç”¨æ— æ³•é€šè¿‡å®ƒç›´æ¥è®¿é—®åˆ°å¯¹è±¡çš„å®ä¾‹ï¼Œä¹Ÿæ— æ³•é€šè¿‡å®ƒè·å–å¯¹è±¡çš„çŠ¶æ€æˆ–è€…æ‰§è¡Œä»»ä½•æ“ä½œã€‚<strong>è™šå¼•ç”¨ä¸»è¦ç”¨äºè·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„çŠ¶æ€</strong>ï¼Œæä¾›ä¸€ç§åœ¨å¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ç³»ç»Ÿé€šçŸ¥çš„æœºåˆ¶ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œèµ„æºæ¸…ç†æˆ–è€…å…¶ä»–æ¸…ç†æ“ä½œã€‚</li></ol></blockquote><h3 id="a-class-that-is-judged-to-be-useless" tabindex="-1"><a class="header-anchor" href="#a-class-that-is-judged-to-be-useless" aria-hidden="true">#</a> A class that is judged to be useless</h3><blockquote><p>åœ¨ Java ä¸­ï¼Œç±»å¯¹è±¡é€šå¸¸ä¼šè¢«åŠ è½½å™¨æŒæœ‰ï¼Œå› æ­¤åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯å¦æ˜¯æ— ç”¨çš„ç±»éœ€è¦ä»ç±»åŠ è½½å™¨å…¥æ‰‹ã€‚JVM ä¸­æ¯ä¸ªç±»åŠ è½½å™¨éƒ½ç»´æŠ¤äº†ä¸€ä¸ªåŠ è½½çš„ç±»çš„åˆ—è¡¨ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸å†è¢«å¼•ç”¨ï¼Œé‚£ä¹ˆè¯¥ç±»å°±å¯ä»¥è¢«å¸è½½ã€‚</p><p>åœ¨åƒåœ¾å›æ”¶å™¨æ‰«æå†…å­˜æ—¶ï¼Œå®ƒä¼šä»æ ¹é›†å¼€å§‹ï¼Œéå†æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ï¼Œå°†ä¸å¯è¾¾çš„å¯¹è±¡æ ‡è®°ä¸ºåƒåœ¾ï¼Œç„¶åè¿›è¡Œå›æ”¶ã€‚ç±»åŠ è½½å™¨ä¹Ÿæ˜¯ä»æ ¹é›†å¼€å§‹éå†ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¼•ç”¨æŒ‡å‘è¯¥ç±»ï¼Œå¦‚æœæ²¡æœ‰åˆ™è®¤ä¸ºè¯¥ç±»å¯ä»¥è¢«å¸è½½ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒJVM ä¸­å¯¹äºä¸€ä¸ªç±»çš„å¸è½½ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š</p><ol><li>è¯¥ç±»çš„<strong>æ‰€æœ‰å®ä¾‹éƒ½å·²ç»è¢« GC å›æ”¶</strong>ï¼Œå³<strong>æ²¡æœ‰ä»»ä½•å®ä¾‹å¼•ç”¨äº†è¯¥ç±»</strong>ã€‚</li><li>è¯¥ç±»çš„ <strong>Class å¯¹è±¡å·²ç»è¢« GC å›æ”¶</strong>ã€‚</li><li>è¯¥ç±»çš„ <strong>ClassLoader å·²ç»è¢« GC å›æ”¶</strong>ã€‚</li></ol><p>åªæœ‰å½“ä»¥ä¸Šä¸‰ä¸ªæ¡ä»¶éƒ½æ»¡è¶³æ—¶ï¼Œè¯¥ç±»æ‰å¯ä»¥è¢«å¸è½½ã€‚</p></blockquote><blockquote><p><strong>åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯åºŸå¼ƒå¸¸é‡</strong></p><p>åœ¨ Java ä¸­ï¼Œå¸¸é‡æ± æ˜¯ JVM ç”¨äºå­˜å‚¨å¸¸é‡çš„åŒºåŸŸï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨ç”Ÿæˆçš„å¸¸é‡å’Œæ‰‹åŠ¨æ·»åŠ çš„å¸¸é‡ã€‚åœ¨åˆ¤æ–­ä¸€ä¸ªå¸¸é‡æ˜¯å¦æ˜¯åºŸå¼ƒå¸¸é‡æ—¶ï¼Œéœ€è¦ä»å¸¸é‡æ± å…¥æ‰‹ã€‚</p><p>å¸¸é‡æ± ä¸­çš„å¸¸é‡åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šå­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚å­—é¢é‡åŒ…æ‹¬å­—ç¬¦ä¸²ã€æ•°å­—ç­‰å¸¸é‡ï¼Œè€Œç¬¦å·å¼•ç”¨åŒ…æ‹¬ç±»å’Œæ–¹æ³•çš„å¼•ç”¨ã€‚å¯¹äºä¸€ä¸ªåºŸå¼ƒçš„å¸¸é‡ï¼Œå¯ä»¥ç†è§£ä¸ºå…¶å¯¹åº”çš„å­—é¢é‡æˆ–ç¬¦å·å¼•ç”¨æ²¡æœ‰è¢«ä½¿ç”¨ã€‚</p><p>åœ¨åƒåœ¾å›æ”¶å™¨æ‰«æå†…å­˜æ—¶ï¼Œä¼šä»æ ¹é›†å¼€å§‹ï¼Œéå†æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ï¼Œå°†ä¸å¯è¾¾çš„å¯¹è±¡æ ‡è®°ä¸ºåƒåœ¾ï¼Œç„¶åè¿›è¡Œå›æ”¶ã€‚å¸¸é‡æ± ä¸­çš„å¸¸é‡ä¹Ÿæ˜¯ä»æ ¹é›†å¼€å§‹éå†ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¼•ç”¨æŒ‡å‘è¯¥å¸¸é‡ï¼Œå¦‚æœæ²¡æœ‰åˆ™è®¤ä¸ºè¯¥å¸¸é‡å¯ä»¥è¢«å›æ”¶ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒJVM ä¸­å¯¹äºä¸€ä¸ªå¸¸é‡çš„å›æ”¶ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ol><li>è¯¥<strong>å¸¸é‡æ‰€åœ¨çš„ç±»æ²¡æœ‰è¢«åŠ è½½ï¼Œæˆ–è€…è¯¥å¸¸é‡æ‰€åœ¨çš„ç±»å·²ç»è¢«å¸è½½</strong>ã€‚</li><li>è¯¥<strong>å¸¸é‡æ²¡æœ‰è¢«ä»»ä½•å¯¹è±¡å¼•ç”¨</strong>ã€‚</li></ol><p>åªæœ‰å½“ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³æ—¶ï¼Œè¯¥å¸¸é‡æ‰å¯ä»¥è¢«å›æ”¶ã€‚</p></blockquote><h2 id="jvm-out-of-memory" tabindex="-1"><a class="header-anchor" href="#jvm-out-of-memory" aria-hidden="true">#</a> JVM Out Of Memory</h2><h2 id="jvm-performance-optimization" tabindex="-1"><a class="header-anchor" href="#jvm-performance-optimization" aria-hidden="true">#</a> JVM Performance Optimization</h2></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/EddieZturbo/Eddie-Tech-Blog.github.io/edit/main/docs/backend/java/jvm.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><!----><!----></div></footer><nav class="page-nav"><a href="/backend/java/Java.html" class="nav-link prev" aria-label="Java Start"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->Java Start</div></a><a href="/backend/java/java8.html" class="nav-link next" aria-label="Java8å‡½æ•°å¼ç¼–ç¨‹"><div class="hint">Next<span class="arrow end"></span></div><div class="link">Java8å‡½æ•°å¼ç¼–ç¨‹<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Default footer</div><div class="copyright">Copyright Â© 2023 EddieZ</div></footer></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-7117916c.js" defer></script>
  </body>
</html>
